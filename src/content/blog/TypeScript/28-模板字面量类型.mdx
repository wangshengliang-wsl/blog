---
title: 'æ¨¡æ¿å­—é¢é‡ç±»å‹'
description: 'TypeScript æ¨¡æ¿å­—é¢é‡ç±»å‹è¯¦è§£ï¼šå­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…ã€å†…ç½®å­—ç¬¦ä¸²å·¥å…·ç±»å‹ã€ç±»å‹çº§å­—ç¬¦ä¸²æ“ä½œ'
pubDate: 2024-02-11
toc: true
ogImage: true
category: 'TypeScript'
tags:
  [
    'TypeScript',
    'æ¨¡æ¿å­—é¢é‡ç±»å‹',
    'Template Literal Types',
    'å­—ç¬¦ä¸²ç±»å‹',
    'é«˜çº§ç±»å‹',
  ]
---

æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate Literal Typesï¼‰è®©æˆ‘ä»¬èƒ½åœ¨ç±»å‹å±‚é¢æ“ä½œå­—ç¬¦ä¸²ï¼Œç±»ä¼¼äº JavaScript çš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚

## åŸºæœ¬è¯­æ³•

ä½¿ç”¨åå¼•å·åˆ›å»ºæ¨¡æ¿å­—é¢é‡ç±»å‹ï¼š

```typescript
// TypeScript 5.x

// ç®€å•æ‹¼æ¥
type Greeting = `hello ${string}`

const a: Greeting = 'hello world' // âœ…
const b: Greeting = 'hello there' // âœ…
// const c: Greeting = 'hi world';  // âŒ é”™è¯¯

// ä½¿ç”¨å­—é¢é‡ç±»å‹
type World = 'world'
type HelloWorld = `hello ${World}`
// 'hello world'

// è”åˆç±»å‹å±•å¼€
type Color = 'red' | 'blue' | 'green'
type Size = 'small' | 'medium' | 'large'

type ColorSize = `${Color}-${Size}`
// 'red-small' | 'red-medium' | 'red-large'
// | 'blue-small' | 'blue-medium' | 'blue-large'
// | 'green-small' | 'green-medium' | 'green-large'

// æ•°å­—ç±»å‹
type Pixel = `${number}px`

const width: Pixel = '100px' // âœ…
// const height: Pixel = '100';  // âŒ é”™è¯¯
```

## å†…ç½®å­—ç¬¦ä¸²å·¥å…·ç±»å‹

TypeScript æä¾›äº†å››ä¸ªå†…ç½®çš„å­—ç¬¦ä¸²æ“ä½œç±»å‹ï¼š

```typescript
// Uppercase - è½¬å¤§å†™
type Upper = Uppercase<'hello'>
// 'HELLO'

type UpperUnion = Uppercase<'hello' | 'world'>
// 'HELLO' | 'WORLD'

// Lowercase - è½¬å°å†™
type Lower = Lowercase<'HELLO'>
// 'hello'

// Capitalize - é¦–å­—æ¯å¤§å†™
type Cap = Capitalize<'hello'>
// 'Hello'

type CapUnion = Capitalize<'hello' | 'world'>
// 'Hello' | 'World'

// Uncapitalize - é¦–å­—æ¯å°å†™
type Uncap = Uncapitalize<'Hello'>
// 'hello'

// ç»„åˆä½¿ç”¨
type EventName<T extends string> = `on${Capitalize<T>}`

type ClickEvent = EventName<'click'>
// 'onClick'

type FocusEvent = EventName<'focus'>
// 'onFocus'
```

## å­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…

ä½¿ç”¨ `infer` è¿›è¡Œå­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…ï¼š

```typescript
// æå–å‰ç¼€åçš„éƒ¨åˆ†
type RemovePrefix<
  T extends string,
  P extends string,
> = T extends `${P}${infer Rest}` ? Rest : T

type Without = RemovePrefix<'hello_world', 'hello_'>
// 'world'

type NoMatch = RemovePrefix<'hello_world', 'hi_'>
// 'hello_world'

// æå–åç¼€å‰çš„éƒ¨åˆ†
type RemoveSuffix<
  T extends string,
  S extends string,
> = T extends `${infer Rest}${S}` ? Rest : T

type WithoutSuffix = RemoveSuffix<'hello.ts', '.ts'>
// 'hello'

// æ›¿æ¢å­—ç¬¦ä¸²
type Replace<
  T extends string,
  S extends string,
  R extends string,
> = T extends `${infer Before}${S}${infer After}` ? `${Before}${R}${After}` : T

type Replaced = Replace<'hello world', ' ', '-'>
// 'hello-world'

// å…¨éƒ¨æ›¿æ¢
type ReplaceAll<
  T extends string,
  S extends string,
  R extends string,
> = T extends `${infer Before}${S}${infer After}`
  ? ReplaceAll<`${Before}${R}${After}`, S, R>
  : T

type ReplacedAll = ReplaceAll<'a.b.c', '.', '/'>
// 'a/b/c'
```

## å­—ç¬¦ä¸²åˆ†å‰²

```typescript
// åˆ†å‰²å­—ç¬¦ä¸²ä¸ºå…ƒç»„
type Split<
  S extends string,
  D extends string,
> = S extends `${infer Head}${D}${infer Tail}`
  ? [Head, ...Split<Tail, D>]
  : S extends ''
    ? []
    : [S]

type Parts = Split<'a-b-c', '-'>
// ['a', 'b', 'c']

type Words = Split<'hello world', ' '>
// ['hello', 'world']

// è¿æ¥å­—ç¬¦ä¸²æ•°ç»„
type Join<T extends string[], D extends string> = T extends [
  infer First extends string,
]
  ? First
  : T extends [infer First extends string, ...infer Rest extends string[]]
    ? `${First}${D}${Join<Rest, D>}`
    : ''

type Joined = Join<['a', 'b', 'c'], '-'>
// 'a-b-c'
```

## å‘½åè½¬æ¢

```typescript
// é©¼å³°è½¬çŸ­æ¨ªçº¿
type CamelToKebab<S extends string> = S extends `${infer First}${infer Rest}`
  ? First extends Uppercase<First>
    ? `-${Lowercase<First>}${CamelToKebab<Rest>}`
    : `${First}${CamelToKebab<Rest>}`
  : S

type Kebab = CamelToKebab<'backgroundColor'>
// 'background-color'

// çŸ­æ¨ªçº¿è½¬é©¼å³°
type KebabToCamel<S extends string> = S extends `${infer First}-${infer Rest}`
  ? `${First}${Capitalize<KebabToCamel<Rest>>}`
  : S

type Camel = KebabToCamel<'background-color'>
// 'backgroundColor'

// è›‡å½¢è½¬é©¼å³°
type SnakeToCamel<S extends string> = S extends `${infer First}_${infer Rest}`
  ? `${First}${Capitalize<SnakeToCamel<Rest>>}`
  : S

type FromSnake = SnakeToCamel<'user_first_name'>
// 'userFirstName'

// é©¼å³°è½¬è›‡å½¢
type CamelToSnake<S extends string> = S extends `${infer First}${infer Rest}`
  ? First extends Uppercase<First>
    ? `_${Lowercase<First>}${CamelToSnake<Rest>}`
    : `${First}${CamelToSnake<Rest>}`
  : S

type ToSnake = CamelToSnake<'userFirstName'>
// 'user_first_name'
```

## å®é™…åº”ç”¨

### ç±»å‹å®‰å…¨çš„äº‹ä»¶ç³»ç»Ÿ

```typescript
type Events = {
  click: { x: number; y: number }
  focus: { target: HTMLElement }
  blur: { target: HTMLElement }
}

type EventHandler<T extends keyof Events> = `on${Capitalize<T>}`

type AllHandlers = {
  [K in keyof Events as EventHandler<K>]: (event: Events[K]) => void
}
// {
//   onClick: (event: { x: number; y: number }) => void
//   onFocus: (event: { target: HTMLElement }) => void
//   onBlur: (event: { target: HTMLElement }) => void
// }
```

### Getter/Setter ç”Ÿæˆ

```typescript
type Getters<T> = {
  [K in keyof T as `get${Capitalize<K & string>}`]: () => T[K]
}

type Setters<T> = {
  [K in keyof T as `set${Capitalize<K & string>}`]: (value: T[K]) => void
}

interface State {
  name: string
  count: number
  loading: boolean
}

type StateGetters = Getters<State>
// {
//   getName: () => string
//   getCount: () => number
//   getLoading: () => boolean
// }

type StateSetters = Setters<State>
// {
//   setName: (value: string) => void
//   setCount: (value: number) => void
//   setLoading: (value: boolean) => void
// }

type StateWithMethods = State & Getters<State> & Setters<State>
```

### CSS å±æ€§ç±»å‹

```typescript
type CSSUnit = 'px' | 'em' | 'rem' | '%' | 'vh' | 'vw'
type CSSValue = `${number}${CSSUnit}`

type Spacing = CSSValue | 'auto'

interface CSSProperties {
  margin?: Spacing
  padding?: Spacing
  width?: CSSValue | 'auto' | '100%'
  height?: CSSValue | 'auto' | '100%'
}

const styles: CSSProperties = {
  margin: '10px',
  padding: '1.5rem',
  width: '100%',
  height: 'auto',
}

// é¢œè‰²ç±»å‹
type HexColor = `#${string}`
type RGBColor = `rgb(${number}, ${number}, ${number})`
type RGBAColor = `rgba(${number}, ${number}, ${number}, ${number})`

type Color = HexColor | RGBColor | RGBAColor | 'transparent'

const color1: Color = '#ff0000'
const color2: Color = 'rgb(255, 0, 0)'
const color3: Color = 'rgba(255, 0, 0, 0.5)'
```

### è·¯ç”±ç±»å‹

```typescript
type PathParams<Path extends string> =
  Path extends `${string}:${infer Param}/${infer Rest}`
    ? Param | PathParams<`/${Rest}`>
    : Path extends `${string}:${infer Param}`
      ? Param
      : never

type UserParams = PathParams<'/users/:id'>
// 'id'

type PostParams = PathParams<'/users/:userId/posts/:postId'>
// 'userId' | 'postId'

// æ„å»ºå‚æ•°å¯¹è±¡
type ParamsObject<Path extends string> = {
  [K in PathParams<Path>]: string
}

type UserParamsObj = ParamsObject<'/users/:id'>
// { id: string }

type PostParamsObj = ParamsObject<'/users/:userId/posts/:postId'>
// { userId: string; postId: string }

// è·¯ç”±é…ç½®
interface Route<Path extends string> {
  path: Path
  handler: (params: ParamsObject<Path>) => void
}

const userRoute: Route<'/users/:id'> = {
  path: '/users/:id',
  handler: (params) => {
    console.log(params.id) // ç±»å‹å®‰å…¨
  },
}
```

### æ•°æ®åº“æŸ¥è¯¢æ„å»ºå™¨

```typescript
type Operator = 'eq' | 'ne' | 'gt' | 'lt' | 'gte' | 'lte'

type WhereClause<T, K extends keyof T> = `${K & string}_${Operator}`

interface User {
  id: number
  name: string
  age: number
  email: string
}

type UserWhere = {
  [K in keyof User as WhereClause<User, K>]?: User[K]
}
// {
//   id_eq?: number; id_ne?: number; id_gt?: number; ...
//   name_eq?: string; name_ne?: string; ...
//   age_eq?: number; ...
//   email_eq?: string; ...
// }

const query: UserWhere = {
  age_gte: 18,
  name_eq: 'å¼ ä¸‰',
}
```

### å›½é™…åŒ–é”®

```typescript
type I18nKey<T extends string> = `i18n.${T}`

type Namespace = 'common' | 'auth' | 'dashboard'
type Key = 'title' | 'description' | 'button'

type AllKeys = I18nKey<`${Namespace}.${Key}`>
// 'i18n.common.title' | 'i18n.common.description' | ...

// åµŒå¥—é”®
type NestedKey<T, Prefix extends string = ''> = T extends object
  ? {
      [K in keyof T]: K extends string
        ? T[K] extends object
          ? NestedKey<T[K], `${Prefix}${K}.`>
          : `${Prefix}${K}`
        : never
    }[keyof T]
  : never

interface Translations {
  common: {
    title: string
    button: {
      submit: string
      cancel: string
    }
  }
  auth: {
    login: string
    logout: string
  }
}

type TranslationKeys = NestedKey<Translations>
// 'common.title' | 'common.button.submit' | 'common.button.cancel' | 'auth.login' | 'auth.logout'
```

## é«˜çº§æŠ€å·§

### å­—ç¬¦ä¸²é•¿åº¦

```typescript
type StringLength<
  S extends string,
  Acc extends any[] = [],
> = S extends `${infer _}${infer Rest}`
  ? StringLength<Rest, [...Acc, any]>
  : Acc['length']

type Len1 = StringLength<'hello'>
// 5

type Len2 = StringLength<''>
// 0
```

### å­—ç¬¦ä¸²åè½¬

```typescript
type Reverse<S extends string> = S extends `${infer First}${infer Rest}`
  ? `${Reverse<Rest>}${First}`
  : ''

type Rev = Reverse<'hello'>
// 'olleh'
```

### å»é™¤ç©ºæ ¼

```typescript
type TrimLeft<S extends string> = S extends ` ${infer Rest}`
  ? TrimLeft<Rest>
  : S

type TrimRight<S extends string> = S extends `${infer Rest} `
  ? TrimRight<Rest>
  : S

type Trim<S extends string> = TrimLeft<TrimRight<S>>

type Trimmed = Trim<'  hello  '>
// 'hello'
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ æ¨¡æ¿å­—é¢é‡æœ‰æ€§èƒ½é™åˆ¶å—ï¼Ÿ

```typescript
// è”åˆç±»å‹ä¼šäº§ç”Ÿç¬›å¡å°”ç§¯
type Many = `${1 | 2 | 3}${1 | 2 | 3}${1 | 2 | 3}`
// äº§ç”Ÿ 27 ç§ç»„åˆ

// è¿‡å¤šç»„åˆä¼šå¯¼è‡´ç¼–è¯‘å˜æ…¢
// é¿å…è¿‡åº¦å¤æ‚çš„æ¨¡æ¿å­—é¢é‡ç±»å‹
```

### ğŸ™‹ å¦‚ä½•å¤„ç†åŠ¨æ€å­—ç¬¦ä¸²ï¼Ÿ

```typescript
// ä½¿ç”¨ string ç±»å‹åŒ¹é…ä»»æ„å­—ç¬¦ä¸²
type HasPrefix<T extends string, P extends string> = T extends `${P}${string}`
  ? true
  : false

type Test1 = HasPrefix<'hello-world', 'hello'>
// true

type Test2 = HasPrefix<'hello-world', 'world'>
// false
```

### ğŸ™‹ æ¨¡æ¿å­—é¢é‡å¯ä»¥ç”¨äºè¿è¡Œæ—¶å—ï¼Ÿ

```typescript
// æ¨¡æ¿å­—é¢é‡ç±»å‹åªå­˜åœ¨äºç¼–è¯‘æ—¶
// è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨ç±»å‹å®ˆå«éªŒè¯

function isValidEvent(event: string): event is `on${Capitalize<string>}` {
  return event.startsWith('on') && event.length > 2
}

const event = 'onClick'
if (isValidEvent(event)) {
  console.log(event) // ç±»å‹ä¸º `on${Capitalize<string>}`
}
```

## æ€»ç»“

| ç‰¹æ€§         | è¯­æ³•                  | ç”¨é€”           |
| ------------ | --------------------- | -------------- |
| åŸºæœ¬æ‹¼æ¥     | `` `${A}${B}` ``      | ç»„åˆå­—ç¬¦ä¸²ç±»å‹ |
| è”åˆå±•å¼€     | `` `${A \| B}` ``     | ç”Ÿæˆæ‰€æœ‰ç»„åˆ   |
| Uppercase    | `Uppercase<T>`        | è½¬å¤§å†™         |
| Lowercase    | `Lowercase<T>`        | è½¬å°å†™         |
| Capitalize   | `Capitalize<T>`       | é¦–å­—æ¯å¤§å†™     |
| Uncapitalize | `Uncapitalize<T>`     | é¦–å­—æ¯å°å†™     |
| æ¨¡å¼åŒ¹é…     | `` `${infer X}...` `` | æå–å­—ç¬¦ä¸²éƒ¨åˆ† |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ æ¨¡å—ç³»ç»Ÿï¼Œäº†è§£ TypeScript çš„æ¨¡å—åŒ–æ–¹æ¡ˆã€‚
