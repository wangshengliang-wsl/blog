---
title: 'åŸºç¡€ç±»å‹'
description: 'TypeScript åŸºç¡€ç±»å‹è¯¦è§£ï¼šstringã€numberã€booleanã€nullã€undefinedã€anyã€unknownã€never çš„ç”¨æ³•ä¸åŒºåˆ«'
pubDate: 2024-01-16
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'ç±»å‹ç³»ç»Ÿ', 'åŸºç¡€ç±»å‹', 'any', 'unknown']
---

TypeScript æä¾›äº†ä¸°å¯Œçš„ç±»å‹ç³»ç»Ÿï¼Œä» JavaScript ç†Ÿæ‚‰çš„åŸå§‹ç±»å‹åˆ° TypeScript ç‰¹æœ‰çš„ `unknown`ã€`never` ç­‰ç±»å‹ã€‚ç†è§£è¿™äº›åŸºç¡€ç±»å‹æ˜¯æŒæ¡ TypeScript çš„ç¬¬ä¸€æ­¥ã€‚

## åŸå§‹ç±»å‹

### stringã€numberã€boolean

è¿™ä¸‰ä¸ªæ˜¯æœ€å¸¸ç”¨çš„åŸå§‹ç±»å‹ï¼Œä¸ JavaScript çš„åŸºæœ¬ç±»å‹ä¸€ä¸€å¯¹åº”ï¼š

```typescript
// TypeScript 5.x

// å­—ç¬¦ä¸²
const username: string = 'å¼ ä¸‰'
const greeting: string = `ä½ å¥½ï¼Œ${username}`

// æ•°å­—ï¼ˆæ•´æ•°å’Œæµ®ç‚¹æ•°éƒ½æ˜¯ numberï¼‰
const age: number = 25
const price: number = 99.99
const hex: number = 0xff
const binary: number = 0b1010
const octal: number = 0o744

// å¸ƒå°”å€¼
const isActive: boolean = true
const hasPermission: boolean = false
```

ğŸ”¶ æ³¨æ„ï¼šä½¿ç”¨å°å†™çš„ `string`ã€`number`ã€`boolean`ï¼Œè€Œä¸æ˜¯å¤§å†™çš„ `String`ã€`Number`ã€`Boolean`ã€‚å¤§å†™ç‰ˆæœ¬æ˜¯ JavaScript çš„åŒ…è£…å¯¹è±¡ç±»å‹ï¼Œå‡ ä¹ä¸åº”è¯¥ä½¿ç”¨ã€‚

```typescript
// âŒ é”™è¯¯å†™æ³•
const name: String = 'å¼ ä¸‰' // ä¸æ¨è
const count: Number = 10 // ä¸æ¨è

// âœ… æ­£ç¡®å†™æ³•
const name: string = 'å¼ ä¸‰'
const count: number = 10
```

### null å’Œ undefined

åœ¨ TypeScript ä¸­ï¼Œ`null` å’Œ `undefined` æ—¢æ˜¯å€¼ä¹Ÿæ˜¯ç±»å‹ï¼š

```typescript
let u: undefined = undefined
let n: null = null

// é»˜è®¤æƒ…å†µä¸‹ï¼Œnull å’Œ undefined å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹
let str: string = 'hello'
str = null // é»˜è®¤å…è®¸ï¼Œä½†ä¸æ¨è
str = undefined // é»˜è®¤å…è®¸ï¼Œä½†ä¸æ¨è
```

ğŸ¯ å¼€å¯ `strictNullChecks`ï¼ˆæ¨èï¼‰åï¼Œ`null` å’Œ `undefined` åªèƒ½èµ‹å€¼ç»™è‡ªèº«ç±»å‹æˆ– `void`ï¼š

```typescript
// tsconfig.json: "strictNullChecks": true

let str: string = 'hello'
// str = null;      // âŒ é”™è¯¯
// str = undefined; // âŒ é”™è¯¯

// éœ€è¦æ˜¾å¼å£°æ˜å¯ç©ºç±»å‹
let nullableStr: string | null = 'hello'
nullableStr = null // âœ… æ­£ç¡®

let optionalStr: string | undefined = 'hello'
optionalStr = undefined // âœ… æ­£ç¡®
```

## ç‰¹æ®Šç±»å‹

### anyï¼šä»»æ„ç±»å‹

`any` ç±»å‹å¯ä»¥æ¥å—ä»»ä½•å€¼ï¼Œç›¸å½“äºå…³é—­äº†ç±»å‹æ£€æŸ¥ï¼š

```typescript
let value: any = 42
value = 'hello' // âœ… å…è®¸
value = true // âœ… å…è®¸
value = { name: 'å¼ ä¸‰' } // âœ… å…è®¸

// any ç±»å‹å¯ä»¥è®¿é—®ä»»æ„å±æ€§å’Œæ–¹æ³•ï¼ˆä¸æ£€æŸ¥ï¼‰
value.foo()
value.bar.baz
value[0]
```

ğŸ”¶ è­¦å‘Šï¼š`any` ä¼šè®© TypeScript å¤±å»ç±»å‹å®‰å…¨æ€§ï¼Œåº”å°½é‡é¿å…ä½¿ç”¨ã€‚å¸¸è§çš„åˆç†ä½¿ç”¨åœºæ™¯ï¼š

```typescript
// åœºæ™¯1ï¼šè¿ç§»æ—§ä»£ç æ—¶ä¸´æ—¶ä½¿ç”¨
const legacyData: any = getLegacyData()

// åœºæ™¯2ï¼šå¤„ç†åŠ¨æ€å†…å®¹
function handleDynamicData(data: any) {
  // å¤æ‚çš„è¿è¡Œæ—¶æ•°æ®å¤„ç†
}

// åœºæ™¯3ï¼šç±»å‹å®šä¹‰å›°éš¾æ—¶çš„ä¸´æ—¶æ–¹æ¡ˆ
const complexConfig: any = {
  // æš‚æ—¶æ— æ³•ç²¾ç¡®å®šä¹‰çš„é…ç½®
}
```

### unknownï¼šå®‰å…¨çš„ä»»æ„ç±»å‹

`unknown` æ˜¯ TypeScript 3.0 å¼•å…¥çš„ç±»å‹å®‰å…¨ç‰ˆ `any`ã€‚å®ƒå¯ä»¥æ¥å—ä»»ä½•å€¼ï¼Œä½†ä½¿ç”¨å‰å¿…é¡»è¿›è¡Œç±»å‹æ£€æŸ¥ï¼š

```typescript
let value: unknown = 42
value = 'hello' // âœ… å…è®¸èµ‹å€¼
value = true // âœ… å…è®¸èµ‹å€¼

// âŒ ä½†ä¸èƒ½ç›´æ¥ä½¿ç”¨
// value.foo();           // é”™è¯¯
// value.length;          // é”™è¯¯
// const n: number = value; // é”™è¯¯

// âœ… å¿…é¡»å…ˆè¿›è¡Œç±»å‹æ£€æŸ¥æˆ–æ–­è¨€
if (typeof value === 'string') {
  console.log(value.length) // ç°åœ¨å¯ä»¥è®¿é—® string çš„å±æ€§
}

if (typeof value === 'number') {
  console.log(value.toFixed(2)) // ç°åœ¨å¯ä»¥è°ƒç”¨ number çš„æ–¹æ³•
}
```

ğŸ¤” `any` vs `unknown` çš„å…³é”®åŒºåˆ«ï¼š

| ç‰¹æ€§           | any | unknown                    |
| -------------- | --- | -------------------------- |
| å¯èµ‹ä»»ä½•å€¼     | âœ…  | âœ…                         |
| å¯èµ‹ç»™ä»»ä½•ç±»å‹ | âœ…  | âŒï¼ˆåªèƒ½èµ‹ç»™ any/unknownï¼‰ |
| å¯è®¿é—®ä»»æ„å±æ€§ | âœ…  | âŒï¼ˆéœ€è¦ç±»å‹æ”¶çª„ï¼‰         |
| ç±»å‹å®‰å…¨       | âŒ  | âœ…                         |

```typescript
// unknown åªèƒ½èµ‹ç»™ any å’Œ unknown
let u: unknown = 'hello'
let a: any = u // âœ…
let b: unknown = u // âœ…
// let c: string = u;    // âŒ é”™è¯¯
```

### neverï¼šæ°¸ä¸å­˜åœ¨çš„å€¼

`never` è¡¨ç¤ºæ°¸è¿œä¸ä¼šå‘ç”Ÿçš„ç±»å‹ï¼Œä¸»è¦ç”¨äºï¼š

**1. å‡½æ•°æ°¸è¿œä¸ä¼šæ­£å¸¸è¿”å›**

```typescript
// æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°
function throwError(message: string): never {
  throw new Error(message)
}

// æ— é™å¾ªç¯çš„å‡½æ•°
function infiniteLoop(): never {
  while (true) {
    // æ°¸è¿œä¸ä¼šé€€å‡º
  }
}

// ä½¿ç”¨ç¤ºä¾‹
function fail(): never {
  return throwError('æ“ä½œå¤±è´¥')
}
```

**2. ç©·å°½æ£€æŸ¥ï¼ˆExhaustive Checkï¼‰**

```typescript
type Status = 'pending' | 'success' | 'error'

function handleStatus(status: Status) {
  switch (status) {
    case 'pending':
      return 'ç­‰å¾…ä¸­...'
    case 'success':
      return 'æˆåŠŸï¼'
    case 'error':
      return 'å¤±è´¥ï¼'
    default:
      // å¦‚æœæ‰€æœ‰æƒ…å†µéƒ½å¤„ç†äº†ï¼Œstatus çš„ç±»å‹æ˜¯ never
      const _exhaustiveCheck: never = status
      return _exhaustiveCheck
  }
}

// å¦‚æœæ–°å¢äº†çŠ¶æ€ä½†å¿˜è®°å¤„ç†ï¼ŒTypeScript ä¼šæŠ¥é”™
type Status2 = 'pending' | 'success' | 'error' | 'cancelled'

function handleStatus2(status: Status2) {
  switch (status) {
    case 'pending':
      return 'ç­‰å¾…ä¸­...'
    case 'success':
      return 'æˆåŠŸï¼'
    case 'error':
      return 'å¤±è´¥ï¼'
    default:
      // âŒ é”™è¯¯ï¼šç±»å‹ "cancelled" ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ "never"
      const _exhaustiveCheck: never = status
      return _exhaustiveCheck
  }
}
```

### voidï¼šæ— è¿”å›å€¼

`void` è¡¨ç¤ºå‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼ˆæˆ–è¿”å› `undefined`ï¼‰ï¼š

```typescript
function logMessage(message: string): void {
  console.log(message)
  // æ²¡æœ‰ return è¯­å¥ï¼Œæˆ– return undefined
}

function greet(name: string): void {
  console.log(`Hello, ${name}!`)
  return // è¿”å› undefined
}

// void ç±»å‹çš„å˜é‡åªèƒ½èµ‹å€¼ undefined
let result: void = undefined
// result = null;  // strictNullChecks å¼€å¯æ—¶é”™è¯¯
```

ğŸ¤” `void` vs `never`ï¼š

```typescript
// voidï¼šå‡½æ•°æ­£å¸¸ç»“æŸï¼Œä½†ä¸è¿”å›æœ‰æ„ä¹‰çš„å€¼
function log(): void {
  console.log('done')
}

// neverï¼šå‡½æ•°æ°¸è¿œä¸ä¼šæ­£å¸¸ç»“æŸ
function crash(): never {
  throw new Error('crash')
}
```

## ç±»å‹æ¨æ–­

TypeScript æœ‰å¼ºå¤§çš„ç±»å‹æ¨æ–­èƒ½åŠ›ï¼Œå¾ˆå¤šæ—¶å€™ä¸éœ€è¦æ‰‹åŠ¨æ ‡æ³¨ï¼š

```typescript
// è‡ªåŠ¨æ¨æ–­ä¸º string
let name = 'å¼ ä¸‰'

// è‡ªåŠ¨æ¨æ–­ä¸º number
let age = 25

// è‡ªåŠ¨æ¨æ–­ä¸º boolean
let isActive = true

// è‡ªåŠ¨æ¨æ–­ä¸º string[]
let names = ['å¼ ä¸‰', 'æå››']

// è‡ªåŠ¨æ¨æ–­ä¸º { name: string; age: number }
let user = {
  name: 'å¼ ä¸‰',
  age: 25,
}
```

ğŸ”¶ ä½•æ—¶éœ€è¦æ˜¾å¼æ ‡æ³¨ç±»å‹ï¼š

```typescript
// 1. å˜é‡å£°æ˜æ—¶æ²¡æœ‰åˆå§‹åŒ–
let count: number
count = 10

// 2. å‡½æ•°å‚æ•°ï¼ˆå¿…é¡»æ ‡æ³¨ï¼‰
function greet(name: string) {
  console.log(`Hello, ${name}`)
}

// 3. å¸Œæœ›ç±»å‹æ¯”æ¨æ–­ç»“æœæ›´å®½æ³›
let id: string | number = 123
id = 'abc' // åç»­å¯èƒ½æ˜¯å­—ç¬¦ä¸²

// 4. ç©ºæ•°ç»„éœ€è¦æŒ‡å®šå…ƒç´ ç±»å‹
const items: string[] = []
items.push('hello')
```

## ç±»å‹æ–­è¨€

å½“ä½ æ¯” TypeScript æ›´äº†è§£æŸä¸ªå€¼çš„ç±»å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€ï¼š

```typescript
// æ–¹å¼ä¸€ï¼šas è¯­æ³•ï¼ˆæ¨èï¼‰
const input = document.getElementById('myInput') as HTMLInputElement
input.value = 'hello'

// æ–¹å¼äºŒï¼šå°–æ‹¬å·è¯­æ³•ï¼ˆä¸èƒ½åœ¨ JSX ä¸­ä½¿ç”¨ï¼‰
const input2 = <HTMLInputElement>document.getElementById('myInput')
```

ğŸ”¶ ç±»å‹æ–­è¨€ä¸æ˜¯ç±»å‹è½¬æ¢ï¼Œå®ƒåªæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨"ç›¸ä¿¡æˆ‘"ï¼š

```typescript
// æ–­è¨€åªåœ¨ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼Œä¸æ”¹å˜è¿è¡Œæ—¶çš„å€¼
const str = '123' as any as number
console.log(typeof str) // ä»ç„¶æ˜¯ "string"

// åŒé‡æ–­è¨€ï¼šé€šè¿‡ any æˆ– unknown ç»•è¿‡ç±»å‹æ£€æŸ¥ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
const value = 'hello' as unknown as number
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ ä»€ä¹ˆæ—¶å€™ç”¨ anyï¼Œä»€ä¹ˆæ—¶å€™ç”¨ unknownï¼Ÿ

ä¼˜å…ˆä½¿ç”¨ `unknown`ã€‚åªæœ‰åœ¨ä»¥ä¸‹æƒ…å†µè€ƒè™‘ `any`ï¼š

- å¿«é€ŸåŸå‹å¼€å‘
- è¿ç§»æ—§ JavaScript ä»£ç 
- ç¬¬ä¸‰æ–¹åº“ç±»å‹å®šä¹‰ä¸å®Œå–„

```typescript
// å¤„ç†å¤–éƒ¨ API æ•°æ®çš„æ¨èæ–¹å¼
async function fetchData(): Promise<unknown> {
  const response = await fetch('/api/data')
  return response.json()
}

// ä½¿ç”¨æ—¶è¿›è¡Œç±»å‹æ£€æŸ¥
const data = await fetchData()
if (isValidUser(data)) {
  console.log(data.name) // ç±»å‹å®‰å…¨
}

function isValidUser(data: unknown): data is { name: string } {
  return typeof data === 'object' && data !== null && 'name' in data
}
```

### ğŸ™‹ null å’Œ undefined æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- `undefined`ï¼šå˜é‡å·²å£°æ˜ä½†æœªèµ‹å€¼
- `null`ï¼šæ˜ç¡®è¡¨ç¤º"æ— å€¼"

```typescript
// å®è·µä¸­çš„æƒ¯ä¾‹
interface User {
  name: string
  nickname?: string // å¯é€‰å±æ€§ï¼Œå¯èƒ½æ˜¯ undefined
  deletedAt: Date | null // æ˜ç¡®å¯èƒ½ä¸º null
}
```

### ğŸ™‹ strictNullChecks åº”è¯¥å¼€å¯å—ï¼Ÿ

âœ… å¼ºçƒˆå»ºè®®å¼€å¯ã€‚å®ƒèƒ½å¸®ä½ æ•è·å¤§é‡æ½œåœ¨çš„ null/undefined é”™è¯¯ï¼š

```typescript
// å¼€å¯ strictNullChecks
function getLength(str: string | null): number {
  // return str.length;  // âŒ é”™è¯¯ï¼šstr å¯èƒ½ä¸º null
  return str?.length ?? 0 // âœ… å®‰å…¨å¤„ç†
}
```

## æ€»ç»“

| ç±»å‹        | ç”¨é€”               | ç¤ºä¾‹               |
| ----------- | ------------------ | ------------------ |
| `string`    | å­—ç¬¦ä¸²             | `'hello'`          |
| `number`    | æ•°å­—               | `42`, `3.14`       |
| `boolean`   | å¸ƒå°”å€¼             | `true`, `false`    |
| `null`      | ç©ºå€¼               | `null`             |
| `undefined` | æœªå®šä¹‰             | `undefined`        |
| `any`       | ä»»æ„ç±»å‹ï¼ˆä¸å®‰å…¨ï¼‰ | è°¨æ…ä½¿ç”¨           |
| `unknown`   | ä»»æ„ç±»å‹ï¼ˆå®‰å…¨ï¼‰   | éœ€è¦ç±»å‹æ£€æŸ¥åä½¿ç”¨ |
| `never`     | æ°¸ä¸å­˜åœ¨           | æŠ›å‡ºå¼‚å¸¸ã€æ— é™å¾ªç¯ |
| `void`      | æ— è¿”å›å€¼           | å‡½æ•°ä¸è¿”å›å€¼       |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ æ•°ç»„ä¸å…ƒç»„ç±»å‹ï¼Œäº†è§£å¦‚ä½•åœ¨ TypeScript ä¸­å¤„ç†é›†åˆæ•°æ®ã€‚
