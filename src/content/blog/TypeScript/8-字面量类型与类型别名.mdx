---
title: 'å­—é¢é‡ç±»å‹ä¸ç±»å‹åˆ«å'
description: 'TypeScript å­—é¢é‡ç±»å‹ä¸ç±»å‹åˆ«åè¯¦è§£ï¼šå­—ç¬¦ä¸²å­—é¢é‡ã€æ•°å­—å­—é¢é‡ã€type å…³é”®å­—ã€ç±»å‹åˆ«åä¸æ¥å£çš„åŒºåˆ«'
pubDate: 2024-01-22
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'å­—é¢é‡ç±»å‹', 'ç±»å‹åˆ«å', 'type', 'interface']
---

å­—é¢é‡ç±»å‹è®©ä½ å¯ä»¥æŒ‡å®šå˜é‡å¿…é¡»æ˜¯ç‰¹å®šçš„å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯æŸç§ç±»å‹ã€‚ç±»å‹åˆ«ååˆ™è®©ä½ å¯ä»¥ç»™ç±»å‹èµ·ä¸€ä¸ªæœ‰æ„ä¹‰çš„åå­—ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚è¿™ä¸¤ä¸ªç‰¹æ€§æ˜¯ TypeScript ç±»å‹ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚

## å­—é¢é‡ç±»å‹

### å­—ç¬¦ä¸²å­—é¢é‡

```typescript
// TypeScript 5.x

// å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹
let direction: 'up' | 'down' | 'left' | 'right'

direction = 'up' // âœ…
direction = 'down' // âœ…
// direction = 'forward';  // âŒ ä¸åœ¨å…è®¸çš„å€¼ä¸­

// å‡½æ•°å‚æ•°ä½¿ç”¨å­—é¢é‡ç±»å‹
function move(dir: 'up' | 'down' | 'left' | 'right') {
  console.log(`Moving ${dir}`)
}

move('up') // âœ…
// move('diagonal');  // âŒ é”™è¯¯
```

### æ•°å­—å­—é¢é‡

```typescript
// æ•°å­—å­—é¢é‡ç±»å‹
type DiceValue = 1 | 2 | 3 | 4 | 5 | 6

function rollDice(): DiceValue {
  return Math.floor(Math.random() * 6 + 1) as DiceValue
}

const result = rollDice() // 1 | 2 | 3 | 4 | 5 | 6

// HTTP çŠ¶æ€ç 
type SuccessCode = 200 | 201 | 204
type ClientErrorCode = 400 | 401 | 403 | 404
type ServerErrorCode = 500 | 502 | 503

type StatusCode = SuccessCode | ClientErrorCode | ServerErrorCode
```

### å¸ƒå°”å­—é¢é‡

```typescript
// å¸ƒå°”å­—é¢é‡
type True = true
type False = false

// å®é™…åº”ç”¨ï¼šæ¡ä»¶ç±»å‹çš„å¼€å…³
type IsEnabled = true

function doSomething<T extends boolean>(
  enabled: T
): T extends true ? string : number {
  return (enabled ? 'enabled' : 0) as any
}

const a = doSomething(true) // string
const b = doSomething(false) // number
```

### const æ¨æ–­

ä½¿ç”¨ `const` å£°æ˜æ—¶è‡ªåŠ¨æ¨æ–­ä¸ºå­—é¢é‡ç±»å‹ï¼š

```typescript
// let æ¨æ–­ä¸ºå®½æ³›ç±»å‹
let x = 'hello' // string
let y = 42 // number

// const æ¨æ–­ä¸ºå­—é¢é‡ç±»å‹
const a = 'hello' // "hello"
const b = 42 // 42

// ä½†å¯¹è±¡å’Œæ•°ç»„ä¸åŒ
const obj = { name: 'hello' } // { name: string }
const arr = [1, 2, 3] // number[]

// ä½¿ç”¨ as const è·å¾—å­—é¢é‡ç±»å‹
const objConst = { name: 'hello' } as const // { readonly name: "hello" }
const arrConst = [1, 2, 3] as const // readonly [1, 2, 3]
```

## ç±»å‹åˆ«å

### åŸºæœ¬è¯­æ³•

ä½¿ç”¨ `type` å…³é”®å­—å®šä¹‰ç±»å‹åˆ«åï¼š

```typescript
// åŸºç¡€ç±»å‹åˆ«å
type ID = string | number
type Name = string

// å¯¹è±¡ç±»å‹åˆ«å
type User = {
  id: ID
  name: Name
  email: string
}

// å‡½æ•°ç±»å‹åˆ«å
type Formatter = (value: number) => string

// ä½¿ç”¨
const userId: ID = 123
const userName: Name = 'å¼ ä¸‰'

const user: User = {
  id: 1,
  name: 'å¼ ä¸‰',
  email: 'zhangsan@example.com',
}

const format: Formatter = (n) => n.toFixed(2)
```

### å¤æ‚ç±»å‹åˆ«å

```typescript
// è”åˆç±»å‹åˆ«å
type Status = 'pending' | 'success' | 'error'
type Result<T> = { success: true; data: T } | { success: false; error: string }

// äº¤å‰ç±»å‹åˆ«å
type Timestamped = { createdAt: Date; updatedAt: Date }
type Identifiable = { id: string }
type Entity = Timestamped & Identifiable

// æ¡ä»¶ç±»å‹åˆ«å
type NonNullable<T> = T extends null | undefined ? never : T
type Flatten<T> = T extends Array<infer U> ? U : T

// é€’å½’ç±»å‹åˆ«å
type JSONValue =
  | string
  | number
  | boolean
  | null
  | JSONValue[]
  | { [key: string]: JSONValue }
```

### æ³›å‹ç±»å‹åˆ«å

```typescript
// æ³›å‹ç±»å‹åˆ«å
type Container<T> = {
  value: T
}

type Nullable<T> = T | null
type Optional<T> = T | undefined

type AsyncResult<T> = Promise<Result<T>>

// ä½¿ç”¨
const numberContainer: Container<number> = { value: 42 }
const nullableString: Nullable<string> = null
const optionalNumber: Optional<number> = undefined
```

## ç±»å‹åˆ«å vs æ¥å£

ä¸¤è€…åœ¨å¾ˆå¤šåœºæ™¯ä¸‹å¯ä»¥äº’æ¢ï¼Œä½†æœ‰ä¸€äº›å…³é”®åŒºåˆ«ï¼š

### è¯­æ³•å·®å¼‚

```typescript
// å¯¹è±¡ç±»å‹ï¼šä¸¤è€…ç­‰ä»·
type UserType = {
  name: string
  age: number
}

interface UserInterface {
  name: string
  age: number
}

// å‡½æ•°ç±»å‹
type FnType = (x: number) => number

interface FnInterface {
  (x: number): number
}
```

### æ¥å£å¯ä»¥åˆå¹¶

```typescript
// æ¥å£å¯ä»¥å¤šæ¬¡å£°æ˜ï¼Œä¼šè‡ªåŠ¨åˆå¹¶
interface User {
  name: string
}

interface User {
  age: number
}

// åˆå¹¶åï¼š{ name: string; age: number }
const user: User = { name: 'å¼ ä¸‰', age: 25 }

// ç±»å‹åˆ«åä¸èƒ½é‡å¤å£°æ˜
// type User = { name: string };
// type User = { age: number };  // âŒ é”™è¯¯ï¼šé‡å¤æ ‡è¯†ç¬¦
```

### ç±»å‹åˆ«åæ›´çµæ´»

```typescript
// ç±»å‹åˆ«åå¯ä»¥è¡¨ç¤ºåŸå§‹ç±»å‹
type ID = string
type Name = string

// ç±»å‹åˆ«åå¯ä»¥è¡¨ç¤ºè”åˆç±»å‹
type Status = 'pending' | 'success' | 'error'

// ç±»å‹åˆ«åå¯ä»¥è¡¨ç¤ºå…ƒç»„
type Point = [number, number]

// ç±»å‹åˆ«åå¯ä»¥ä½¿ç”¨ typeof
const config = { api: 'xxx', timeout: 5000 }
type Config = typeof config

// æ¥å£åªèƒ½è¡¨ç¤ºå¯¹è±¡ç±»å‹
// interface Status = 'pending' | 'success' | 'error';  // âŒ è¯­æ³•é”™è¯¯
```

### ç»§æ‰¿æ–¹å¼ä¸åŒ

```typescript
// æ¥å£ä½¿ç”¨ extends
interface Animal {
  name: string
}

interface Dog extends Animal {
  bark(): void
}

// ç±»å‹åˆ«åä½¿ç”¨äº¤å‰ç±»å‹
type AnimalType = {
  name: string
}

type DogType = AnimalType & {
  bark(): void
}

// æ··åˆä½¿ç”¨ä¹Ÿå¯ä»¥
interface Cat extends AnimalType {
  meow(): void
}

type Bird = Animal & {
  fly(): void
}
```

### ä½•æ—¶ç”¨ typeï¼Œä½•æ—¶ç”¨ interfaceï¼Ÿ

```typescript
// âœ… ç”¨ interfaceï¼šå®šä¹‰å¯¹è±¡ç»“æ„ã€ç±»çš„å¥‘çº¦
interface UserService {
  getUser(id: string): Promise<User>
  updateUser(user: User): Promise<void>
}

class UserServiceImpl implements UserService {
  async getUser(id: string) {
    /* ... */
  }
  async updateUser(user: User) {
    /* ... */
  }
}

// âœ… ç”¨ typeï¼šè”åˆç±»å‹ã€å…ƒç»„ã€å¤æ‚ç±»å‹æ“ä½œ
type Status = 'active' | 'inactive' | 'pending'
type Point = [number, number]
type Callback<T> = (error: Error | null, result: T) => void
```

ğŸ¯ å®ç”¨å»ºè®®ï¼š

- å›¢é˜Ÿç»Ÿä¸€é£æ ¼æœ€é‡è¦
- éœ€è¦åˆå¹¶å£°æ˜æ—¶ç”¨ `interface`
- éœ€è¦è”åˆç±»å‹ã€å…ƒç»„æ—¶ç”¨ `type`
- ç®€å•å¯¹è±¡ç»“æ„ä¸¤è€…éƒ½å¯ä»¥

## ä»å€¼åˆ›å»ºç±»å‹

### typeof æ“ä½œç¬¦

```typescript
// ä»å€¼æ¨æ–­ç±»å‹
const user = {
  name: 'å¼ ä¸‰',
  age: 25,
  roles: ['admin', 'user'],
}

type User = typeof user
// { name: string; age: number; roles: string[] }

// ä»å‡½æ•°æ¨æ–­ç±»å‹
function createUser(name: string, age: number) {
  return { id: Math.random(), name, age }
}

type CreateUserFn = typeof createUser
// (name: string, age: number) => { id: number; name: string; age: number }

type UserFromFn = ReturnType<typeof createUser>
// { id: number; name: string; age: number }
```

### keyof æ“ä½œç¬¦

```typescript
interface User {
  id: number
  name: string
  email: string
}

type UserKeys = keyof User // "id" | "name" | "email"

// ç»“åˆç´¢å¼•è®¿é—®
type UserValues = User[keyof User] // number | string

// å®ç”¨å‡½æ•°
function getProperty<T, K extends keyof T>(obj: T, key: K): T[K] {
  return obj[key]
}

const user: User = { id: 1, name: 'å¼ ä¸‰', email: 'test@test.com' }
const name = getProperty(user, 'name') // string
const id = getProperty(user, 'id') // number
```

### ä»æ•°ç»„åˆ›å»ºè”åˆç±»å‹

```typescript
// ä½¿ç”¨ as const ä¿ç•™å­—é¢é‡ç±»å‹
const METHODS = ['GET', 'POST', 'PUT', 'DELETE'] as const

type Method = (typeof METHODS)[number]
// "GET" | "POST" | "PUT" | "DELETE"

// éªŒè¯å€¼
function request(method: Method, url: string) {
  console.log(`${method} ${url}`)
}

request('GET', '/api/users') // âœ…
// request('PATCH', '/api/users');  // âŒ é”™è¯¯
```

### ä»å¯¹è±¡åˆ›å»ºç±»å‹

```typescript
const STATUS = {
  PENDING: 'pending',
  SUCCESS: 'success',
  ERROR: 'error',
} as const

// é”®çš„è”åˆ
type StatusKey = keyof typeof STATUS // "PENDING" | "SUCCESS" | "ERROR"

// å€¼çš„è”åˆ
type StatusValue = (typeof STATUS)[keyof typeof STATUS]
// "pending" | "success" | "error"

// ä½¿ç”¨
function handleStatus(status: StatusValue) {
  switch (status) {
    case STATUS.PENDING:
      console.log('ç­‰å¾…ä¸­...')
      break
    case STATUS.SUCCESS:
      console.log('æˆåŠŸï¼')
      break
    case STATUS.ERROR:
      console.log('å¤±è´¥ï¼')
      break
  }
}
```

## å®é™…åº”ç”¨

### é…ç½®é€‰é¡¹

```typescript
type LogLevel = 'debug' | 'info' | 'warn' | 'error'
type Environment = 'development' | 'staging' | 'production'

type Config = {
  env: Environment
  logLevel: LogLevel
  apiUrl: string
  features: {
    darkMode: boolean
    analytics: boolean
  }
}

const config: Config = {
  env: 'production',
  logLevel: 'error',
  apiUrl: 'https://api.example.com',
  features: {
    darkMode: true,
    analytics: true,
  },
}
```

### äº‹ä»¶ç³»ç»Ÿ

```typescript
type EventType = 'click' | 'hover' | 'scroll' | 'resize'

type EventHandler<T extends EventType> = T extends 'click'
  ? (x: number, y: number) => void
  : T extends 'scroll'
    ? (scrollY: number) => void
    : () => void

type EventMap = {
  [K in EventType]: EventHandler<K>
}

const handlers: EventMap = {
  click: (x, y) => console.log(`Clicked at ${x}, ${y}`),
  hover: () => console.log('Hovered'),
  scroll: (y) => console.log(`Scrolled to ${y}`),
  resize: () => console.log('Resized'),
}
```

### è¡¨å•éªŒè¯

```typescript
type FieldType = 'text' | 'email' | 'number' | 'date'

type FieldConfig<T extends FieldType> = {
  type: T
  required: boolean
  label: string
  placeholder?: string
} & (T extends 'number'
  ? { min?: number; max?: number }
  : T extends 'text'
    ? { minLength?: number; maxLength?: number }
    : {})

const emailField: FieldConfig<'email'> = {
  type: 'email',
  required: true,
  label: 'é‚®ç®±',
  placeholder: 'example@email.com',
}

const ageField: FieldConfig<'number'> = {
  type: 'number',
  required: true,
  label: 'å¹´é¾„',
  min: 0,
  max: 150,
}
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ å­—é¢é‡ç±»å‹ä¼šå¢åŠ ä»£ç é‡å—ï¼Ÿ

åˆç†ä½¿ç”¨ä¼šæé«˜ä»£ç è´¨é‡ï¼Œè€Œä¸æ˜¯å¢åŠ è´Ÿæ‹…ï¼š

```typescript
// âŒ é­”æ³•å­—ç¬¦ä¸²ï¼Œå®¹æ˜“å‡ºé”™
function setStatus(status: string) {
  // ...
}
setStatus('sucess') // æ‹¼å†™é”™è¯¯ï¼Œä¸ä¼šæŠ¥é”™

// âœ… å­—é¢é‡ç±»å‹ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥
type Status = 'pending' | 'success' | 'error'
function setStatus2(status: Status) {
  // ...
}
// setStatus2('sucess');  // âŒ ç¼–è¯‘é”™è¯¯ï¼Œç«‹å³å‘ç°é—®é¢˜
```

### ğŸ™‹ ç±»å‹åˆ«åä¼šå½±å“è¿è¡Œæ—¶å—ï¼Ÿ

ä¸ä¼šã€‚ç±»å‹ä¿¡æ¯åªå­˜åœ¨äºç¼–è¯‘æ—¶ï¼š

```typescript
type UserID = string

// ç¼–è¯‘åçš„ JavaScript
// const id = "123";  // ç±»å‹ä¿¡æ¯å®Œå…¨æ¶ˆå¤±
const id: UserID = '123'
```

### ğŸ™‹ å¾ªç¯å¼•ç”¨ç±»å‹æ€ä¹ˆå¤„ç†ï¼Ÿ

TypeScript æ”¯æŒç±»å‹çš„å¾ªç¯å¼•ç”¨ï¼š

```typescript
// é€’å½’ç±»å‹ï¼šæ ‘å½¢ç»“æ„
type TreeNode = {
  value: string
  children: TreeNode[]
}

// é“¾è¡¨
type LinkedNode<T> = {
  value: T
  next: LinkedNode<T> | null
}

// JSON å€¼
type JSONValue =
  | string
  | number
  | boolean
  | null
  | JSONValue[]
  | { [key: string]: JSONValue }
```

## æ€»ç»“

| ç‰¹æ€§         | è¯­æ³•              | ç”¨é€”               |
| ------------ | ----------------- | ------------------ |
| å­—ç¬¦ä¸²å­—é¢é‡ | `'value'`         | é™å®šå…·ä½“çš„å­—ç¬¦ä¸²å€¼ |
| æ•°å­—å­—é¢é‡   | `42`              | é™å®šå…·ä½“çš„æ•°å­—å€¼   |
| ç±»å‹åˆ«å     | `type Name = ...` | ç»™ç±»å‹èµ·åå­—       |
| typeof       | `typeof value`    | ä»å€¼è·å–ç±»å‹       |
| keyof        | `keyof Type`      | è·å–ç±»å‹çš„é”®       |
| as const     | `value as const`  | è½¬ä¸ºå­—é¢é‡ç±»å‹     |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†è¿›å…¥æ¥å£çš„å­¦ä¹ ï¼Œæ·±å…¥äº†è§£ TypeScript ä¸­å®šä¹‰å¯¹è±¡ç»“æ„çš„å¦ä¸€ç§é‡è¦æ–¹å¼ã€‚
