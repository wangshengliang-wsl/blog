---
title: 'å†…ç½®å·¥å…·ç±»å‹ï¼ˆä¸Šï¼‰'
description: 'TypeScript å†…ç½®å·¥å…·ç±»å‹è¯¦è§£ï¼šPartialã€Requiredã€Readonlyã€Pickã€Omit çš„ç”¨æ³•ä¸å®ç°åŸç†'
pubDate: 2024-02-02
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'å·¥å…·ç±»å‹', 'Partial', 'Pick', 'Omit']
---

TypeScript å†…ç½®äº†è®¸å¤šå®ç”¨çš„å·¥å…·ç±»å‹ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œå¸¸è§çš„ç±»å‹è½¬æ¢ã€‚æœ¬ç¯‡ä»‹ç» Partialã€Requiredã€Readonlyã€Pickã€Omit è¿™äº”ä¸ªæœ€å¸¸ç”¨çš„å·¥å…·ç±»å‹ã€‚

## Partial\<T\>

å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰ï¼š

```typescript
// TypeScript 5.x

interface User {
  id: number
  name: string
  email: string
  age: number
}

// æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰
type PartialUser = Partial<User>
// { id?: number; name?: string; email?: string; age?: number }

// å¸¸ç”¨äºæ›´æ–°æ“ä½œ
function updateUser(id: number, updates: Partial<User>): void {
  // åªæ›´æ–°æä¾›çš„å­—æ®µ
}

updateUser(1, { name: 'æ–°åå­—' }) // âœ… åªæ›´æ–° name
updateUser(1, { age: 30, email: 'new@test.com' }) // âœ… æ›´æ–°å¤šä¸ªå­—æ®µ

// å®ç°åŸç†
type MyPartial<T> = {
  [K in keyof T]?: T[K]
}
```

## Required\<T\>

å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¿…éœ€ï¼ˆä¸ Partial ç›¸åï¼‰ï¼š

```typescript
interface Config {
  host?: string
  port?: number
  timeout?: number
}

// æ‰€æœ‰å±æ€§å˜ä¸ºå¿…éœ€
type RequiredConfig = Required<Config>
// { host: string; port: number; timeout: number }

// å¸¸ç”¨äºéªŒè¯åçš„é…ç½®
function validateConfig(config: Config): RequiredConfig {
  return {
    host: config.host ?? 'localhost',
    port: config.port ?? 3000,
    timeout: config.timeout ?? 5000,
  }
}

// å®ç°åŸç†
type MyRequired<T> = {
  [K in keyof T]-?: T[K] // -? ç§»é™¤å¯é€‰
}
```

## Readonly\<T\>

å°†æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»ï¼š

```typescript
interface User {
  id: number
  name: string
}

type ReadonlyUser = Readonly<User>
// { readonly id: number; readonly name: string }

const user: ReadonlyUser = { id: 1, name: 'å¼ ä¸‰' }
// user.name = 'æå››';  // âŒ é”™è¯¯ï¼šåªè¯»å±æ€§

// å¸¸ç”¨äºä¸å¯å˜æ•°æ®
function freeze<T>(obj: T): Readonly<T> {
  return Object.freeze(obj)
}

// å®ç°åŸç†
type MyReadonly<T> = {
  readonly [K in keyof T]: T[K]
}
```

## Pick\<T, K\>

ä»ç±»å‹ä¸­é€‰å–éƒ¨åˆ†å±æ€§ï¼š

```typescript
interface User {
  id: number
  name: string
  email: string
  password: string
  createdAt: Date
}

// é€‰å–éƒ¨åˆ†å±æ€§
type UserBasic = Pick<User, 'id' | 'name'>
// { id: number; name: string }

type UserPublic = Pick<User, 'id' | 'name' | 'email'>
// { id: number; name: string; email: string }

// å¸¸ç”¨äº API å“åº”è¿‡æ»¤
function getPublicProfile(user: User): Pick<User, 'id' | 'name' | 'email'> {
  return {
    id: user.id,
    name: user.name,
    email: user.email,
  }
}

// å®ç°åŸç†
type MyPick<T, K extends keyof T> = {
  [P in K]: T[P]
}
```

## Omit\<T, K\>

ä»ç±»å‹ä¸­æ’é™¤éƒ¨åˆ†å±æ€§ï¼ˆä¸ Pick ç›¸åï¼‰ï¼š

```typescript
interface User {
  id: number
  name: string
  email: string
  password: string
}

// æ’é™¤æ•æ„Ÿå­—æ®µ
type SafeUser = Omit<User, 'password'>
// { id: number; name: string; email: string }

// æ’é™¤å¤šä¸ªå­—æ®µ
type UserInput = Omit<User, 'id' | 'password'>
// { name: string; email: string }

// å¸¸ç”¨äºåˆ›å»º DTO
type CreateUserDto = Omit<User, 'id'>
type UpdateUserDto = Partial<Omit<User, 'id'>>

// å®ç°åŸç†
type MyOmit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>
```

## ç»„åˆä½¿ç”¨

```typescript
interface User {
  id: number
  name: string
  email: string
  password: string
  role: string
  createdAt: Date
  updatedAt: Date
}

// åˆ›å»ºç”¨æˆ·æ—¶çš„è¾“å…¥
type CreateUser = Omit<User, 'id' | 'createdAt' | 'updatedAt'>

// æ›´æ–°ç”¨æˆ·æ—¶çš„è¾“å…¥
type UpdateUser = Partial<Omit<User, 'id' | 'createdAt' | 'updatedAt'>>

// å…¬å¼€çš„ç”¨æˆ·ä¿¡æ¯
type PublicUser = Readonly<Pick<User, 'id' | 'name' | 'email'>>

// API å“åº”
interface ApiResponse<T> {
  data: T
  status: number
}

type UserResponse = ApiResponse<PublicUser>
type UsersResponse = ApiResponse<PublicUser[]>
```

## å®é™…åº”ç”¨

### è¡¨å•çŠ¶æ€ç®¡ç†

```typescript
interface FormData {
  username: string
  email: string
  password: string
  confirmPassword: string
}

interface FormState {
  values: Partial<FormData>
  errors: Partial<Record<keyof FormData, string>>
  touched: Partial<Record<keyof FormData, boolean>>
  isValid: boolean
  isSubmitting: boolean
}

function createFormState(): FormState {
  return {
    values: {},
    errors: {},
    touched: {},
    isValid: false,
    isSubmitting: false,
  }
}
```

### æ•°æ®åº“å®ä½“

```typescript
interface Entity {
  id: string
  createdAt: Date
  updatedAt: Date
}

// æ’é™¤è‡ªåŠ¨ç”Ÿæˆçš„å­—æ®µ
type CreateDto<T extends Entity> = Omit<T, keyof Entity>

// æ›´æ–°æ—¶ id å¿…éœ€ï¼Œå…¶ä»–å¯é€‰
type UpdateDto<T extends Entity> = Pick<T, 'id'> &
  Partial<Omit<T, keyof Entity>>

interface User extends Entity {
  name: string
  email: string
}

type CreateUserDto = CreateDto<User>
// { name: string; email: string }

type UpdateUserDto = UpdateDto<User>
// { id: string } & { name?: string; email?: string }
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ Partial æ˜¯æ·±å±‚çš„å—ï¼Ÿ

ä¸æ˜¯ï¼Œåªå½±å“ç¬¬ä¸€å±‚ï¼š

```typescript
interface User {
  name: string
  address: {
    city: string
    street: string
  }
}

type PartialUser = Partial<User>
// { name?: string; address?: { city: string; street: string } }
// address å†…éƒ¨å±æ€§ä»ç„¶å¿…éœ€

// æ·±å±‚ Partial
type DeepPartial<T> = {
  [K in keyof T]?: T[K] extends object ? DeepPartial<T[K]> : T[K]
}
```

### ğŸ™‹ Pick å’Œ Omit å“ªä¸ªæ›´å¥½ç”¨ï¼Ÿ

å–å†³äºåœºæ™¯ï¼š

- é€‰å–å°‘é‡å±æ€§ï¼šç”¨ Pick
- æ’é™¤å°‘é‡å±æ€§ï¼šç”¨ Omit

```typescript
interface User {
  id: number
  name: string
  email: string
  password: string
  role: string
}

// åªéœ€è¦ 2 ä¸ªå±æ€§ -> Pick
type A = Pick<User, 'id' | 'name'>

// åªæ’é™¤ 1 ä¸ªå±æ€§ -> Omit
type B = Omit<User, 'password'>
```

## æ€»ç»“

| å·¥å…·ç±»å‹ | ä½œç”¨         | è¯­æ³•          |
| -------- | ------------ | ------------- |
| Partial  | æ‰€æœ‰å±æ€§å¯é€‰ | `Partial<T>`  |
| Required | æ‰€æœ‰å±æ€§å¿…éœ€ | `Required<T>` |
| Readonly | æ‰€æœ‰å±æ€§åªè¯» | `Readonly<T>` |
| Pick     | é€‰å–éƒ¨åˆ†å±æ€§ | `Pick<T, K>`  |
| Omit     | æ’é™¤éƒ¨åˆ†å±æ€§ | `Omit<T, K>`  |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†ç»§ç»­å­¦ä¹  Recordã€Excludeã€Extract ç­‰å·¥å…·ç±»å‹ã€‚
