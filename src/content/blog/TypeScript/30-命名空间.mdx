---
title: 'å‘½åç©ºé—´'
description: 'TypeScript å‘½åç©ºé—´è¯¦è§£ï¼šnamespace å®šä¹‰ã€å‘½åç©ºé—´åˆå¹¶ã€æ¨¡å—ä¸å‘½åç©ºé—´çš„åŒºåˆ«ä¸é€‰æ‹©'
pubDate: 2024-02-13
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'å‘½åç©ºé—´', 'namespace', 'ä»£ç ç»„ç»‡', 'æ¨¡å—åŒ–']
---

å‘½åç©ºé—´ï¼ˆNamespaceï¼‰æ˜¯ TypeScript æä¾›çš„ä¸€ç§ä»£ç ç»„ç»‡æ–¹å¼ï¼Œç”¨äºé¿å…å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“å’Œå‘½åå†²çªã€‚

## åŸºæœ¬è¯­æ³•

ä½¿ç”¨ `namespace` å…³é”®å­—å®šä¹‰å‘½åç©ºé—´ï¼š

```typescript
// TypeScript 5.x

namespace Utils {
  // å¯¼å‡ºçš„æˆå‘˜å¯ä»¥åœ¨å¤–éƒ¨è®¿é—®
  export function log(message: string): void {
    console.log(`[LOG]: ${message}`)
  }

  export function warn(message: string): void {
    console.warn(`[WARN]: ${message}`)
  }

  // æœªå¯¼å‡ºçš„æˆå‘˜æ˜¯ç§æœ‰çš„
  function formatMessage(msg: string): string {
    return `Formatted: ${msg}`
  }

  export const VERSION = '1.0.0'

  export interface Config {
    debug: boolean
    logLevel: 'info' | 'warn' | 'error'
  }

  export class Logger {
    constructor(private config: Config) {}

    log(message: string) {
      if (this.config.debug) {
        console.log(message)
      }
    }
  }
}

// ä½¿ç”¨
Utils.log('Hello')
Utils.warn('Warning')
console.log(Utils.VERSION)

const config: Utils.Config = {
  debug: true,
  logLevel: 'info',
}

const logger = new Utils.Logger(config)
```

## åµŒå¥—å‘½åç©ºé—´

å‘½åç©ºé—´å¯ä»¥åµŒå¥—ï¼š

```typescript
namespace App {
  export namespace Models {
    export interface User {
      id: number
      name: string
    }

    export interface Product {
      id: number
      name: string
      price: number
    }
  }

  export namespace Services {
    export class UserService {
      getUser(id: number): Models.User {
        return { id, name: 'å¼ ä¸‰' }
      }
    }

    export class ProductService {
      getProduct(id: number): Models.Product {
        return { id, name: 'å•†å“', price: 100 }
      }
    }
  }

  export namespace Utils {
    export function formatPrice(price: number): string {
      return `Â¥${price.toFixed(2)}`
    }
  }
}

// ä½¿ç”¨
const user: App.Models.User = { id: 1, name: 'å¼ ä¸‰' }
const service = new App.Services.UserService()
const price = App.Utils.formatPrice(99.9)

// ç®€åŒ–è®¿é—®
import Models = App.Models
import UserService = App.Services.UserService

const user2: Models.User = { id: 2, name: 'æå››' }
const userService = new UserService()
```

## å‘½åç©ºé—´åˆå¹¶

åŒåå‘½åç©ºé—´ä¼šè‡ªåŠ¨åˆå¹¶ï¼š

```typescript
// æ–‡ä»¶ 1ï¼šanimal.ts
namespace Animal {
  export interface Dog {
    bark(): void
  }

  export function createDog(): Dog {
    return {
      bark() {
        console.log('æ±ªæ±ª!')
      },
    }
  }
}

// æ–‡ä»¶ 2ï¼šanimal-extended.ts
namespace Animal {
  export interface Cat {
    meow(): void
  }

  export function createCat(): Cat {
    return {
      meow() {
        console.log('å–µå–µ!')
      },
    }
  }
}

// ä½¿ç”¨ï¼šä¸¤ä¸ªæ–‡ä»¶çš„æˆå‘˜éƒ½å¯ä»¥è®¿é—®
const dog: Animal.Dog = Animal.createDog()
const cat: Animal.Cat = Animal.createCat()

dog.bark()
cat.meow()
```

## å‘½åç©ºé—´ä¸ç±»/å‡½æ•°/æšä¸¾åˆå¹¶

å‘½åç©ºé—´å¯ä»¥ä¸å…¶ä»–å£°æ˜åˆå¹¶ï¼š

```typescript
// ä¸ç±»åˆå¹¶
class Album {
  label: Album.AlbumLabel

  constructor(label: Album.AlbumLabel) {
    this.label = label
  }
}

namespace Album {
  export interface AlbumLabel {
    name: string
    year: number
  }

  export function create(name: string): Album {
    return new Album({ name, year: new Date().getFullYear() })
  }
}

const album = Album.create('ä¸“è¾‘å')
console.log(album.label.name)

// ä¸å‡½æ•°åˆå¹¶
function buildName(firstName: string, lastName: string) {
  return `${buildName.prefix}${firstName} ${lastName}`
}

namespace buildName {
  export let prefix = 'Mr. '
  export function setPrefix(p: string) {
    prefix = p
  }
}

console.log(buildName('å¼ ', 'ä¸‰')) // Mr. å¼  ä¸‰
buildName.setPrefix('Dr. ')
console.log(buildName('æ', 'å››')) // Dr. æ å››

// ä¸æšä¸¾åˆå¹¶
enum Color {
  Red,
  Green,
  Blue,
}

namespace Color {
  export function fromHex(hex: string): Color {
    // è§£æåå…­è¿›åˆ¶é¢œè‰²
    return Color.Red
  }

  export function toHex(color: Color): string {
    switch (color) {
      case Color.Red:
        return '#FF0000'
      case Color.Green:
        return '#00FF00'
      case Color.Blue:
        return '#0000FF'
    }
  }
}

const red = Color.fromHex('#FF0000')
const hex = Color.toHex(Color.Red)
```

## è·¨æ–‡ä»¶å‘½åç©ºé—´

ä½¿ç”¨ä¸‰æ–œçº¿æŒ‡ä»¤å¼•ç”¨å…¶ä»–æ–‡ä»¶ï¼š

```typescript
// === shapes.ts ===
namespace Shapes {
  export interface Point {
    x: number
    y: number
  }

  export interface Size {
    width: number
    height: number
  }
}

// === rectangle.ts ===
/// <reference path="shapes.ts" />

namespace Shapes {
  export class Rectangle {
    constructor(
      public position: Point,
      public size: Size
    ) {}

    get area(): number {
      return this.size.width * this.size.height
    }
  }
}

// === circle.ts ===
/// <reference path="shapes.ts" />

namespace Shapes {
  export class Circle {
    constructor(
      public center: Point,
      public radius: number
    ) {}

    get area(): number {
      return Math.PI * this.radius ** 2
    }
  }
}

// === main.ts ===
/// <reference path="shapes.ts" />
/// <reference path="rectangle.ts" />
/// <reference path="circle.ts" />

const rect = new Shapes.Rectangle({ x: 0, y: 0 }, { width: 10, height: 20 })

const circle = new Shapes.Circle({ x: 5, y: 5 }, 10)
```

## å‘½åç©ºé—´åˆ«å

ä½¿ç”¨ `import` åˆ›å»ºåˆ«åç®€åŒ–è®¿é—®ï¼š

```typescript
namespace Company {
  export namespace Departments {
    export namespace Engineering {
      export class Developer {
        constructor(public name: string) {}
      }

      export class Manager {
        constructor(public name: string) {}
      }
    }

    export namespace Marketing {
      export class Designer {
        constructor(public name: string) {}
      }
    }
  }
}

// åˆ›å»ºåˆ«å
import Engineering = Company.Departments.Engineering
import Marketing = Company.Departments.Marketing

const dev = new Engineering.Developer('å¼ ä¸‰')
const designer = new Marketing.Designer('æå››')

// ä¹Ÿå¯ä»¥ä¸ºç±»åˆ›å»ºåˆ«å
import Developer = Company.Departments.Engineering.Developer
const dev2 = new Developer('ç‹äº”')
```

## æ¨¡å—ä¸­çš„å‘½åç©ºé—´

åœ¨æ¨¡å—ä¸­ä½¿ç”¨å‘½åç©ºé—´ï¼š

```typescript
// utils.ts
export namespace StringUtils {
  export function capitalize(str: string): string {
    return str.charAt(0).toUpperCase() + str.slice(1)
  }

  export function lowercase(str: string): string {
    return str.toLowerCase()
  }
}

export namespace NumberUtils {
  export function clamp(value: number, min: number, max: number): number {
    return Math.min(Math.max(value, min), max)
  }

  export function random(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min
  }
}

// main.ts
import { StringUtils, NumberUtils } from './utils'

const capitalized = StringUtils.capitalize('hello')
const clamped = NumberUtils.clamp(150, 0, 100)
```

## å‘½åç©ºé—´ vs æ¨¡å—

```typescript
// ğŸ”¶ å‘½åç©ºé—´ï¼ˆæ—§æ–¹å¼ï¼‰
namespace MyApp {
  export interface User {}
  export class UserService {}
}

// âœ… æ¨¡å—ï¼ˆæ¨èæ–¹å¼ï¼‰
// user.ts
export interface User {}
export class UserService {}

// æ¨¡å—çš„ä¼˜åŠ¿ï¼š
// 1. æ›´å¥½çš„ä»£ç ç»„ç»‡
// 2. æ›´å¥½çš„å·¥å…·æ”¯æŒ
// 3. æ›´å¥½çš„ tree-shaking
// 4. ç¬¦åˆ ES æ¨¡å—æ ‡å‡†
```

## å®é™…åº”ç”¨åœºæ™¯

### ç±»å‹å£°æ˜æ–‡ä»¶

å‘½åç©ºé—´åœ¨å£°æ˜æ–‡ä»¶ä¸­å¾ˆå¸¸è§ï¼š

```typescript
// global.d.ts
declare namespace NodeJS {
  interface ProcessEnv {
    NODE_ENV: 'development' | 'production'
    API_URL: string
  }
}

// ä½¿ç”¨
const env = process.env.NODE_ENV // ç±»å‹å®‰å…¨
const apiUrl = process.env.API_URL

// jquery.d.ts
declare namespace JQuery {
  interface Ajax {
    url: string
    method: 'GET' | 'POST' | 'PUT' | 'DELETE'
    data?: unknown
  }

  interface Event {
    type: string
    target: HTMLElement
  }
}

declare const $: {
  ajax(options: JQuery.Ajax): Promise<unknown>
  (selector: string): {
    on(event: string, handler: (e: JQuery.Event) => void): void
  }
}
```

### å…¨å±€æ‰©å±•

```typescript
// æ‰©å±•å…¨å±€å¯¹è±¡
declare global {
  interface Window {
    myApp: {
      version: string
      config: Record<string, unknown>
    }
  }

  namespace NodeJS {
    interface Global {
      myGlobal: string
    }
  }
}

// ä½¿ç”¨
window.myApp = {
  version: '1.0.0',
  config: {},
}

export {} // ä½¿æ–‡ä»¶æˆä¸ºæ¨¡å—
```

### ç¬¬ä¸‰æ–¹åº“æ‰©å±•

```typescript
// æ‰©å±• Express
declare namespace Express {
  interface Request {
    user?: {
      id: string
      role: string
    }
  }

  interface Response {
    success(data: unknown): void
    error(message: string): void
  }
}

// ä½¿ç”¨
import express from 'express'

const app = express()

app.use((req, res, next) => {
  req.user = { id: '123', role: 'admin' }
  next()
})

app.get('/', (req, res) => {
  console.log(req.user?.id) // ç±»å‹å®‰å…¨
})
```

## ä½•æ—¶ä½¿ç”¨å‘½åç©ºé—´

```typescript
// âœ… é€‚åˆä½¿ç”¨å‘½åç©ºé—´çš„åœºæ™¯

// 1. å…¨å±€ç±»å‹å£°æ˜
declare namespace MyLibrary {
  interface Options {}
}

// 2. ä¸ºç¬¬ä¸‰æ–¹åº“æ·»åŠ ç±»å‹
declare namespace Express {
  interface Request {
    customProp: string
  }
}

// 3. é€æ­¥è¿ç§»æ—§ä»£ç 

// ğŸ”¶ ä¸æ¨èä½¿ç”¨å‘½åç©ºé—´çš„åœºæ™¯

// 1. æ–°é¡¹ç›® - ä½¿ç”¨ ES æ¨¡å—
// 2. Node.js é¡¹ç›® - ä½¿ç”¨ CommonJS æˆ– ES æ¨¡å—
// 3. ç°ä»£å‰ç«¯é¡¹ç›® - ä½¿ç”¨ ES æ¨¡å—
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ å‘½åç©ºé—´å’Œæ¨¡å—å¯ä»¥æ··ç”¨å—ï¼Ÿ

```typescript
// å¯ä»¥ï¼Œä½†ä¸æ¨è
// å‘½åç©ºé—´åœ¨æ¨¡å—æ–‡ä»¶ä¸­ä¼šæˆä¸ºå¯¼å‡ºçš„ä¸€éƒ¨åˆ†

// utils.ts
export namespace Utils {
  export function log(msg: string) {
    console.log(msg)
  }
}

// main.ts
import { Utils } from './utils'
Utils.log('hello')

// æ›´å¥½çš„åšæ³•ï¼šç›´æ¥ä½¿ç”¨æ¨¡å—
// utils.ts
export function log(msg: string) {
  console.log(msg)
}
```

### ğŸ™‹ å¦‚ä½•åœ¨å£°æ˜æ–‡ä»¶ä¸­ç»„ç»‡ç±»å‹ï¼Ÿ

```typescript
// ä½¿ç”¨å‘½åç©ºé—´ç»„ç»‡ç›¸å…³ç±»å‹
declare namespace API {
  namespace Users {
    interface User {
      id: number
      name: string
    }

    interface CreateUserRequest {
      name: string
      email: string
    }

    interface UpdateUserRequest {
      name?: string
      email?: string
    }
  }

  namespace Products {
    interface Product {
      id: number
      name: string
      price: number
    }
  }
}

// ä½¿ç”¨
function createUser(data: API.Users.CreateUserRequest): API.Users.User {
  // ...
}
```

### ğŸ™‹ å‘½åç©ºé—´ä¼šå½±å“æ‰“åŒ…å¤§å°å—ï¼Ÿ

```typescript
// å‘½åç©ºé—´ç¼–è¯‘åä¼šç”Ÿæˆ IIFE
var Utils
;(function (Utils) {
  function log(msg) {
    console.log(msg)
  }
  Utils.log = log
})(Utils || (Utils = {}))

// æ¨¡å—å¯ä»¥æ›´å¥½åœ°è¿›è¡Œ tree-shaking
// ç°ä»£æ‰“åŒ…å·¥å…·æ¨èä½¿ç”¨ ES æ¨¡å—
```

## æ€»ç»“

| ç‰¹æ€§         | å‘½åç©ºé—´         | æ¨¡å—              |
| ------------ | ---------------- | ----------------- |
| è¯­æ³•         | `namespace`      | `import`/`export` |
| ä½œç”¨åŸŸ       | å…¨å±€æˆ–æ–‡ä»¶       | æ–‡ä»¶çº§åˆ«          |
| åˆå¹¶         | æ”¯æŒè‡ªåŠ¨åˆå¹¶     | ä¸æ”¯æŒ            |
| Tree-shaking | æ”¯æŒæœ‰é™         | å®Œå…¨æ”¯æŒ          |
| æ¨èåœºæ™¯     | å£°æ˜æ–‡ä»¶ã€æ—§ä»£ç  | æ–°é¡¹ç›®            |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ å£°æ˜æ–‡ä»¶åŸºç¡€ï¼Œäº†è§£å¦‚ä½•ä¸º JavaScript åº“æ·»åŠ ç±»å‹æ”¯æŒã€‚
