---
title: 'TypeScript æœ€ä½³å®è·µ'
description: 'TypeScript æœ€ä½³å®è·µï¼šç±»å‹è®¾è®¡åŸåˆ™ã€å¸¸è§é™·é˜±ã€æ€§èƒ½ä¼˜åŒ–ã€ä»£ç ç»„ç»‡å»ºè®®'
pubDate: 2024-02-18
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'æœ€ä½³å®è·µ', 'ç±»å‹è®¾è®¡', 'æ€§èƒ½ä¼˜åŒ–', 'ä»£ç è§„èŒƒ']
---

æœ¬ç¯‡æ€»ç»“ TypeScript å¼€å‘ä¸­çš„æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ å†™å‡ºæ›´å®‰å…¨ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚

## ç±»å‹è®¾è®¡åŸåˆ™

### ä¼˜å…ˆä½¿ç”¨ interface

```typescript
// TypeScript 5.x

// âœ… æ¨èï¼šå¯¹è±¡ç±»å‹ä½¿ç”¨ interface
interface User {
  id: number
  name: string
  email: string
}

// âœ… interface å¯ä»¥æ‰©å±•å’Œåˆå¹¶
interface User {
  age?: number
}

// âœ… type ç”¨äºè”åˆç±»å‹ã€æ˜ å°„ç±»å‹ç­‰
type Status = 'pending' | 'active' | 'inactive'
type UserKeys = keyof User
type PartialUser = Partial<User>

// ğŸ”¶ é¿å…ï¼šç®€å•å¯¹è±¡ç±»å‹ä½¿ç”¨ type
type UserType = {
  id: number
  name: string
}
```

### é¿å…ä½¿ç”¨ any

```typescript
// âŒ é¿å…
function processData(data: any) {
  return data.value // å¤±å»ç±»å‹æ£€æŸ¥
}

// âœ… ä½¿ç”¨ unknown + ç±»å‹å®ˆå«
function processData(data: unknown) {
  if (typeof data === 'object' && data !== null && 'value' in data) {
    return (data as { value: string }).value
  }
  throw new Error('Invalid data')
}

// âœ… ä½¿ç”¨æ³›å‹ä¿æŒç±»å‹ä¿¡æ¯
function processData<T extends { value: string }>(data: T): string {
  return data.value
}
```

### ä½¿ç”¨å­—é¢é‡ç±»å‹

```typescript
// âŒ å¤ªå®½æ³›
function setStatus(status: string) {}

// âœ… ç²¾ç¡®çš„å­—é¢é‡ç±»å‹
type Status = 'pending' | 'processing' | 'completed' | 'failed'

function setStatus(status: Status) {}

// âœ… ä½¿ç”¨ const æ–­è¨€
const config = {
  endpoint: '/api',
  method: 'GET',
} as const
// { readonly endpoint: "/api"; readonly method: "GET" }
```

### ç±»å‹æ”¶çª„è€Œéæ–­è¨€

```typescript
// âŒ ç±»å‹æ–­è¨€å¯èƒ½éšè—é”™è¯¯
const value = data as string

// âœ… ä½¿ç”¨ç±»å‹å®ˆå«
function isString(value: unknown): value is string {
  return typeof value === 'string'
}

if (isString(data)) {
  console.log(data.toUpperCase())
}

// âœ… ä½¿ç”¨å¯è¾¨è¯†è”åˆ
type Result = { success: true; data: string } | { success: false; error: Error }

function handleResult(result: Result) {
  if (result.success) {
    console.log(result.data)
  } else {
    console.error(result.error)
  }
}
```

## å‡½æ•°è®¾è®¡

### è¿”å›ç±»å‹æ³¨è§£

```typescript
// âŒ ä¾èµ–æ¨æ–­å¯èƒ½å¯¼è‡´æ„å¤–
function getUser(id: number) {
  // è¿”å›ç±»å‹å¯èƒ½éšå®ç°å˜åŒ–
  return fetch(`/api/users/${id}`).then((r) => r.json())
}

// âœ… æ˜¾å¼å£°æ˜è¿”å›ç±»å‹
interface User {
  id: number
  name: string
}

async function getUser(id: number): Promise<User> {
  const response = await fetch(`/api/users/${id}`)
  return response.json()
}
```

### å‡½æ•°é‡è½½è¦ç®€æ´

```typescript
// âŒ è¿‡å¤šé‡è½½éš¾ä»¥ç»´æŠ¤
function process(value: string): string
function process(value: number): number
function process(value: boolean): boolean
function process(value: string | number | boolean) {
  return value
}

// âœ… ä½¿ç”¨æ³›å‹ç®€åŒ–
function process<T extends string | number | boolean>(value: T): T {
  return value
}

// âœ… å¿…è¦æ—¶ä½¿ç”¨é‡è½½
function createElement(tag: 'div'): HTMLDivElement
function createElement(tag: 'span'): HTMLSpanElement
function createElement(tag: string): HTMLElement {
  return document.createElement(tag)
}
```

### å‚æ•°å¯¹è±¡æ¨¡å¼

```typescript
// âŒ å‚æ•°è¿‡å¤š
function createUser(
  name: string,
  email: string,
  age: number,
  role: string,
  active: boolean
) {}

// âœ… ä½¿ç”¨å‚æ•°å¯¹è±¡
interface CreateUserOptions {
  name: string
  email: string
  age?: number
  role?: string
  active?: boolean
}

function createUser(options: CreateUserOptions) {
  const { name, email, age = 0, role = 'user', active = true } = options
}

// è°ƒç”¨æ›´æ¸…æ™°
createUser({
  name: 'å¼ ä¸‰',
  email: 'test@test.com',
  role: 'admin',
})
```

## ç±»å‹å¯¼å‡º

### ç»Ÿä¸€å¯¼å‡ºç±»å‹

```typescript
// types/index.ts
export type { User, UserRole, CreateUserInput } from './user'
export type { Product, ProductCategory } from './product'
export type { Order, OrderStatus } from './order'

// ä½¿ç”¨
import type { User, Product, Order } from '@/types'
```

### ç±»å‹ä¸å®ç°åˆ†ç¦»

```typescript
// types/api.ts
export interface ApiResponse<T> {
  code: number
  message: string
  data: T
}

export interface PaginatedResponse<T> extends ApiResponse<T[]> {
  total: number
  page: number
  pageSize: number
}

// services/api.ts
import type { ApiResponse, PaginatedResponse } from '@/types/api'

export async function fetchUser(id: number): Promise<ApiResponse<User>> {
  // å®ç°
}
```

## å¸¸è§é™·é˜±

### å¯¹è±¡å­—é¢é‡å¤šä½™å±æ€§

```typescript
interface User {
  name: string
  email: string
}

// âœ… ç›´æ¥èµ‹å€¼ä¼šæ£€æŸ¥å¤šä½™å±æ€§
const user: User = {
  name: 'å¼ ä¸‰',
  email: 'test@test.com',
  // age: 25  // âŒ é”™è¯¯ï¼šå¤šä½™å±æ€§
}

// ğŸ”¶ é€šè¿‡å˜é‡èµ‹å€¼ä¸æ£€æŸ¥
const data = { name: 'å¼ ä¸‰', email: 'test@test.com', age: 25 }
const user2: User = data // âœ… ä¸æŠ¥é”™ï¼Œä½†ä¸¢å¤±äº† age ç±»å‹ä¿¡æ¯

// âœ… ä½¿ç”¨ç²¾ç¡®ç±»å‹
type ExactUser = {
  [K in keyof User]: User[K]
} & { [K: string]: never }
```

### å¯é€‰å±æ€§ä¸ undefined

```typescript
interface Config {
  timeout?: number
}

// ğŸ”¶ å¯é€‰å±æ€§å¯èƒ½æ˜¯ undefined
function getTimeout(config: Config) {
  // config.timeout ç±»å‹æ˜¯ number | undefined
  return config.timeout.toFixed(2) // âŒ å¯èƒ½æŠ¥é”™
}

// âœ… æ­£ç¡®å¤„ç†
function getTimeout(config: Config) {
  return config.timeout?.toFixed(2) ?? '0.00'
}

// âœ… ä½¿ç”¨ exactOptionalPropertyTypes
// tsconfig.json: "exactOptionalPropertyTypes": true
// åŒºåˆ† undefined å’Œç¼ºå¤±
```

### ç±»å‹æ¨æ–­é™·é˜±

```typescript
// ğŸ”¶ æ•°ç»„å…ƒç´ ç±»å‹è¿‡å®½
const arr = [1, 2, 3] // number[]
arr.push('string') // âŒ æœŸæœ›æŠ¥é”™ï¼Œå®é™…å¯èƒ½ä¸æŠ¥

// âœ… ä½¿ç”¨ as const
const arr = [1, 2, 3] as const // readonly [1, 2, 3]

// ğŸ”¶ å¯¹è±¡å±æ€§æ¨æ–­
const config = {
  mode: 'development', // stringï¼Œä¸æ˜¯ 'development'
}

// âœ… ä½¿ç”¨ as const æˆ–ç±»å‹æ³¨è§£
const config = {
  mode: 'development' as const,
}

// æˆ–
const config: { mode: 'development' | 'production' } = {
  mode: 'development',
}
```

### this ç±»å‹é—®é¢˜

```typescript
class Counter {
  count = 0

  // âŒ this å¯èƒ½ä¸¢å¤±
  increment() {
    this.count++
  }
}

const counter = new Counter()
const fn = counter.increment
fn() // âŒ this æ˜¯ undefined

// âœ… ä½¿ç”¨ç®­å¤´å‡½æ•°
class Counter {
  count = 0

  increment = () => {
    this.count++
  }
}

// âœ… æˆ–å£°æ˜ this ç±»å‹
class Counter {
  count = 0

  increment(this: Counter) {
    this.count++
  }
}
```

## æ€§èƒ½ä¼˜åŒ–

### é¿å…è¿‡åº¦ä½¿ç”¨æ³›å‹

```typescript
// âŒ ä¸å¿…è¦çš„æ³›å‹
function getValue<T extends string>(key: T): string {
  return localStorage.getItem(key) ?? ''
}

// âœ… ç®€åŒ–
function getValue(key: string): string {
  return localStorage.getItem(key) ?? ''
}

// âœ… æ³›å‹ç”¨åœ¨çœŸæ­£éœ€è¦çš„åœ°æ–¹
function identity<T>(value: T): T {
  return value
}
```

### å‡å°‘ç±»å‹è®¡ç®—

```typescript
// âŒ å¤æ‚çš„ç±»å‹è®¡ç®—å½±å“ç¼–è¯‘é€Ÿåº¦
type DeepReadonly<T> = {
  readonly [K in keyof T]: T[K] extends object ? DeepReadonly<T[K]> : T[K]
}

// âœ… æŒ‰éœ€ä½¿ç”¨ï¼Œæˆ–ç¼“å­˜ç±»å‹
type CachedDeepReadonly = DeepReadonly<MyComplexType>

// âœ… ç®€åŒ–å¤æ‚ç±»å‹
type SimpleReadonly<T> = {
  readonly [K in keyof T]: T[K]
}
```

### ä½¿ç”¨ skipLibCheck

```typescript
// tsconfig.json
{
  "compilerOptions": {
    // è·³è¿‡ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹æ£€æŸ¥ï¼ŒåŠ å¿«ç¼–è¯‘
    "skipLibCheck": true
  }
}
```

## ä»£ç ç»„ç»‡

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ types/           # å…¨å±€ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ api.ts
â”‚   â””â”€â”€ models.ts
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ helpers.ts
â”œâ”€â”€ services/        # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ api.ts
â”œâ”€â”€ components/      # ç»„ä»¶
â”‚   â””â”€â”€ index.ts
â””â”€â”€ index.ts         # å…¥å£
```

### ç±»å‹ç»„ç»‡

```typescript
// types/user.ts
export interface User {
  id: number
  name: string
  email: string
}

export type UserRole = 'admin' | 'user' | 'guest'

export interface CreateUserInput {
  name: string
  email: string
  role?: UserRole
}

export interface UpdateUserInput extends Partial<CreateUserInput> {
  id: number
}

// types/index.ts
export * from './user'
export * from './product'
export * from './order'
```

## å·¥å…·æ¨è

### ESLint è§„åˆ™

```json
{
  "rules": {
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/explicit-function-return-type": "warn",
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/prefer-nullish-coalescing": "warn",
    "@typescript-eslint/prefer-optional-chain": "warn",
    "@typescript-eslint/strict-boolean-expressions": "warn"
  }
}
```

### æ¨èçš„ tsconfig é€‰é¡¹

```json
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitOverride": true,
    "exactOptionalPropertyTypes": true,
    "noPropertyAccessFromIndexSignature": true,
    "forceConsistentCasingInFileNames": true
  }
}
```

## æ€»ç»“

### ç±»å‹è®¾è®¡æ¸…å•

- âœ… ä¼˜å…ˆä½¿ç”¨ interface å®šä¹‰å¯¹è±¡ç±»å‹
- âœ… é¿å…ä½¿ç”¨ anyï¼Œä½¿ç”¨ unknown + ç±»å‹å®ˆå«
- âœ… ä½¿ç”¨å­—é¢é‡ç±»å‹ä»£æ›¿å®½æ³›çš„åŸå§‹ç±»å‹
- âœ… ä¼˜å…ˆä½¿ç”¨ç±»å‹æ”¶çª„è€Œéç±»å‹æ–­è¨€
- âœ… ä¸ºå…¬å…± API æ˜¾å¼å£°æ˜è¿”å›ç±»å‹
- âœ… ä½¿ç”¨å‚æ•°å¯¹è±¡ä»£æ›¿å¤šä¸ªå‚æ•°
- âœ… ç»Ÿä¸€å¯¼å‡ºå’Œç»„ç»‡ç±»å‹

### é¿å…çš„æ¨¡å¼

- âŒ æ»¥ç”¨ any ç±»å‹
- âŒ è¿‡åº¦ä½¿ç”¨ç±»å‹æ–­è¨€
- âŒ å¿½ç•¥ null/undefined æ£€æŸ¥
- âŒ è¿‡äºå¤æ‚çš„æ³›å‹
- âŒ ä¸å¿…è¦çš„ç±»å‹é‡å¤

TypeScript æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œåˆç†ä½¿ç”¨å¯ä»¥æ˜¾è‘—æé«˜ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚å¸Œæœ›è¿™ä¸ªç³»åˆ—æ•™ç¨‹èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°æŒæ¡ TypeScriptï¼
