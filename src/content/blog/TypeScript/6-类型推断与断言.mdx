---
title: 'ç±»å‹æ¨æ–­ä¸æ–­è¨€'
description: 'TypeScript ç±»å‹æ¨æ–­æœºåˆ¶è¯¦è§£ï¼šè‡ªåŠ¨ç±»å‹æ¨æ–­ã€as ç±»å‹æ–­è¨€ã€éç©ºæ–­è¨€ã€const æ–­è¨€çš„ä½¿ç”¨æ–¹æ³•ä¸æœ€ä½³å®è·µ'
pubDate: 2024-01-20
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'ç±»å‹æ¨æ–­', 'ç±»å‹æ–­è¨€', 'as', 'constæ–­è¨€']
---

TypeScript çš„ç±»å‹ç³»ç»Ÿæ—¢å¼ºå¤§åˆçµæ´»ã€‚å®ƒèƒ½è‡ªåŠ¨æ¨æ–­å¤§éƒ¨åˆ†ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä½ åœ¨å¿…è¦æ—¶æ‰‹åŠ¨æŒ‡å®šç±»å‹ã€‚ç†è§£ç±»å‹æ¨æ–­å’Œç±»å‹æ–­è¨€æ˜¯å†™å‡ºä¼˜é›… TypeScript ä»£ç çš„å…³é”®ã€‚

## ç±»å‹æ¨æ–­

### åŸºç¡€æ¨æ–­

TypeScript ä¼šæ ¹æ®åˆå§‹åŒ–å€¼è‡ªåŠ¨æ¨æ–­å˜é‡ç±»å‹ï¼š

```typescript
// TypeScript 5.x

// åŸå§‹ç±»å‹æ¨æ–­
let name = 'å¼ ä¸‰' // string
let age = 25 // number
let isActive = true // boolean

// æ•°ç»„æ¨æ–­
let numbers = [1, 2, 3] // number[]
let strings = ['a', 'b', 'c'] // string[]
let mixed = [1, 'hello'] // (string | number)[]

// å¯¹è±¡æ¨æ–­
let user = {
  name: 'å¼ ä¸‰',
  age: 25,
} // { name: string; age: number }
```

### æœ€ä½³é€šç”¨ç±»å‹

å½“æ¨æ–­å¤šä¸ªè¡¨è¾¾å¼çš„ç±»å‹æ—¶ï¼ŒTypeScript ä¼šè®¡ç®—"æœ€ä½³é€šç”¨ç±»å‹"ï¼š

```typescript
// æ¨æ–­ä¸º (number | string)[]
let arr = [1, 'hello', 2, 'world']

// æ¨æ–­ä¸º Animal[]ï¼ˆå‡è®¾ Dog å’Œ Cat éƒ½ç»§æ‰¿è‡ª Animalï¼‰
class Animal {}
class Dog extends Animal {}
class Cat extends Animal {}

let pets = [new Dog(), new Cat()] // (Dog | Cat)[]

// å¦‚æœæƒ³æ¨æ–­ä¸ºçˆ¶ç±»æ•°ç»„ï¼Œéœ€è¦æ˜¾å¼æ ‡æ³¨
let animals: Animal[] = [new Dog(), new Cat()]
```

### ä¸Šä¸‹æ–‡ç±»å‹æ¨æ–­

TypeScript æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹ï¼ˆä»å¤–å‘å†…æ¨æ–­ï¼‰ï¼š

```typescript
// æ ¹æ®å›è°ƒå‡½æ•°çš„ä¸Šä¸‹æ–‡æ¨æ–­å‚æ•°ç±»å‹
const numbers = [1, 2, 3]

// num è‡ªåŠ¨æ¨æ–­ä¸º number
numbers.forEach((num) => {
  console.log(num.toFixed(2))
})

// æ ¹æ®èµ‹å€¼ç›®æ ‡æ¨æ–­
const handler: (event: MouseEvent) => void = (e) => {
  // e è‡ªåŠ¨æ¨æ–­ä¸º MouseEvent
  console.log(e.clientX, e.clientY)
}

// æ ¹æ®è¿”å›ç±»å‹æ¨æ–­
function createArray<T>(length: number, value: T): T[] {
  return Array(length).fill(value)
}

// è¿”å›å€¼æ¨æ–­ä¸º string[]
const arr = createArray(3, 'hello')
```

### let vs const æ¨æ–­

```typescript
// let æ¨æ–­ä¸ºå®½æ³›ç±»å‹
let x = 'hello' // string
let y = 10 // number

// const æ¨æ–­ä¸ºå­—é¢é‡ç±»å‹
const a = 'hello' // "hello"ï¼ˆå­—é¢é‡ç±»å‹ï¼‰
const b = 10 // 10ï¼ˆå­—é¢é‡ç±»å‹ï¼‰

// å¯¹è±¡å’Œæ•°ç»„ä¸åŒ
const obj = { name: 'å¼ ä¸‰' } // { name: string }ï¼ˆå±æ€§ä»æ˜¯å®½æ³›ç±»å‹ï¼‰
const arr = [1, 2, 3] // number[]ï¼ˆå…ƒç´ ä»æ˜¯å®½æ³›ç±»å‹ï¼‰
```

## ç±»å‹æ–­è¨€

å½“ä½ æ¯” TypeScript æ›´äº†è§£æŸä¸ªå€¼çš„ç±»å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€ã€‚

### as è¯­æ³•ï¼ˆæ¨èï¼‰

```typescript
// DOM å…ƒç´ æ–­è¨€
const input = document.getElementById('myInput') as HTMLInputElement
input.value = 'Hello'

// æ›´é€šç”¨çš„å…ƒç´ 
const element = document.querySelector('.container') as HTMLDivElement

// API å“åº”æ–­è¨€
interface User {
  id: number
  name: string
}

const response = await fetch('/api/user')
const data = (await response.json()) as User
console.log(data.name)
```

### å°–æ‹¬å·è¯­æ³•

```typescript
// å°–æ‹¬å·è¯­æ³•ï¼ˆä¸èƒ½åœ¨ JSX ä¸­ä½¿ç”¨ï¼‰
const input = <HTMLInputElement>document.getElementById('myInput')

// åœ¨ .tsx æ–‡ä»¶ä¸­åªèƒ½ç”¨ as è¯­æ³•
// const input = document.getElementById('myInput') as HTMLInputElement;
```

### æ–­è¨€çš„é™åˆ¶

ç±»å‹æ–­è¨€ä¸æ˜¯ç±»å‹è½¬æ¢ï¼Œéœ€è¦ä¸¤ä¸ªç±»å‹"å…¼å®¹"ï¼š

```typescript
// âŒ ä¸èƒ½ç›´æ¥å°† string æ–­è¨€ä¸º number
// const x = 'hello' as number;  // é”™è¯¯

// âœ… å¯ä»¥é€šè¿‡ unknown æˆ– any ä¸­è½¬ï¼ˆåŒé‡æ–­è¨€ï¼‰
const x = 'hello' as unknown as number // ç¼–è¯‘é€šè¿‡ï¼Œä½†è¿è¡Œæ—¶ä»æ˜¯å­—ç¬¦ä¸²

// ğŸ”¶ åŒé‡æ–­è¨€å¾ˆå±é™©ï¼Œå°½é‡é¿å…
console.log(typeof x) // "string"ï¼Œä¸æ˜¯ "number"
```

### æ–­è¨€ vs ç±»å‹æ³¨è§£

```typescript
// ç±»å‹æ³¨è§£ï¼šå£°æ˜å˜é‡æ—¶æŒ‡å®šç±»å‹
const user: User = { id: 1, name: 'å¼ ä¸‰' }

// ç±»å‹æ–­è¨€ï¼šå‘Šè¯‰ç¼–è¯‘å™¨"ç›¸ä¿¡æˆ‘"
const user2 = { id: 1, name: 'å¼ ä¸‰' } as User

// åŒºåˆ«ï¼šæ³¨è§£ä¼šæ£€æŸ¥å€¼æ˜¯å¦ç¬¦åˆç±»å‹ï¼Œæ–­è¨€ä¸ä¼š
interface User {
  id: number
  name: string
  email: string // å¿…éœ€å±æ€§
}

// âŒ ç±»å‹æ³¨è§£ä¼šæŠ¥é”™ï¼šç¼ºå°‘ email
// const user: User = { id: 1, name: 'å¼ ä¸‰' };

// âš ï¸ ç±»å‹æ–­è¨€ä¸ä¼šæŠ¥é”™ï¼ˆå±é™©ï¼ï¼‰
const user2 = { id: 1, name: 'å¼ ä¸‰' } as User // ç¼–è¯‘é€šè¿‡
```

## éç©ºæ–­è¨€

ä½¿ç”¨ `!` å‘Šè¯‰ TypeScript æŸä¸ªå€¼ä¸æ˜¯ `null` æˆ– `undefined`ï¼š

```typescript
// DOM å…ƒç´ å¯èƒ½ä¸å­˜åœ¨
const element = document.getElementById('myElement')
// element çš„ç±»å‹æ˜¯ HTMLElement | null

// ä½¿ç”¨éç©ºæ–­è¨€
const element2 = document.getElementById('myElement')!
// element2 çš„ç±»å‹æ˜¯ HTMLElement

// ç­‰ä»·äº
const element3 = document.getElementById('myElement') as HTMLElement
```

### éç©ºæ–­è¨€çš„åœºæ™¯

```typescript
// åœºæ™¯1ï¼šç¡®å®š DOM å…ƒç´ å­˜åœ¨
function setupApp() {
  const root = document.getElementById('root')!
  root.innerHTML = '<h1>Hello</h1>'
}

// åœºæ™¯2ï¼šåˆå§‹åŒ–åä¸€å®šæœ‰å€¼çš„å±æ€§
class Component {
  private element!: HTMLElement // å»¶è¿Ÿåˆå§‹åŒ–

  constructor() {
    this.init()
  }

  private init() {
    this.element = document.createElement('div')
  }

  render() {
    this.element.textContent = 'Hello'
  }
}

// åœºæ™¯3ï¼šMap çš„ get æ–¹æ³•
const map = new Map<string, number>()
map.set('key', 42)

const value = map.get('key')! // ç¡®å®š key å­˜åœ¨
```

ğŸ”¶ è­¦å‘Šï¼šéç©ºæ–­è¨€ä¼šç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œå¦‚æœåˆ¤æ–­é”™è¯¯ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼š

```typescript
const element = document.getElementById('nonexistent')!
element.innerHTML = 'Hello' // è¿è¡Œæ—¶é”™è¯¯ï¼šCannot set property 'innerHTML' of null
```

## const æ–­è¨€

`as const` å°†å€¼è½¬æ¢ä¸ºæœ€å…·ä½“çš„å­—é¢é‡ç±»å‹ï¼š

### åŸºæœ¬ç”¨æ³•

```typescript
// æ™®é€šå£°æ˜
let x = 'hello' // string
const y = 'hello' // "hello"

// as const è®© let ä¹Ÿå…·æœ‰å­—é¢é‡ç±»å‹
let z = 'hello' as const // "hello"

// æ•°å­—
let num = 42 as const // 42ï¼ˆä¸æ˜¯ numberï¼‰
```

### å¯¹è±¡çš„ as const

```typescript
// æ™®é€šå¯¹è±¡
const user = {
  name: 'å¼ ä¸‰',
  age: 25,
}
// ç±»å‹ï¼š{ name: string; age: number }

// as const å¯¹è±¡
const userConst = {
  name: 'å¼ ä¸‰',
  age: 25,
} as const
// ç±»å‹ï¼š{ readonly name: "å¼ ä¸‰"; readonly age: 25 }

// userConst.name = 'æå››';  // âŒ é”™è¯¯ï¼šåªè¯»å±æ€§
```

### æ•°ç»„çš„ as const

```typescript
// æ™®é€šæ•°ç»„
const colors = ['red', 'green', 'blue']
// ç±»å‹ï¼šstring[]

// as const æ•°ç»„ -> åªè¯»å…ƒç»„
const colorsConst = ['red', 'green', 'blue'] as const
// ç±»å‹ï¼šreadonly ["red", "green", "blue"]

// colorsConst.push('yellow');  // âŒ é”™è¯¯
// colorsConst[0] = 'pink';     // âŒ é”™è¯¯
```

### å®é™…åº”ç”¨

```typescript
// åº”ç”¨1ï¼šä»æ•°ç»„åˆ›å»ºè”åˆç±»å‹
const METHODS = ['GET', 'POST', 'PUT', 'DELETE'] as const
type Method = (typeof METHODS)[number] // "GET" | "POST" | "PUT" | "DELETE"

// åº”ç”¨2ï¼šæšä¸¾æ›¿ä»£æ–¹æ¡ˆ
const STATUS = {
  PENDING: 'pending',
  SUCCESS: 'success',
  ERROR: 'error',
} as const

type Status = (typeof STATUS)[keyof typeof STATUS]
// "pending" | "success" | "error"

// åº”ç”¨3ï¼šé…ç½®å¯¹è±¡
const config = {
  api: 'https://api.example.com',
  timeout: 5000,
  retries: 3,
} as const

// config çš„æ‰€æœ‰å±æ€§éƒ½æ˜¯åªè¯»çš„ï¼Œå€¼éƒ½æ˜¯å­—é¢é‡ç±»å‹
```

## satisfies æ“ä½œç¬¦ï¼ˆTypeScript 4.9+ï¼‰

`satisfies` åœ¨éªŒè¯ç±»å‹çš„åŒæ—¶ä¿ç•™æ¨æ–­çš„æ›´å…·ä½“ç±»å‹ï¼š

```typescript
// é—®é¢˜ï¼šç±»å‹æ³¨è§£ä¼šä¸¢å¤±å…·ä½“ç±»å‹
const palette1: Record<string, string | number[]> = {
  red: '#ff0000',
  green: '#00ff00',
  blue: [0, 0, 255],
}
// palette1.red çš„ç±»å‹æ˜¯ string | number[]ï¼Œä¸æ˜¯ string

// è§£å†³ï¼šä½¿ç”¨ satisfies
const palette2 = {
  red: '#ff0000',
  green: '#00ff00',
  blue: [0, 0, 255],
} satisfies Record<string, string | number[]>

// palette2.red çš„ç±»å‹æ˜¯ string
// palette2.blue çš„ç±»å‹æ˜¯ number[]

palette2.red.toUpperCase() // âœ… æ­£ç¡®
palette2.blue.map((x) => x * 2) // âœ… æ­£ç¡®
```

### satisfies vs as

```typescript
// asï¼šå¯èƒ½ä¸¢å¤±ç±»å‹ä¿¡æ¯ï¼Œä¸”ä¸éªŒè¯
const x = { name: 'å¼ ä¸‰' } as { name: string; age: number }
// ä¸ä¼šæŠ¥é”™ï¼Œå³ä½¿ç¼ºå°‘ age

// satisfiesï¼šéªŒè¯ç±»å‹ï¼Œä¿ç•™æ¨æ–­
const y = { name: 'å¼ ä¸‰' } satisfies { name: string; age: number }
// âŒ é”™è¯¯ï¼šç¼ºå°‘å±æ€§ age
```

## ç±»å‹æ”¶çª„

TypeScript é€šè¿‡æ§åˆ¶æµåˆ†æè‡ªåŠ¨æ”¶çª„ç±»å‹ï¼š

```typescript
function process(value: string | number) {
  // è¿™é‡Œ value æ˜¯ string | number

  if (typeof value === 'string') {
    // è¿™é‡Œ value è¢«æ”¶çª„ä¸º string
    console.log(value.toUpperCase())
  } else {
    // è¿™é‡Œ value è¢«æ”¶çª„ä¸º number
    console.log(value.toFixed(2))
  }
}

// ä½¿ç”¨ in æ“ä½œç¬¦
interface Dog {
  bark(): void
}
interface Cat {
  meow(): void
}

function speak(animal: Dog | Cat) {
  if ('bark' in animal) {
    animal.bark() // Dog
  } else {
    animal.meow() // Cat
  }
}
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ ä»€ä¹ˆæ—¶å€™éœ€è¦ç±»å‹æ–­è¨€ï¼Ÿ

ä¸»è¦åœºæ™¯ï¼š

1. DOM æ“ä½œæ—¶æŒ‡å®šå…·ä½“å…ƒç´ ç±»å‹
2. å¤„ç† API å“åº”æ•°æ®
3. ç¬¬ä¸‰æ–¹åº“ç±»å‹ä¸å‡†ç¡®æ—¶

```typescript
// DOM æ“ä½œ
const canvas = document.getElementById('canvas') as HTMLCanvasElement
const ctx = canvas.getContext('2d')!

// API å“åº”
interface ApiResponse<T> {
  data: T
  status: number
}
const res = (await fetch('/api/data').then((r) =>
  r.json()
)) as ApiResponse<User>
```

### ğŸ™‹ éç©ºæ–­è¨€å’Œå¯é€‰é“¾æ€ä¹ˆé€‰ï¼Ÿ

```typescript
// å¯é€‰é“¾ï¼šå®‰å…¨è®¿é—®ï¼Œå¯èƒ½è¿”å› undefined
const value = obj?.prop?.nested // T | undefined

// éç©ºæ–­è¨€ï¼šæ–­è¨€ä¸ä¸ºç©ºï¼Œå¯èƒ½è¿è¡Œæ—¶é”™è¯¯
const value2 = obj!.prop!.nested // T

// å»ºè®®ï¼šä¼˜å…ˆä½¿ç”¨å¯é€‰é“¾ï¼Œé™¤éç¡®å®šå€¼å­˜åœ¨
```

### ğŸ™‹ as const å’Œ Object.freeze æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```typescript
// as constï¼šåªå½±å“ç±»å‹ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥
const x = { a: 1 } as const
// è¿è¡Œæ—¶ä»å¯ä¿®æ”¹ï¼ˆè™½ç„¶ TypeScript æŠ¥é”™ï¼‰

// Object.freezeï¼šè¿è¡Œæ—¶å†»ç»“å¯¹è±¡
const y = Object.freeze({ a: 1 })
// è¿è¡Œæ—¶çœŸçš„ä¸èƒ½ä¿®æ”¹

// æœ€å®‰å…¨ï¼šä¸¤è€…ç»“åˆ
const z = Object.freeze({ a: 1 }) as const
```

## æ€»ç»“

| ç‰¹æ€§       | è¯­æ³•                   | ç”¨é€”                    |
| ---------- | ---------------------- | ----------------------- |
| ç±»å‹æ¨æ–­   | è‡ªåŠ¨                   | å‡å°‘ç±»å‹æ³¨è§£            |
| ç±»å‹æ–­è¨€   | `value as Type`        | æ‰‹åŠ¨æŒ‡å®šç±»å‹            |
| éç©ºæ–­è¨€   | `value!`               | æ–­è¨€ä¸ä¸º null/undefined |
| const æ–­è¨€ | `value as const`       | è½¬ä¸ºå­—é¢é‡ç±»å‹          |
| satisfies  | `value satisfies Type` | éªŒè¯ç±»å‹åŒæ—¶ä¿ç•™æ¨æ–­    |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ è”åˆç±»å‹ä¸äº¤å‰ç±»å‹ï¼Œäº†è§£å¦‚ä½•ç»„åˆå¤šç§ç±»å‹ã€‚
