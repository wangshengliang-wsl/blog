---
title: 'ç±»çš„ç»§æ‰¿'
description: 'TypeScript ç±»ç»§æ‰¿è¯¦è§£ï¼šextends ç»§æ‰¿ã€super è°ƒç”¨ã€æ–¹æ³•é‡å†™ã€æŠ½è±¡ç±»çš„ä½¿ç”¨æ–¹æ³•'
pubDate: 2024-01-28
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'ç»§æ‰¿', 'extends', 'super', 'æŠ½è±¡ç±»']
---

ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚TypeScript æä¾›äº†å®Œæ•´çš„ç±»ç»§æ‰¿æ”¯æŒï¼ŒåŒ…æ‹¬æ–¹æ³•é‡å†™ã€super è°ƒç”¨å’ŒæŠ½è±¡ç±»ã€‚

## åŸºæœ¬ç»§æ‰¿

ä½¿ç”¨ `extends` å…³é”®å­—å®ç°ç»§æ‰¿ï¼š

```typescript
// TypeScript 5.x

// åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰
class Animal {
  name: string

  constructor(name: string) {
    this.name = name
  }

  move(distance: number = 0): void {
    console.log(`${this.name} ç§»åŠ¨äº† ${distance} ç±³`)
  }
}

// æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰
class Dog extends Animal {
  breed: string

  constructor(name: string, breed: string) {
    super(name) // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
    this.breed = breed
  }

  bark(): void {
    console.log('æ±ªæ±ªï¼')
  }
}

const dog = new Dog('æ—ºè´¢', 'æŸ´çŠ¬')
dog.move(10) // æ—ºè´¢ ç§»åŠ¨äº† 10 ç±³
dog.bark() // æ±ªæ±ªï¼
console.log(dog.name, dog.breed) // æ—ºè´¢ æŸ´çŠ¬
```

## super å…³é”®å­—

### è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°

å­ç±»æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨ `super()`ï¼š

```typescript
class Parent {
  value: number

  constructor(value: number) {
    this.value = value
  }
}

class Child extends Parent {
  extra: string

  constructor(value: number, extra: string) {
    // å¿…é¡»åœ¨è®¿é—® this ä¹‹å‰è°ƒç”¨ super
    super(value)
    this.extra = extra
  }
}

// å¦‚æœå­ç±»æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ super
class SimpleChild extends Parent {
  // è‡ªåŠ¨ç”Ÿæˆ constructor(...args) { super(...args) }
}
```

### è°ƒç”¨çˆ¶ç±»æ–¹æ³•

```typescript
class Animal {
  name: string

  constructor(name: string) {
    this.name = name
  }

  speak(): void {
    console.log(`${this.name} å‘å‡ºå£°éŸ³`)
  }
}

class Cat extends Animal {
  speak(): void {
    super.speak() // è°ƒç”¨çˆ¶ç±»æ–¹æ³•
    console.log('å–µå–µï¼')
  }
}

const cat = new Cat('å’ªå’ª')
cat.speak()
// å’ªå’ª å‘å‡ºå£°éŸ³
// å–µå–µï¼
```

## æ–¹æ³•é‡å†™

å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼š

```typescript
class Shape {
  color: string

  constructor(color: string) {
    this.color = color
  }

  getArea(): number {
    return 0
  }

  describe(): string {
    return `ä¸€ä¸ª ${this.color} çš„å›¾å½¢`
  }
}

class Circle extends Shape {
  radius: number

  constructor(color: string, radius: number) {
    super(color)
    this.radius = radius
  }

  // é‡å†™ getArea
  getArea(): number {
    return Math.PI * this.radius ** 2
  }

  // é‡å†™ describe
  describe(): string {
    return `ä¸€ä¸ª ${this.color} çš„åœ†ï¼ŒåŠå¾„ ${this.radius}`
  }
}

class Rectangle extends Shape {
  width: number
  height: number

  constructor(color: string, width: number, height: number) {
    super(color)
    this.width = width
    this.height = height
  }

  getArea(): number {
    return this.width * this.height
  }

  describe(): string {
    return `ä¸€ä¸ª ${this.color} çš„çŸ©å½¢ï¼Œ${this.width}x${this.height}`
  }
}
```

### override ä¿®é¥°ç¬¦

TypeScript 4.3+ æä¾› `override` å…³é”®å­—ï¼Œç¡®ä¿æ–¹æ³•ç¡®å®é‡å†™äº†çˆ¶ç±»æ–¹æ³•ï¼š

```typescript
class Base {
  greet(): void {
    console.log('Hello')
  }
}

class Derived extends Base {
  override greet(): void {
    console.log('Hi')
  }

  // âŒ é”™è¯¯ï¼šçˆ¶ç±»æ²¡æœ‰è¿™ä¸ªæ–¹æ³•
  // override nonexistent(): void { }
}

// åœ¨ tsconfig.json ä¸­å¯ç”¨ä¸¥æ ¼æ£€æŸ¥
// "noImplicitOverride": true
```

## æŠ½è±¡ç±»

æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½è¢«ç»§æ‰¿ï¼š

```typescript
abstract class Vehicle {
  abstract brand: string

  // æŠ½è±¡æ–¹æ³•ï¼šæ²¡æœ‰å®ç°
  abstract start(): void
  abstract stop(): void

  // æ™®é€šæ–¹æ³•ï¼šæœ‰å®ç°
  honk(): void {
    console.log('Beep!')
  }
}

class Car extends Vehicle {
  brand = 'Toyota'

  start(): void {
    console.log(`${this.brand} å¯åŠ¨`)
  }

  stop(): void {
    console.log(`${this.brand} åœæ­¢`)
  }
}

// const vehicle = new Vehicle();  // âŒ é”™è¯¯ï¼šä¸èƒ½å®ä¾‹åŒ–æŠ½è±¡ç±»
const car = new Car()
car.start() // Toyota å¯åŠ¨
car.honk() // Beep!
```

### æŠ½è±¡å±æ€§å’Œæ–¹æ³•

```typescript
abstract class DataSource {
  // æŠ½è±¡å±æ€§
  abstract name: string
  abstract readonly type: string

  // æŠ½è±¡æ–¹æ³•
  abstract connect(): Promise<void>
  abstract disconnect(): Promise<void>
  abstract query(sql: string): Promise<unknown[]>

  // æŠ½è±¡ getter
  abstract get isConnected(): boolean

  // æ™®é€šæ–¹æ³•
  log(message: string): void {
    console.log(`[${this.name}] ${message}`)
  }
}

class MySQLDataSource extends DataSource {
  name = 'MySQL'
  readonly type = 'relational'
  private connected = false

  get isConnected(): boolean {
    return this.connected
  }

  async connect(): Promise<void> {
    this.connected = true
    this.log('Connected')
  }

  async disconnect(): Promise<void> {
    this.connected = false
    this.log('Disconnected')
  }

  async query(sql: string): Promise<unknown[]> {
    this.log(`Executing: ${sql}`)
    return []
  }
}
```

## å¤šå±‚ç»§æ‰¿

```typescript
class Animal {
  name: string

  constructor(name: string) {
    this.name = name
  }

  eat(): void {
    console.log(`${this.name} is eating`)
  }
}

class Mammal extends Animal {
  furColor: string

  constructor(name: string, furColor: string) {
    super(name)
    this.furColor = furColor
  }

  nurse(): void {
    console.log(`${this.name} is nursing`)
  }
}

class Dog extends Mammal {
  breed: string

  constructor(name: string, furColor: string, breed: string) {
    super(name, furColor)
    this.breed = breed
  }

  bark(): void {
    console.log('Woof!')
  }
}

const dog = new Dog('Rex', 'brown', 'German Shepherd')
dog.eat() // æ¥è‡ª Animal
dog.nurse() // æ¥è‡ª Mammal
dog.bark() // æ¥è‡ª Dog
```

## ç»§æ‰¿ä¸è®¿é—®ä¿®é¥°ç¬¦

```typescript
class Parent {
  public publicProp = 'public'
  protected protectedProp = 'protected'
  private privateProp = 'private'

  protected protectedMethod(): void {
    console.log('Protected method')
  }

  private privateMethod(): void {
    console.log('Private method')
  }
}

class Child extends Parent {
  accessProps(): void {
    console.log(this.publicProp) // âœ…
    console.log(this.protectedProp) // âœ…
    // console.log(this.privateProp);  // âŒ ä¸èƒ½è®¿é—®

    this.protectedMethod() // âœ…
    // this.privateMethod();  // âŒ ä¸èƒ½è®¿é—®
  }

  // å¯ä»¥æ”¹å˜ protected ä¸º public
  public protectedMethod(): void {
    super.protectedMethod()
    console.log('Extended protected method')
  }
}
```

## é™æ€æˆå‘˜ç»§æ‰¿

```typescript
class Base {
  static count = 0
  static increment(): void {
    Base.count++
  }
}

class Derived extends Base {
  static additionalMethod(): void {
    console.log(`Count: ${Derived.count}`) // ç»§æ‰¿é™æ€å±æ€§
    Derived.increment() // ç»§æ‰¿é™æ€æ–¹æ³•
  }
}

Derived.increment()
console.log(Derived.count) // 1
```

## å®é™…åº”ç”¨æ¨¡å¼

### æ¨¡æ¿æ–¹æ³•æ¨¡å¼

```typescript
abstract class DataProcessor {
  // æ¨¡æ¿æ–¹æ³•
  process(): void {
    this.validate()
    this.transform()
    this.save()
    this.notify()
  }

  // æŠ½è±¡æ­¥éª¤ï¼šå­ç±»å¿…é¡»å®ç°
  protected abstract validate(): void
  protected abstract transform(): void
  protected abstract save(): void

  // å¯é€‰æ­¥éª¤ï¼šæœ‰é»˜è®¤å®ç°
  protected notify(): void {
    console.log('Processing complete')
  }
}

class UserDataProcessor extends DataProcessor {
  protected validate(): void {
    console.log('Validating user data...')
  }

  protected transform(): void {
    console.log('Transforming user data...')
  }

  protected save(): void {
    console.log('Saving user data...')
  }

  protected notify(): void {
    super.notify()
    console.log('Sending email notification')
  }
}

const processor = new UserDataProcessor()
processor.process()
```

### ç­–ç•¥æ¨¡å¼åŸºç±»

```typescript
abstract class PaymentStrategy {
  abstract name: string
  abstract pay(amount: number): Promise<boolean>

  formatAmount(amount: number): string {
    return `$${amount.toFixed(2)}`
  }
}

class CreditCardPayment extends PaymentStrategy {
  name = 'Credit Card'

  constructor(private cardNumber: string) {
    super()
  }

  async pay(amount: number): Promise<boolean> {
    console.log(`Paying ${this.formatAmount(amount)} with ${this.name}`)
    return true
  }
}

class PayPalPayment extends PaymentStrategy {
  name = 'PayPal'

  constructor(private email: string) {
    super()
  }

  async pay(amount: number): Promise<boolean> {
    console.log(`Paying ${this.formatAmount(amount)} with ${this.name}`)
    return true
  }
}
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ æŠ½è±¡ç±»å’Œæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```typescript
// æ¥å£ï¼šçº¯ç±»å‹çº¦æŸï¼Œæ— å®ç°
interface Flyable {
  fly(): void
}

// æŠ½è±¡ç±»ï¼šå¯ä»¥æœ‰éƒ¨åˆ†å®ç°
abstract class Bird {
  abstract fly(): void // æŠ½è±¡æ–¹æ³•

  eat(): void {
    // å…·ä½“å®ç°
    console.log('Eating')
  }
}

// ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»
class Sparrow extends Bird implements Flyable {
  fly(): void {
    console.log('Flying')
  }
}
```

### ğŸ™‹ å­ç±»æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨ super å—ï¼Ÿ

æ˜¯çš„ï¼Œå¦‚æœå­ç±»æœ‰æ„é€ å‡½æ•°ï¼š

```typescript
class Parent {
  constructor(public value: number) {}
}

class Child extends Parent {
  constructor(
    value: number,
    public extra: string
  ) {
    super(value) // å¿…é¡»è°ƒç”¨
  }
}

// å¦‚æœæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œè‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°
class SimpleChild extends Parent {}
const child = new SimpleChild(42)
```

### ğŸ™‹ å¦‚ä½•é˜²æ­¢ç±»è¢«ç»§æ‰¿ï¼Ÿ

ç›®å‰ TypeScript æ²¡æœ‰ `final` å…³é”®å­—ï¼Œä½†å¯ä»¥ç”¨æŠ€å·§å®ç°ï¼š

```typescript
class Final {
  private constructor() {} // ç§æœ‰æ„é€ å‡½æ•°

  static create(): Final {
    return new Final()
  }
}

// class Extended extends Final {}  // âŒ æ— æ³•ç»§æ‰¿
```

## æ€»ç»“

| ç‰¹æ€§       | è¯­æ³•                | ç”¨é€”             |
| ---------- | ------------------- | ---------------- |
| ç»§æ‰¿       | `class B extends A` | å¤ç”¨çˆ¶ç±»ä»£ç      |
| super æ„é€  | `super(args)`       | è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° |
| super æ–¹æ³• | `super.method()`    | è°ƒç”¨çˆ¶ç±»æ–¹æ³•     |
| æ–¹æ³•é‡å†™   | `override method()` | è¦†ç›–çˆ¶ç±»æ–¹æ³•     |
| æŠ½è±¡ç±»     | `abstract class`    | å®šä¹‰æŠ½è±¡åŸºç±»     |
| æŠ½è±¡æ–¹æ³•   | `abstract method()` | å¼ºåˆ¶å­ç±»å®ç°     |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ ç±»ä¸æ¥å£çš„ç»“åˆä½¿ç”¨ï¼Œæ·±å…¥ç†è§£ implements çš„ç”¨æ³•ã€‚
