---
title: 'å‡½æ•°ç±»å‹'
description: 'TypeScript å‡½æ•°ç±»å‹è¯¦è§£ï¼šå‚æ•°ç±»å‹ã€è¿”å›å€¼ç±»å‹ã€å¯é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å‰©ä½™å‚æ•°ä¸å‡½æ•°é‡è½½'
pubDate: 2024-01-19
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'å‡½æ•°ç±»å‹', 'å‡½æ•°é‡è½½', 'å¯é€‰å‚æ•°', 'å‰©ä½™å‚æ•°']
---

å‡½æ•°æ˜¯ JavaScript çš„æ ¸å¿ƒã€‚TypeScript ä¸ºå‡½æ•°æä¾›äº†å®Œæ•´çš„ç±»å‹æ”¯æŒï¼ŒåŒ…æ‹¬å‚æ•°ç±»å‹ã€è¿”å›å€¼ç±»å‹ã€å¯é€‰å‚æ•°ã€å‡½æ•°é‡è½½ç­‰ç‰¹æ€§ã€‚

## å‡½æ•°ç±»å‹åŸºç¡€

### å‚æ•°å’Œè¿”å›å€¼ç±»å‹

```typescript
// TypeScript 5.x

// å‡½æ•°å£°æ˜
function add(a: number, b: number): number {
  return a + b
}

// ç®­å¤´å‡½æ•°
const multiply = (a: number, b: number): number => {
  return a * b
}

// ç®€å†™ï¼ˆå•è¡¨è¾¾å¼ï¼‰
const divide = (a: number, b: number): number => a / b

// æ— è¿”å›å€¼ä½¿ç”¨ void
function log(message: string): void {
  console.log(message)
}
```

### è¿”å›å€¼ç±»å‹æ¨æ–­

TypeScript å¯ä»¥è‡ªåŠ¨æ¨æ–­è¿”å›å€¼ç±»å‹ï¼š

```typescript
// è‡ªåŠ¨æ¨æ–­è¿”å›å€¼ä¸º number
function add(a: number, b: number) {
  return a + b
}

// è‡ªåŠ¨æ¨æ–­è¿”å›å€¼ä¸º string
function greet(name: string) {
  return `Hello, ${name}!`
}

// ğŸ”¶ å»ºè®®ï¼šå…¬å…± API æ˜¾å¼æ ‡æ³¨è¿”å›å€¼ï¼Œå†…éƒ¨å‡½æ•°å¯ä»¥ä¾èµ–æ¨æ–­
export function calculateTotal(prices: number[]): number {
  return prices.reduce((sum, price) => sum + price, 0)
}
```

## å‡½æ•°ç±»å‹è¡¨è¾¾å¼

å¯ä»¥å•ç‹¬å®šä¹‰å‡½æ•°çš„ç±»å‹ï¼š

```typescript
// å‡½æ•°ç±»å‹è¡¨è¾¾å¼
type AddFunction = (a: number, b: number) => number

const add: AddFunction = (a, b) => a + b

// ä½œä¸ºå‚æ•°ç±»å‹
function calculate(
  fn: (x: number, y: number) => number,
  a: number,
  b: number
): number {
  return fn(a, b)
}

calculate(add, 10, 5) // 15
calculate((x, y) => x - y, 10, 5) // 5
```

### å®Œæ•´çš„å‡½æ•°ç±»å‹

```typescript
// ä½¿ç”¨ type å®šä¹‰
type GreetFunction = (name: string, greeting?: string) => string

// ä½¿ç”¨ interface å®šä¹‰ï¼ˆè°ƒç”¨ç­¾åï¼‰
interface GreetInterface {
  (name: string, greeting?: string): string
}

const greet: GreetFunction = (name, greeting = 'Hello') => {
  return `${greeting}, ${name}!`
}
```

## å¯é€‰å‚æ•°

ä½¿ç”¨ `?` æ ‡è®°å¯é€‰å‚æ•°ï¼š

```typescript
function greet(name: string, title?: string): string {
  if (title) {
    return `${title} ${name}`
  }
  return name
}

greet('å¼ ä¸‰') // "å¼ ä¸‰"
greet('å¼ ä¸‰', 'åšå£«') // "åšå£« å¼ ä¸‰"
```

ğŸ”¶ å¯é€‰å‚æ•°å¿…é¡»æ”¾åœ¨å¿…éœ€å‚æ•°ä¹‹åï¼š

```typescript
// âŒ é”™è¯¯ï¼šå¯é€‰å‚æ•°ä¸èƒ½åœ¨å¿…éœ€å‚æ•°ä¹‹å‰
// function wrong(a?: number, b: number) {}

// âœ… æ­£ç¡®
function correct(a: number, b?: number) {}
```

å¯é€‰å‚æ•°çš„ç±»å‹æ˜¯ `T | undefined`ï¼š

```typescript
function example(value?: string) {
  // value çš„ç±»å‹æ˜¯ string | undefined
  console.log(value?.toUpperCase()) // éœ€è¦å®‰å…¨è®¿é—®
}
```

## é»˜è®¤å‚æ•°

é»˜è®¤å‚æ•°ä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œä¸”ä¸éœ€è¦ `?`ï¼š

```typescript
function greet(name: string, greeting: string = 'Hello'): string {
  return `${greeting}, ${name}!`
}

greet('å¼ ä¸‰') // "Hello, å¼ ä¸‰!"
greet('å¼ ä¸‰', 'ä½ å¥½') // "ä½ å¥½, å¼ ä¸‰!"

// é»˜è®¤å‚æ•°å¯ä»¥æ”¾åœ¨å‰é¢ï¼ˆä½†è°ƒç”¨æ—¶éœ€è¦ä¼  undefinedï¼‰
function example(first: number = 10, second: number): number {
  return first + second
}

example(undefined, 5) // 15
```

### é»˜è®¤å‚æ•° vs å¯é€‰å‚æ•°

```typescript
// å¯é€‰å‚æ•°ï¼šå€¼å¯èƒ½æ˜¯ undefined
function fn1(x?: number) {
  console.log(x) // number | undefined
}

// é»˜è®¤å‚æ•°ï¼šå§‹ç»ˆæœ‰å€¼
function fn2(x: number = 10) {
  console.log(x) // number
}

fn1() // undefined
fn2() // 10
```

## å‰©ä½™å‚æ•°

ä½¿ç”¨ `...` æ”¶é›†å‰©ä½™å‚æ•°ï¼š

```typescript
// å‰©ä½™å‚æ•°æ˜¯æ•°ç»„ç±»å‹
function sum(...numbers: number[]): number {
  return numbers.reduce((total, n) => total + n, 0)
}

sum(1, 2, 3) // 6
sum(1, 2, 3, 4, 5) // 15

// ç»“åˆæ™®é€šå‚æ•°
function log(prefix: string, ...messages: string[]): void {
  messages.forEach((msg) => console.log(`${prefix}: ${msg}`))
}

log('INFO', 'å¼€å§‹å¤„ç†', 'å¤„ç†å®Œæˆ')
```

### å‰©ä½™å‚æ•°ä¸å…ƒç»„

```typescript
// ä½¿ç”¨å…ƒç»„ç±»å‹é™åˆ¶å‰©ä½™å‚æ•°
function format(...args: [string, number, boolean]): string {
  const [name, age, active] = args
  return `${name}, ${age}å², ${active ? 'æ´»è·ƒ' : 'ä¸æ´»è·ƒ'}`
}

format('å¼ ä¸‰', 25, true) // "å¼ ä¸‰, 25å², æ´»è·ƒ"

// å¸¦å¯å˜éƒ¨åˆ†çš„å…ƒç»„
function mixed(first: string, ...rest: [number, ...boolean[]]): void {
  console.log(first, rest)
}

mixed('hello', 1, true, false, true)
```

## å‡½æ•°é‡è½½

å½“å‡½æ•°æ ¹æ®ä¸åŒå‚æ•°æœ‰ä¸åŒè¿”å›ç±»å‹æ—¶ï¼Œä½¿ç”¨å‡½æ•°é‡è½½ï¼š

```typescript
// é‡è½½ç­¾å
function parse(input: string): number
function parse(input: number): string
function parse(input: boolean): string

// å®ç°ç­¾å
function parse(input: string | number | boolean): number | string {
  if (typeof input === 'string') {
    return parseInt(input, 10)
  } else if (typeof input === 'number') {
    return input.toString()
  } else {
    return input ? 'true' : 'false'
  }
}

// è°ƒç”¨æ—¶æœ‰ç²¾ç¡®çš„ç±»å‹
const num = parse('123') // number
const str = parse(456) // string
const bool = parse(true) // string
```

### æ›´å¤æ‚çš„é‡è½½ç¤ºä¾‹

```typescript
// æ ¹æ®å‚æ•°æ•°é‡æœ‰ä¸åŒè¡Œä¸º
function createElement(tag: 'div'): HTMLDivElement
function createElement(tag: 'span'): HTMLSpanElement
function createElement(tag: 'input'): HTMLInputElement
function createElement(tag: string): HTMLElement

function createElement(tag: string): HTMLElement {
  return document.createElement(tag)
}

const div = createElement('div') // HTMLDivElement
const input = createElement('input') // HTMLInputElement
const custom = createElement('custom-element') // HTMLElement
```

ğŸ”¶ é‡è½½æ³¨æ„äº‹é¡¹ï¼š

```typescript
// é‡è½½ç­¾åçš„é¡ºåºå¾ˆé‡è¦ï¼šæ›´å…·ä½“çš„æ”¾å‰é¢
function process(x: string): string // æ›´å…·ä½“
function process(x: unknown): unknown // æ›´å®½æ³›

function process(x: unknown): unknown {
  if (typeof x === 'string') {
    return x.toUpperCase()
  }
  return x
}

// TypeScript æŒ‰é¡ºåºåŒ¹é…ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…çš„ç±»å‹ç”Ÿæ•ˆ
process('hello') // è¿”å›ç±»å‹æ˜¯ string
process(123) // è¿”å›ç±»å‹æ˜¯ unknown
```

## this ç±»å‹

åœ¨æ–¹æ³•ä¸­å¯ä»¥æ˜¾å¼å£°æ˜ `this` çš„ç±»å‹ï¼š

```typescript
interface User {
  name: string
  greet(this: User): string
}

const user: User = {
  name: 'å¼ ä¸‰',
  greet() {
    return `Hello, ${this.name}`
  },
}

user.greet() // "Hello, å¼ ä¸‰"

// å•ç‹¬è°ƒç”¨ä¼šæŠ¥é”™ï¼ˆthis ç±»å‹ä¸åŒ¹é…ï¼‰
// const fn = user.greet;
// fn();  // âŒ é”™è¯¯
```

### this å‚æ•°

```typescript
function onClick(this: HTMLButtonElement, event: Event) {
  console.log(this.textContent) // this æ˜¯ HTMLButtonElement
}

const button = document.querySelector('button')!
button.addEventListener('click', onClick)
```

## å›è°ƒå‡½æ•°ç±»å‹

```typescript
// å®šä¹‰å›è°ƒç±»å‹
type Callback = (error: Error | null, result?: string) => void

function fetchData(url: string, callback: Callback): void {
  try {
    // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
    setTimeout(() => {
      callback(null, 'data')
    }, 1000)
  } catch (err) {
    callback(err as Error)
  }
}

fetchData('/api/data', (err, result) => {
  if (err) {
    console.error(err)
    return
  }
  console.log(result)
})
```

### å¸¸è§å›è°ƒæ¨¡å¼

```typescript
// äº‹ä»¶å¤„ç†å™¨
type EventHandler<T = Event> = (event: T) => void

// æ¯”è¾ƒå‡½æ•°
type Comparator<T> = (a: T, b: T) => number

// è½¬æ¢å‡½æ•°
type Mapper<T, U> = (item: T, index: number) => U

// è°“è¯å‡½æ•°
type Predicate<T> = (item: T) => boolean

// ä½¿ç”¨ç¤ºä¾‹
const numbers = [3, 1, 4, 1, 5, 9]

const isEven: Predicate<number> = (n) => n % 2 === 0
const double: Mapper<number, number> = (n) => n * 2
const compare: Comparator<number> = (a, b) => a - b

numbers.filter(isEven) // [4]
numbers.map(double) // [6, 2, 8, 2, 10, 18]
numbers.sort(compare) // [1, 1, 3, 4, 5, 9]
```

## æ„é€ å‡½æ•°ç±»å‹

```typescript
// æ„é€ å‡½æ•°ç±»å‹ä½¿ç”¨ new
type Constructor<T> = new (...args: any[]) => T

class User {
  constructor(public name: string) {}
}

function createInstance<T>(ctor: Constructor<T>, ...args: any[]): T {
  return new ctor(...args)
}

const user = createInstance(User, 'å¼ ä¸‰')
console.log(user.name) // "å¼ ä¸‰"
```

### æŠ½è±¡æ„é€ å‡½æ•°

```typescript
// å¯ä»¥å®ä¾‹åŒ–çš„æ„é€ å‡½æ•°
type Constructable<T> = new (...args: any[]) => T

// æŠ½è±¡æ„é€ å‡½æ•°ï¼ˆä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼‰
type AbstractConstructable<T> = abstract new (...args: any[]) => T

abstract class Animal {
  abstract speak(): void
}

class Dog extends Animal {
  speak() {
    console.log('Woof!')
  }
}

// æ¥å—æŠ½è±¡ç±»ä½œä¸ºå‚æ•°
function makeAnimal(ctor: AbstractConstructable<Animal>) {
  // ä¸èƒ½ç›´æ¥ newï¼Œä½†å¯ä»¥ç”¨äºç±»å‹çº¦æŸ
}
```

## æ³›å‹å‡½æ•°é¢„è§ˆ

å‡½æ•°å¯ä»¥ä½¿ç”¨æ³›å‹æ¥ä¿æŒç±»å‹å…³ç³»ï¼š

```typescript
// æ³›å‹å‡½æ•°
function identity<T>(value: T): T {
  return value
}

identity<string>('hello') // string
identity<number>(42) // number
identity('hello') // è‡ªåŠ¨æ¨æ–­ä¸º string

// æ³›å‹ç®­å¤´å‡½æ•°
const getFirst = <T>(arr: T[]): T | undefined => arr[0]

getFirst([1, 2, 3]) // number | undefined
getFirst(['a', 'b']) // string | undefined
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ å‡½æ•°ç±»å‹çš„å‚æ•°åé‡è¦å—ï¼Ÿ

å‚æ•°ååªç”¨äºæ–‡æ¡£ç›®çš„ï¼Œä¸å½±å“ç±»å‹å…¼å®¹æ€§ï¼š

```typescript
type Fn1 = (x: number) => number
type Fn2 = (y: number) => number

// Fn1 å’Œ Fn2 æ˜¯ç›¸åŒçš„ç±»å‹
const fn: Fn1 = (num) => num * 2
```

### ğŸ™‹ void å’Œ undefined è¿”å›å€¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```typescript
// voidï¼šå‡½æ•°ä¸è¿”å›æœ‰æ„ä¹‰çš„å€¼
function logVoid(): void {
  console.log('log')
  // å¯ä»¥ä¸å†™ return
}

// undefinedï¼šå¿…é¡»æ˜¾å¼è¿”å› undefined
function logUndefined(): undefined {
  console.log('log')
  return undefined // å¿…é¡»æœ‰è¿™è¡Œ
}

// void å…è®¸è¿”å›ä»»ä½•å€¼ï¼ˆç”¨äºå›è°ƒï¼‰
type VoidFunc = () => void
const fn: VoidFunc = () => 123 // âœ… å…è®¸
```

### ğŸ™‹ ä»€ä¹ˆæ—¶å€™ç”¨é‡è½½ï¼Œä»€ä¹ˆæ—¶å€™ç”¨è”åˆç±»å‹ï¼Ÿ

```typescript
// å¦‚æœè¿”å›ç±»å‹ä¸å‚æ•°ç±»å‹æ— å…³ï¼Œç”¨è”åˆç±»å‹
function process(x: string | number): string | number {
  return typeof x === 'string' ? x.toUpperCase() : x * 2
}

// å¦‚æœè¿”å›ç±»å‹å–å†³äºå‚æ•°ç±»å‹ï¼Œç”¨é‡è½½
function process2(x: string): string
function process2(x: number): number
function process2(x: string | number): string | number {
  return typeof x === 'string' ? x.toUpperCase() : x * 2
}

// é‡è½½ç‰ˆæœ¬æœ‰æ›´ç²¾ç¡®çš„ç±»å‹
const s = process2('hello') // stringï¼ˆä¸æ˜¯ string | numberï¼‰
const n = process2(42) // numberï¼ˆä¸æ˜¯ string | numberï¼‰
```

## æ€»ç»“

| ç‰¹æ€§       | è¯­æ³•                              | ç”¨é€”           |
| ---------- | --------------------------------- | -------------- |
| å‚æ•°ç±»å‹   | `(a: number)`                     | é™å®šå‚æ•°ç±»å‹   |
| è¿”å›å€¼ç±»å‹ | `(): number`                      | é™å®šè¿”å›å€¼ç±»å‹ |
| å¯é€‰å‚æ•°   | `(a?: number)`                    | å‚æ•°å¯ä»¥ä¸ä¼    |
| é»˜è®¤å‚æ•°   | `(a = 10)`                        | å‚æ•°æœ‰é»˜è®¤å€¼   |
| å‰©ä½™å‚æ•°   | `(...args: number[])`             | æ”¶é›†å¤šä½™å‚æ•°   |
| å‡½æ•°ç±»å‹   | `type Fn = (x: number) => number` | å®šä¹‰å‡½æ•°ç­¾å   |
| å‡½æ•°é‡è½½   | å¤šä¸ªç­¾å + å®ç°                   | å¤šç§è°ƒç”¨æ–¹å¼   |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ ç±»å‹æ¨æ–­ä¸ç±»å‹æ–­è¨€ï¼ŒæŒæ¡ TypeScript çš„ç±»å‹æ¨å¯¼æœºåˆ¶ã€‚
