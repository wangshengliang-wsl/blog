---
title: 'æ¥å£è¿›é˜¶'
description: 'TypeScript æ¥å£è¿›é˜¶è¯¦è§£ï¼šå‡½æ•°ç±»å‹æ¥å£ã€å¯ç´¢å¼•ç±»å‹ã€æ··åˆç±»å‹æ¥å£ã€æ¥å£åˆå¹¶çš„é«˜çº§ç”¨æ³•'
pubDate: 2024-01-24
toc: true
ogImage: true
category: 'TypeScript'
tags: ['TypeScript', 'æ¥å£', 'ç´¢å¼•ç­¾å', 'å‡½æ•°ç±»å‹', 'æ··åˆç±»å‹']
---

æŒæ¡äº†æ¥å£åŸºç¡€åï¼Œè¿™ç¯‡æ–‡ç« å°†æ·±å…¥æ¢è®¨æ¥å£çš„é«˜çº§ç‰¹æ€§ï¼šå‡½æ•°ç±»å‹æ¥å£ã€å¯ç´¢å¼•ç±»å‹ã€æ··åˆç±»å‹ç­‰ï¼Œè¿™äº›ç‰¹æ€§è®©æ¥å£èƒ½å¤Ÿæè¿°æ›´å¤æ‚çš„æ•°æ®ç»“æ„ã€‚

## å‡½æ•°ç±»å‹æ¥å£

### è°ƒç”¨ç­¾å

æ¥å£å¯ä»¥æè¿°å‡½æ•°çš„ç±»å‹ï¼š

```typescript
// TypeScript 5.x

// å‡½æ•°ç±»å‹æ¥å£
interface SearchFunc {
  (source: string, keyword: string): boolean
}

// å®ç°å‡½æ•°
const search: SearchFunc = (source, keyword) => {
  return source.includes(keyword)
}

// å‚æ•°åä¸éœ€è¦åŒ¹é…
const search2: SearchFunc = (src, kw) => {
  return src.indexOf(kw) !== -1
}

console.log(search('hello world', 'world')) // true
console.log(search2('hello world', 'foo')) // false
```

### å¸¦å±æ€§çš„å‡½æ•°æ¥å£

```typescript
// æ—¢æ˜¯å‡½æ•°åˆæœ‰å±æ€§
interface Counter {
  (start: number): number // è°ƒç”¨ç­¾å
  interval: number // å±æ€§
  reset(): void // æ–¹æ³•
}

function createCounter(): Counter {
  let count = 0

  const counter = ((start: number) => {
    count = start
    return count
  }) as Counter

  counter.interval = 1000
  counter.reset = () => {
    count = 0
  }

  return counter
}

const counter = createCounter()
console.log(counter(10)) // 10
console.log(counter.interval) // 1000
counter.reset()
```

### æ„é€ å‡½æ•°æ¥å£

```typescript
// æè¿°æ„é€ å‡½æ•°
interface ClockConstructor {
  new (hour: number, minute: number): ClockInterface
}

interface ClockInterface {
  tick(): void
}

// å®ç°
class DigitalClock implements ClockInterface {
  constructor(hour: number, minute: number) {
    // åˆå§‹åŒ–
  }

  tick() {
    console.log('beep beep')
  }
}

// å·¥å‚å‡½æ•°ä½¿ç”¨æ„é€ å‡½æ•°æ¥å£
function createClock(
  ctor: ClockConstructor,
  hour: number,
  minute: number
): ClockInterface {
  return new ctor(hour, minute)
}

const digital = createClock(DigitalClock, 12, 30)
digital.tick()
```

## å¯ç´¢å¼•ç±»å‹

### æ•°å­—ç´¢å¼•

```typescript
// æ•°å­—ç´¢å¼•ï¼ˆç±»ä¼¼æ•°ç»„ï¼‰
interface StringArray {
  [index: number]: string
}

const arr: StringArray = ['a', 'b', 'c']
console.log(arr[0]) // 'a'

// åªè¯»æ•°å­—ç´¢å¼•
interface ReadonlyStringArray {
  readonly [index: number]: string
}

const readonlyArr: ReadonlyStringArray = ['x', 'y', 'z']
// readonlyArr[0] = 'a';  // âŒ é”™è¯¯ï¼šåªè¯»
```

### å­—ç¬¦ä¸²ç´¢å¼•

```typescript
// å­—ç¬¦ä¸²ç´¢å¼•ï¼ˆç±»ä¼¼å­—å…¸ï¼‰
interface StringDictionary {
  [key: string]: string
}

const dict: StringDictionary = {
  name: 'å¼ ä¸‰',
  email: 'test@test.com',
}

dict.phone = '123456' // âœ… å¯ä»¥åŠ¨æ€æ·»åŠ 

// å­—ç¬¦ä¸²ç´¢å¼•ä¼šçº¦æŸæ‰€æœ‰å±æ€§
interface NumberDictionary {
  [key: string]: number
  length: number // âœ… number å…¼å®¹
  // name: string;  // âŒ é”™è¯¯ï¼šstring ä¸å…¼å®¹ number
}
```

### æ··åˆç´¢å¼•

```typescript
// åŒæ—¶ä½¿ç”¨æ•°å­—å’Œå­—ç¬¦ä¸²ç´¢å¼•
// æ•°å­—ç´¢å¼•çš„è¿”å›å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç´¢å¼•è¿”å›å€¼çš„å­ç±»å‹
interface Mixed {
  [index: number]: string // æ•°å­—ç´¢å¼•è¿”å› string
  [key: string]: string | number // å­—ç¬¦ä¸²ç´¢å¼•è¿”å› string | number
  length: number // âœ… å…¼å®¹
}

// ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º obj[0] ä¼šè¢«è½¬æ¢ä¸º obj["0"]
// æ‰€ä»¥æ•°å­—ç´¢å¼•å¿…é¡»å…¼å®¹å­—ç¬¦ä¸²ç´¢å¼•
```

### å®é™…åº”ç”¨

```typescript
// CSS æ ·å¼å¯¹è±¡
interface CSSStyles {
  [property: string]: string | number
  width?: number | string
  height?: number | string
}

const styles: CSSStyles = {
  width: 100,
  height: '50px',
  backgroundColor: '#fff',
  fontSize: 14,
}

// é…ç½®æ˜ å°„
interface EnvConfig {
  [key: string]: string | undefined
  NODE_ENV: string
  API_URL: string
  DEBUG?: string
}

const env: EnvConfig = {
  NODE_ENV: 'production',
  API_URL: 'https://api.example.com',
  CUSTOM_VAR: 'value',
}
```

## æ··åˆç±»å‹

ä¸€ä¸ªæ¥å£å¯ä»¥åŒæ—¶æè¿°å‡½æ•°ã€å¯¹è±¡å’Œæ›´å¤šç±»å‹ï¼š

```typescript
// æ··åˆç±»å‹ï¼šæ—¢æ˜¯å‡½æ•°åˆæ˜¯å¯¹è±¡
interface Lib {
  (): void // å¯ä»¥ä½œä¸ºå‡½æ•°è°ƒç”¨
  version: string // æœ‰ version å±æ€§
  doSomething(): void // æœ‰æ–¹æ³•
}

function createLib(): Lib {
  const lib = (() => {
    console.log('Lib called')
  }) as Lib

  lib.version = '1.0.0'
  lib.doSomething = () => {
    console.log('Doing something...')
  }

  return lib
}

const myLib = createLib()
myLib() // "Lib called"
console.log(myLib.version) // "1.0.0"
myLib.doSomething() // "Doing something..."
```

### é“¾å¼è°ƒç”¨æ¥å£

```typescript
interface QueryBuilder {
  select(fields: string[]): QueryBuilder
  from(table: string): QueryBuilder
  where(condition: string): QueryBuilder
  orderBy(field: string, direction?: 'asc' | 'desc'): QueryBuilder
  limit(count: number): QueryBuilder
  execute(): Promise<any[]>
}

const query: QueryBuilder = {
  select(fields) {
    console.log('SELECT', fields.join(', '))
    return this
  },
  from(table) {
    console.log('FROM', table)
    return this
  },
  where(condition) {
    console.log('WHERE', condition)
    return this
  },
  orderBy(field, direction = 'asc') {
    console.log('ORDER BY', field, direction)
    return this
  },
  limit(count) {
    console.log('LIMIT', count)
    return this
  },
  async execute() {
    return []
  },
}

// é“¾å¼è°ƒç”¨
query
  .select(['id', 'name'])
  .from('users')
  .where('age > 18')
  .orderBy('name')
  .limit(10)
  .execute()
```

## æ¥å£çš„é«˜çº§åˆå¹¶

### å‘½åç©ºé—´ä¸æ¥å£åˆå¹¶

```typescript
// æ¥å£å¯ä»¥å’Œå‘½åç©ºé—´åˆå¹¶
interface Document {
  createElement(tagName: string): Element
}

namespace Document {
  export function isDocument(obj: any): obj is Document {
    return obj && typeof obj.createElement === 'function'
  }
}

// ä½¿ç”¨
const doc: Document = {
  createElement(tagName: string) {
    return {} as Element
  },
}

Document.isDocument(doc) // true
```

### å…¨å±€æ¥å£æ‰©å±•

```typescript
// æ‰©å±•å…¨å±€æ¥å£
declare global {
  interface Window {
    myCustomProperty: string
  }

  interface Array<T> {
    customMethod(): T[]
  }
}

// ä½¿ç”¨ï¼ˆéœ€è¦å®ç°ï¼‰
window.myCustomProperty = 'hello'

Array.prototype.customMethod = function () {
  return [...this]
}

export {} // ä½¿æ–‡ä»¶æˆä¸ºæ¨¡å—
```

### æ¨¡å—æ¥å£æ‰©å±•

```typescript
// æ‰©å±•ç¬¬ä¸‰æ–¹åº“çš„æ¥å£
import { AxiosRequestConfig } from 'axios'

declare module 'axios' {
  interface AxiosRequestConfig {
    retry?: number
    retryDelay?: number
  }
}

// ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°å±æ€§
const config: AxiosRequestConfig = {
  url: '/api/data',
  retry: 3,
  retryDelay: 1000,
}
```

## æ¥å£ä¸æ³›å‹

```typescript
// æ³›å‹æ¥å£
interface Container<T> {
  value: T
  getValue(): T
  setValue(value: T): void
}

class Box<T> implements Container<T> {
  constructor(public value: T) {}

  getValue(): T {
    return this.value
  }

  setValue(value: T): void {
    this.value = value
  }
}

const stringBox = new Box('hello')
const numberBox = new Box(42)

// æ³›å‹æ¥å£ä½œä¸ºå‡½æ•°ç±»å‹
interface GenericFn<T> {
  (arg: T): T
}

const identity: GenericFn<number> = (x) => x
```

### æ³›å‹çº¦æŸ

```typescript
// æ¥å£ä½œä¸ºæ³›å‹çº¦æŸ
interface Lengthwise {
  length: number
}

function logLength<T extends Lengthwise>(arg: T): T {
  console.log(arg.length)
  return arg
}

logLength('hello') // 5
logLength([1, 2, 3]) // 3
logLength({ length: 10, value: 'test' }) // 10
// logLength(123);  // âŒ é”™è¯¯ï¼šnumber æ²¡æœ‰ length å±æ€§
```

## æ¥å£çš„å·¥å…·ç±»å‹åº”ç”¨

```typescript
interface User {
  id: number
  name: string
  email: string
  password: string
  createdAt: Date
}

// Partialï¼šæ‰€æœ‰å±æ€§å¯é€‰
type PartialUser = Partial<User>

// Requiredï¼šæ‰€æœ‰å±æ€§å¿…éœ€
type RequiredUser = Required<PartialUser>

// Readonlyï¼šæ‰€æœ‰å±æ€§åªè¯»
type ReadonlyUser = Readonly<User>

// Pickï¼šé€‰å–éƒ¨åˆ†å±æ€§
type UserBasic = Pick<User, 'id' | 'name'>

// Omitï¼šæ’é™¤éƒ¨åˆ†å±æ€§
type UserWithoutPassword = Omit<User, 'password'>

// Recordï¼šåˆ›å»ºå¯¹è±¡ç±»å‹
type UserRoles = Record<string, User>

// ç»„åˆä½¿ç”¨
type UserUpdate = Partial<Omit<User, 'id' | 'createdAt'>>
// { name?: string; email?: string; password?: string }
```

## å®é™…åº”ç”¨åœºæ™¯

### äº‹ä»¶å¤„ç†å™¨æ¥å£

```typescript
interface EventMap {
  click: MouseEvent
  keydown: KeyboardEvent
  scroll: Event
  custom: CustomEvent<{ data: string }>
}

interface EventEmitter<T extends Record<string, Event>> {
  on<K extends keyof T>(event: K, handler: (e: T[K]) => void): void
  off<K extends keyof T>(event: K, handler: (e: T[K]) => void): void
  emit<K extends keyof T>(event: K, e: T[K]): void
}

class MyEmitter implements EventEmitter<EventMap> {
  private handlers = new Map<string, Function[]>()

  on<K extends keyof EventMap>(event: K, handler: (e: EventMap[K]) => void) {
    const list = this.handlers.get(event as string) || []
    list.push(handler)
    this.handlers.set(event as string, list)
  }

  off<K extends keyof EventMap>(event: K, handler: (e: EventMap[K]) => void) {
    const list = this.handlers.get(event as string) || []
    const index = list.indexOf(handler)
    if (index > -1) list.splice(index, 1)
  }

  emit<K extends keyof EventMap>(event: K, e: EventMap[K]) {
    const list = this.handlers.get(event as string) || []
    list.forEach((handler) => handler(e))
  }
}
```

### çŠ¶æ€ç®¡ç†æ¥å£

```typescript
interface State {
  user: User | null
  posts: Post[]
  loading: boolean
}

interface Actions {
  login(credentials: { email: string; password: string }): Promise<void>
  logout(): void
  fetchPosts(): Promise<void>
}

interface Store<S, A> {
  state: S
  actions: A
  subscribe(listener: (state: S) => void): () => void
}

type AppStore = Store<State, Actions>
```

## å¸¸è§é—®é¢˜

### ğŸ™‹ æ¥å£å¯ä»¥æè¿°ç±»çš„é™æ€éƒ¨åˆ†å—ï¼Ÿ

ä¸èƒ½ç›´æ¥æè¿°ï¼Œéœ€è¦åˆ†å¼€å®šä¹‰ï¼š

```typescript
// å®ä¾‹æ¥å£
interface ClockInterface {
  currentTime: Date
  setTime(d: Date): void
}

// æ„é€ å‡½æ•°æ¥å£ï¼ˆé™æ€éƒ¨åˆ†ï¼‰
interface ClockConstructor {
  new (hour: number, minute: number): ClockInterface
  staticMethod(): void
}
```

### ğŸ™‹ å¦‚ä½•è®©ç´¢å¼•ç­¾åæ”¯æŒå¤šç§ç±»å‹ï¼Ÿ

ä½¿ç”¨è”åˆç±»å‹ï¼š

```typescript
interface FlexibleObject {
  [key: string]: string | number | boolean | undefined
  requiredField: string // å¿…é¡»å…¼å®¹ç´¢å¼•ç­¾åçš„ç±»å‹
}
```

### ğŸ™‹ æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```typescript
// æ¥å£ï¼šçº¯ç±»å‹çº¦æŸï¼Œæ— å®ç°
interface Flyable {
  fly(): void
}

// æŠ½è±¡ç±»ï¼šå¯ä»¥æœ‰éƒ¨åˆ†å®ç°
abstract class Animal {
  abstract makeSound(): void

  move() {
    console.log('Moving...')
  }
}
```

## æ€»ç»“

| ç‰¹æ€§       | è¯­æ³•                 | ç”¨é€”         |
| ---------- | -------------------- | ------------ |
| å‡½æ•°ç±»å‹   | `(arg: T): R`        | æè¿°å‡½æ•°ç­¾å |
| æ„é€ ç­¾å   | `new (arg: T): R`    | æè¿°æ„é€ å‡½æ•° |
| æ•°å­—ç´¢å¼•   | `[index: number]: T` | ç±»æ•°ç»„ç»“æ„   |
| å­—ç¬¦ä¸²ç´¢å¼• | `[key: string]: T`   | å­—å…¸ç»“æ„     |
| æ··åˆç±»å‹   | ç»„åˆå¤šç§ç­¾å         | å¤æ‚å¯¹è±¡     |
| æ¥å£åˆå¹¶   | åŒå interface       | æ‰©å±•æ¥å£     |

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹ æ¥å£çš„ç»§æ‰¿ä¸å®ç°ï¼Œäº†è§£å¦‚ä½•é€šè¿‡ç»§æ‰¿å¤ç”¨æ¥å£å®šä¹‰ã€‚
