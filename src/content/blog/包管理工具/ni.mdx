---
title: ni å®Œå…¨æŒ‡å—
description: ni æ˜¯ç”± antfu å¼€å‘çš„è‡ªåŠ¨æ£€æµ‹åŒ…ç®¡ç†å™¨å·¥å…·ï¼Œæœ¬æ–‡æ¶µç›–å®‰è£…ä½¿ç”¨ã€å‘½ä»¤å¯¹ç…§ã€é…ç½®é€‰é¡¹åŠå®ç”¨åœºæ™¯
pubDate: 2025-11-09
toc: true
ogImage: true
category: åŒ…ç®¡ç†å·¥å…·
tags: ['ni', 'Node.js', 'åŒ…ç®¡ç†å™¨', 'JavaScript', 'antfu']
---

ni æ˜¯ç”± [Anthony Fu](https://github.com/antfu) å¼€å‘çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹é¡¹ç›®ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ï¼ˆnpm/yarn/pnpm/bunï¼‰ï¼Œå¹¶ä½¿ç”¨å¯¹åº”çš„å‘½ä»¤æ‰§è¡Œæ“ä½œã€‚åœ¨å¤šé¡¹ç›®ã€å¤šåŒ…ç®¡ç†å™¨ç¯å¢ƒä¸‹ï¼Œä¸å†éœ€è¦è®°å¿†å„ç§å‘½ä»¤å·®å¼‚ã€‚

ğŸ¯ **ç¯å¢ƒè¯´æ˜**ï¼šæœ¬æ–‡åŸºäº @antfu/ni v0.23.x ç¼–å†™ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ ni

ğŸ™‹ ä¸åŒé¡¹ç›®å¯èƒ½ä½¿ç”¨ä¸åŒçš„åŒ…ç®¡ç†å™¨ã€‚æ¯æ¬¡åˆ‡æ¢é¡¹ç›®éƒ½è¦æƒ³ä¸€ä¸‹ï¼š

- è¿™ä¸ªé¡¹ç›®ç”¨çš„æ˜¯ npm è¿˜æ˜¯ pnpmï¼Ÿ
- pnpm çš„å®‰è£…å‘½ä»¤æ˜¯ `pnpm add` è¿˜æ˜¯ `pnpm install`ï¼Ÿ
- yarn è¿è¡Œè„šæœ¬è¦ä¸è¦ `run`ï¼Ÿ

âœ… ni è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åªéœ€è®°ä½ä¸€å¥—å‘½ä»¤ï¼Œni ä¼šæ ¹æ® lockfile è‡ªåŠ¨è¯†åˆ«åŒ…ç®¡ç†å™¨å¹¶è°ƒç”¨å¯¹åº”å‘½ä»¤ã€‚

```bash
# æ— è®ºé¡¹ç›®ç”¨çš„æ˜¯ npm/yarn/pnpm/bun
$ ni        # å®‰è£…ä¾èµ–
$ nr dev    # è¿è¡Œè„šæœ¬
$ nu        # æ›´æ–°ä¾èµ–
```

## å®‰è£…

```bash
$ npm install -g @antfu/ni

# æˆ–
$ pnpm add -g @antfu/ni

# æˆ–
$ yarn global add @antfu/ni
```

éªŒè¯å®‰è£…ï¼š

```bash
$ ni --version
0.23.0
```

## æ ¸å¿ƒå‘½ä»¤

ni æä¾›äº†ä¸€ç»„ç®€çŸ­çš„å‘½ä»¤ï¼Œå¯¹åº”ä¸åŒåŒ…ç®¡ç†å™¨çš„å¸¸ç”¨æ“ä½œï¼š

| ni å‘½ä»¤  | npm             | yarn            | pnpm            | bun            | deno            |
| -------- | --------------- | --------------- | --------------- | -------------- | --------------- |
| `ni`     | `npm install`   | `yarn install`  | `pnpm install`  | `bun install`  | `deno install`  |
| `ni pkg` | `npm i pkg`     | `yarn add pkg`  | `pnpm add pkg`  | `bun add pkg`  | `deno add pkg`  |
| `nr`     | `npm run`       | `yarn run`      | `pnpm run`      | `bun run`      | `deno task`     |
| `nu`     | `npm update`    | `yarn upgrade`  | `pnpm update`   | `bun update`   | `deno upgrade`  |
| `nup`    | `npm upgrade`   | `yarn up`       | `pnpm update`   | `bun update`   | `deno upgrade`  |
| `nun`    | `npm uninstall` | `yarn remove`   | `pnpm remove`   | `bun remove`   | `deno remove`   |
| `nci`    | `npm ci`        | `yarn --frozen` | `pnpm --frozen` | `bun --frozen` | `deno cache`    |
| `nlx`    | `npx`           | `yarn dlx`      | `pnpm dlx`      | `bunx`         | `deno run npm:` |
| `na`     | `npm`           | `yarn`          | `pnpm`          | `bun`          | `deno`          |

## ni - å®‰è£…ä¾èµ–

```bash
# å®‰è£… package.json ä¸­çš„æ‰€æœ‰ä¾èµ–
$ ni

# å®‰è£…æŒ‡å®šåŒ…ï¼ˆç”Ÿäº§ä¾èµ–ï¼‰
$ ni lodash

# å®‰è£…å¼€å‘ä¾èµ–
$ ni -D typescript

# å®‰è£…å¤šä¸ªåŒ…
$ ni express cors helmet

# å†»ç»“å®‰è£…ï¼ˆCI ç¯å¢ƒï¼‰
$ ni --frozen
```

ni ä¼šæ ¹æ®é¡¹ç›®ä¸­çš„ lockfile æ£€æµ‹åŒ…ç®¡ç†å™¨ï¼š

| Lockfile            | åŒ…ç®¡ç†å™¨ |
| ------------------- | -------- |
| `package-lock.json` | npm      |
| `yarn.lock`         | yarn     |
| `pnpm-lock.yaml`    | pnpm     |
| `bun.lockb`         | bun      |

## nr - è¿è¡Œè„šæœ¬

```bash
# è¿è¡Œ dev è„šæœ¬
$ nr dev

# è¿è¡Œå¸¦å‚æ•°çš„è„šæœ¬
$ nr test --watch

# äº¤äº’å¼é€‰æ‹©è„šæœ¬
$ nr

# è¿è¡ŒæŒ‡å®šè„šæœ¬ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™å¿½ç•¥
$ nr build --if-present
```

ä¸å¸¦å‚æ•°æ‰§è¡Œ `nr` ä¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨è„šæœ¬ä¾›é€‰æ‹©ï¼š

```bash
$ nr
? script â€º - Use arrow-keys. Return to submit.
â¯   dev
    build
    test
    lint
```

### nr çš„ä¾¿æ·ä¹‹å¤„

æ— è®ºé¡¹ç›®ç”¨ä»€ä¹ˆåŒ…ç®¡ç†å™¨ï¼š

```bash
# ä¸ç”¨åŒºåˆ† npm run dev / yarn dev / pnpm dev
$ nr dev
```

## nu - æ›´æ–°ä¾èµ–

```bash
# äº¤äº’å¼æ›´æ–°
$ nu

# æ›´æ–°æŒ‡å®šåŒ…
$ nu lodash

# æ›´æ–°æ‰€æœ‰åŒ…
$ nu -i
```

## nup - å‡çº§ä¾èµ–

```bash
# å‡çº§ä¾èµ–
$ nup

# äº¤äº’å¼å‡çº§ï¼ˆä¸æ”¯æŒ npm/bun/denoï¼‰
$ nup -i
```

## nci - æ¸…æ´å®‰è£…

ç”¨äº CI ç¯å¢ƒï¼ŒåŸºäº lockfile å®‰è£…ç²¾ç¡®ç‰ˆæœ¬ï¼š

```bash
$ nci

# npm ci
# yarn install --frozen-lockfile
# pnpm install --frozen-lockfile
# bun install --frozen-lockfile
# deno cache --reload
```

## nun - å¸è½½åŒ…

```bash
# å¸è½½åŒ…
$ nun lodash

# å¸è½½å¤šä¸ªåŒ…
$ nun lodash express
```

## nlx - æ‰§è¡ŒåŒ…å‘½ä»¤

```bash
# ç±»ä¼¼ npxï¼Œä¸´æ—¶ä¸‹è½½å¹¶æ‰§è¡Œ
$ nlx create-react-app my-app

# æ‰§è¡Œæœ¬åœ°åŒ…å‘½ä»¤
$ nlx eslint src
```

## na - ç›´æ¥è°ƒç”¨åŒ…ç®¡ç†å™¨

å½“éœ€è¦æ‰§è¡Œ ni æ²¡æœ‰å°è£…çš„å‘½ä»¤æ—¶ï¼Œä½¿ç”¨ naï¼š

```bash
# ç­‰åŒäº npm/yarn/pnpm/bun çš„åŸç”Ÿå‘½ä»¤
$ na cache clean
$ na audit
$ na outdated
```

## å…¨å±€æ ‡å¿—

ni æ”¯æŒä¸€äº›å…¨å±€æ ‡å¿—ï¼š

```bash
# æ‰“å°å°†è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¸æ‰§è¡Œï¼‰
$ ni vite ?

# åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•æ‰§è¡Œ
$ ni -C packages/foo vite
$ nr -C playground dev

# æ˜¾ç¤ºç‰ˆæœ¬
$ ni -v

# æ˜¾ç¤ºå¸®åŠ©
$ ni -h
```

## å…¨å±€å®‰è£…

```bash
# å…¨å±€å®‰è£…åŒ…
$ ni -g typescript

# å…¨å±€å¸è½½
$ nun -g typescript
```

## æ£€æµ‹æœºåˆ¶

ni æŒ‰ä»¥ä¸‹é¡ºåºæ£€æµ‹åŒ…ç®¡ç†å™¨ï¼š

1. æ£€æŸ¥å½“å‰ç›®å½•åŠçˆ¶ç›®å½•çš„ lockfile
2. æ£€æŸ¥ `package.json` ä¸­çš„ `packageManager` å­—æ®µ
3. å¦‚æœéƒ½æ²¡æœ‰ï¼Œæç¤ºé€‰æ‹©

### ä½¿ç”¨ packageManager å­—æ®µ

åœ¨ `package.json` ä¸­æŒ‡å®šåŒ…ç®¡ç†å™¨ï¼ˆCorepack è§„èŒƒï¼‰ï¼š

```json
{
  "packageManager": "pnpm@9.15.0"
}
```

ni ä¼šè¯†åˆ«å¹¶ä½¿ç”¨æŒ‡å®šçš„åŒ…ç®¡ç†å™¨ã€‚

## é…ç½®

åœ¨ç”¨æˆ·ç›®å½•åˆ›å»º `~/.nirc` é…ç½®æ–‡ä»¶ï¼š

```ini
; é»˜è®¤ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ï¼ˆæ—  lockfile æ—¶ï¼‰
defaultAgent=pnpm

; å…¨å±€åŒ…ä½¿ç”¨çš„ç®¡ç†å™¨
globalAgent=npm
```

### é…ç½®é€‰é¡¹

| é€‰é¡¹           | è¯´æ˜                   | é»˜è®¤å€¼   |
| -------------- | ---------------------- | -------- |
| `defaultAgent` | é»˜è®¤åŒ…ç®¡ç†å™¨           | æç¤ºé€‰æ‹© |
| `globalAgent`  | å…¨å±€å®‰è£…ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ | npm      |

## å®ç”¨åœºæ™¯

### å¤šé¡¹ç›®å¼€å‘

å‡è®¾ä½ åŒæ—¶ç»´æŠ¤å¤šä¸ªé¡¹ç›®ï¼š

- é¡¹ç›® Aï¼šä½¿ç”¨ npm
- é¡¹ç›® Bï¼šä½¿ç”¨ yarn
- é¡¹ç›® Cï¼šä½¿ç”¨ pnpm

æœ‰äº† niï¼Œæ— éœ€åˆ‡æ¢æ€ç»´ï¼š

```bash
$ cd project-a && ni && nr dev
$ cd project-b && ni && nr dev
$ cd project-c && ni && nr dev
```

### CI/CD ç¯å¢ƒ

åœ¨ CI ä¸­ä½¿ç”¨ `--frozen` ç¡®ä¿ä¾èµ–ç‰ˆæœ¬ä¸€è‡´ï¼š

```yaml
# GitHub Actions ç¤ºä¾‹
- name: Install dependencies
  run: npx @antfu/ni --frozen

- name: Build
  run: npx @antfu/ni run build
```

### è„šæœ¬ä¸­ä½¿ç”¨

åœ¨ npm scripts ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ niï¼š

```json
{
  "scripts": {
    "setup": "ni",
    "dev": "nr dev"
  }
}
```

### é¡¹ç›®æ¨¡æ¿

åˆ›å»ºé¡¹ç›®æ¨¡æ¿æ—¶ï¼Œä½¿ç”¨ ni å‘½ä»¤å¯ä»¥è®©æ¨¡æ¿é€‚é…ä»»ä½•åŒ…ç®¡ç†å™¨ï¼š

```bash
# setup.sh
#!/bin/bash
ni
nr build
```

## ä¸å…¶ä»–å·¥å…·å¯¹æ¯”

| å·¥å…·     | ç‰¹ç‚¹                 |
| -------- | -------------------- |
| ni       | è‡ªåŠ¨æ£€æµ‹ï¼Œç»Ÿä¸€å‘½ä»¤   |
| npx      | npm ä¸“å±ï¼Œæ‰§è¡ŒåŒ…å‘½ä»¤ |
| pnpx     | pnpm ä¸“å±            |
| yarn dlx | yarn ä¸“å±            |
| bunx     | bun ä¸“å±             |

ni çš„ä¼˜åŠ¿åœ¨äºè·¨åŒ…ç®¡ç†å™¨çš„ç»Ÿä¸€ä½“éªŒã€‚

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

| å‘½ä»¤          | ç”¨é€”                 |
| ------------- | -------------------- |
| `ni`          | å®‰è£…æ‰€æœ‰ä¾èµ–         |
| `ni <pkg>`    | å®‰è£…åŒ…               |
| `ni -D <pkg>` | å®‰è£…å¼€å‘ä¾èµ–         |
| `ni -g <pkg>` | å…¨å±€å®‰è£…             |
| `ni --frozen` | å†»ç»“å®‰è£…ï¼ˆCIï¼‰       |
| `ni -i`       | äº¤äº’å¼æœç´¢å®‰è£…       |
| `nci`         | æ¸…æ´å®‰è£…ï¼ˆCI æ¨èï¼‰  |
| `nr`          | äº¤äº’å¼è¿è¡Œè„šæœ¬       |
| `nr <script>` | è¿è¡ŒæŒ‡å®šè„šæœ¬         |
| `nu`          | æ›´æ–°ä¾èµ–             |
| `nu <pkg>`    | æ›´æ–°æŒ‡å®šåŒ…           |
| `nup`         | å‡çº§ä¾èµ–             |
| `nup -i`      | äº¤äº’å¼å‡çº§           |
| `nun <pkg>`   | å¸è½½åŒ…               |
| `nun -m`      | äº¤äº’å¼å¤šé€‰å¸è½½       |
| `nlx <pkg>`   | æ‰§è¡ŒåŒ…å‘½ä»¤           |
| `na <cmd>`    | è°ƒç”¨åŸç”ŸåŒ…ç®¡ç†å™¨å‘½ä»¤ |
| `ni -C <dir>` | åˆ‡æ¢ç›®å½•åæ‰§è¡Œ       |

## å¸¸è§é—®é¢˜

### æ£€æµ‹åˆ°é”™è¯¯çš„åŒ…ç®¡ç†å™¨

åˆ é™¤ä¸éœ€è¦çš„ lockfileï¼Œæˆ–åœ¨ `package.json` ä¸­æ˜ç¡®æŒ‡å®šï¼š

```json
{
  "packageManager": "pnpm@9.15.0"
}
```

### æƒ³è¦å¼ºåˆ¶ä½¿ç”¨æŸä¸ªåŒ…ç®¡ç†å™¨

ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š

```bash
$ NI_DEFAULT_AGENT=pnpm ni
```

æˆ–åœ¨ `~/.nirc` ä¸­è®¾ç½® `defaultAgent`ã€‚

### Windows å…¼å®¹æ€§

ni å®Œå…¨æ”¯æŒ Windowsï¼ŒåŒ…æ‹¬ PowerShell å’Œ CMDã€‚

## å‚è€ƒèµ„æ–™

- [ni GitHub](https://github.com/antfu/ni)
- [Anthony Fu çš„åšå®¢](https://antfu.me/)
- [Corepack æ–‡æ¡£](https://nodejs.org/api/corepack.html)
