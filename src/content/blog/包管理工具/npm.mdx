---
title: npm å®Œå…¨æŒ‡å—
description: npm æ˜¯ Node.js å®˜æ–¹åŒ…ç®¡ç†å™¨ï¼Œæœ¬æ–‡æ¶µç›–å®‰è£…é…ç½®ã€ä¾èµ–ç®¡ç†ã€è„šæœ¬è¿è¡Œã€ç‰ˆæœ¬æ§åˆ¶ã€å‘å¸ƒåŒ…ç­‰æ ¸å¿ƒæ“ä½œä¸å®ç”¨æŠ€å·§
pubDate: 2025-11-09
toc: true
ogImage: true
category: åŒ…ç®¡ç†å·¥å…·
tags: ['npm', 'Node.js', 'åŒ…ç®¡ç†å™¨', 'JavaScript']
---

npmï¼ˆNode Package Managerï¼‰éš Node.js ä¸€åŒå®‰è£…ï¼Œæ˜¯ JavaScript ç”Ÿæ€ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„åŒ…ç®¡ç†å™¨ã€‚æˆªè‡³ 2024 å¹´ï¼Œnpm registry æ‰˜ç®¡äº†è¶…è¿‡ 200 ä¸‡ä¸ªåŒ…ï¼Œæ¯å‘¨ä¸‹è½½é‡è¾¾æ•°åäº¿æ¬¡ã€‚

ğŸ¯ **ç¯å¢ƒè¯´æ˜**ï¼šæœ¬æ–‡åŸºäº npm v10.x ç¼–å†™ï¼ŒNode.js v20.x ç¯å¢ƒã€‚

## å®‰è£…ä¸ç‰ˆæœ¬ç®¡ç†

npm éš Node.js æ†ç»‘å®‰è£…ï¼Œæ— éœ€å•ç‹¬ä¸‹è½½ã€‚å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ç‰ˆæœ¬ï¼š

```bash
$ node -v
v20.10.0

$ npm -v
10.2.3
```

å‡çº§ npm åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š

```bash
$ npm install -g npm@latest
```

è‹¥éœ€è¦å®‰è£…ç‰¹å®šç‰ˆæœ¬ï¼š

```bash
$ npm install -g npm@9.8.1
```

## é¡¹ç›®åˆå§‹åŒ–

åˆ›å»ºæ–°é¡¹ç›®æ—¶ï¼Œä½¿ç”¨ `npm init` ç”Ÿæˆ `package.json`ï¼š

```bash
$ mkdir my-project && cd my-project
$ npm init
```

æŒ‰æç¤ºå¡«å†™é¡¹ç›®ä¿¡æ¯ï¼Œæˆ–ä½¿ç”¨ `-y` è·³è¿‡æ‰€æœ‰æé—®ï¼Œé‡‡ç”¨é»˜è®¤å€¼ï¼š

```bash
$ npm init -y
```

ç”Ÿæˆçš„ `package.json` ç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
```

## ä¾èµ–ç®¡ç†

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…ç”Ÿäº§ä¾èµ–ï¼ˆå†™å…¥ dependenciesï¼‰
$ npm install lodash

# å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå†™å…¥ devDependenciesï¼‰
$ npm install -D typescript

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
$ npm install lodash@4.17.21

# å®‰è£…å¤šä¸ªåŒ…
$ npm install express cors helmet

# å…¨å±€å®‰è£…
$ npm install -g typescript
```

ä¾èµ–å®‰è£…åä¼šå†™å…¥ `package.json`ï¼ŒåŒæ—¶ç”Ÿæˆ `package-lock.json` é”å®šç²¾ç¡®ç‰ˆæœ¬ã€‚

### ä¾èµ–ç±»å‹

| ç±»å‹       | å­—æ®µ                 | ç”¨é€”             | å®‰è£…å‚æ•°    |
| ---------- | -------------------- | ---------------- | ----------- |
| ç”Ÿäº§ä¾èµ–   | dependencies         | è¿è¡Œæ—¶å¿…éœ€       | é»˜è®¤æˆ– `-S` |
| å¼€å‘ä¾èµ–   | devDependencies      | å¼€å‘/æ„å»ºæ—¶ä½¿ç”¨  | `-D`        |
| å¯é€‰ä¾èµ–   | optionalDependencies | å®‰è£…å¤±è´¥ä¸é˜»æ–­   | `-O`        |
| åŒç‰ˆæœ¬ä¾èµ– | peerDependencies     | æ’ä»¶å£°æ˜å®¿ä¸»ç‰ˆæœ¬ | æ‰‹åŠ¨æ·»åŠ     |

### æ›´æ–°ä¸å¸è½½

```bash
# æ£€æŸ¥è¿‡æ—¶çš„åŒ…
$ npm outdated

# æ›´æ–°æŒ‡å®šåŒ…
$ npm update lodash

# æ›´æ–°æ‰€æœ‰åŒ…ï¼ˆéµå¾ª semver èŒƒå›´ï¼‰
$ npm update

# å¸è½½åŒ…
$ npm uninstall lodash

# å¸è½½å…¨å±€åŒ…
$ npm uninstall -g typescript
```

### ç‰ˆæœ¬èŒƒå›´è¯­æ³•

`package.json` ä¸­çš„ç‰ˆæœ¬å·éµå¾ª [SemVer](https://semver.org/) è§„èŒƒï¼š

| å†™æ³•       | å«ä¹‰                        |
| ---------- | --------------------------- |
| `4.17.21`  | ç²¾ç¡®ç‰ˆæœ¬                    |
| `^4.17.21` | å…¼å®¹ 4.x.xï¼Œä¸ä½äº 4.17.21  |
| `~4.17.21` | å…¼å®¹ 4.17.xï¼Œä¸ä½äº 4.17.21 |
| `>=4.0.0`  | å¤§äºç­‰äºæŒ‡å®šç‰ˆæœ¬            |
| `*`        | ä»»æ„ç‰ˆæœ¬                    |

`^`ï¼ˆcaretï¼‰æ˜¯ npm é»˜è®¤ä½¿ç”¨çš„å‰ç¼€ï¼Œå…è®¸æ¬¡ç‰ˆæœ¬å’Œè¡¥ä¸ç‰ˆæœ¬æ›´æ–°ï¼Œä½†ä¸å…è®¸ä¸»ç‰ˆæœ¬å˜æ›´ã€‚

## npm scripts

`package.json` ä¸­çš„ `scripts` å­—æ®µç”¨äºå®šä¹‰å¯æ‰§è¡Œå‘½ä»¤ï¼š

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint src --ext .ts,.tsx",
    "test": "vitest",
    "prepare": "husky install"
  }
}
```

è¿è¡Œè„šæœ¬ï¼š

```bash
# å†…ç½®è„šæœ¬ï¼ˆtestã€startã€stopã€restartï¼‰å¯çœç•¥ run
$ npm test
$ npm start

# è‡ªå®šä¹‰è„šæœ¬éœ€è¦ run
$ npm run dev
$ npm run build
```

### è„šæœ¬é’©å­

npm æ”¯æŒ `pre` å’Œ `post` é’©å­ï¼Œåœ¨ç›®æ ‡è„šæœ¬å‰åè‡ªåŠ¨æ‰§è¡Œï¼š

```json
{
  "scripts": {
    "prebuild": "rm -rf dist",
    "build": "tsc",
    "postbuild": "cp package.json dist/"
  }
}
```

æ‰§è¡Œ `npm run build` æ—¶ï¼Œä¼šä¾æ¬¡è¿è¡Œ `prebuild` â†’ `build` â†’ `postbuild`ã€‚

### ä¼ é€’å‚æ•°

å‘è„šæœ¬ä¼ é€’å‚æ•°ä½¿ç”¨ `--`ï¼š

```bash
$ npm run test -- --watch --coverage
```

## package-lock.json

`package-lock.json` è®°å½•ä¾èµ–æ ‘çš„ç²¾ç¡®ç‰ˆæœ¬ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜å’Œ CI ç¯å¢ƒå®‰è£…ä¸€è‡´çš„ä¾èµ–ã€‚

ğŸ”¶ **ä¸è¦æ‰‹åŠ¨ç¼–è¾‘æ­¤æ–‡ä»¶**ï¼Œå®ƒç”± npm è‡ªåŠ¨ç»´æŠ¤ã€‚

è‹¥é‡åˆ°ä¾èµ–é—®é¢˜ï¼Œå¯å°è¯•åˆ é™¤åé‡æ–°å®‰è£…ï¼š

```bash
$ rm -rf node_modules package-lock.json
$ npm install
```

## npx æ‰§è¡Œå·¥å…·

npx æ˜¯ npm v5.2.0 å¼•å…¥çš„å‘½ä»¤æ‰§è¡Œå·¥å…·ï¼Œç”¨äºè¿è¡Œæœ¬åœ°æˆ–è¿œç¨‹çš„å¯æ‰§è¡ŒåŒ…ï¼š

```bash
# è¿è¡Œæœ¬åœ°å®‰è£…çš„å¯æ‰§è¡Œæ–‡ä»¶
$ npx eslint src

# ä¸´æ—¶ä¸‹è½½å¹¶æ‰§è¡Œï¼ˆä¸å®‰è£…åˆ°é¡¹ç›®ï¼‰
$ npx create-react-app my-app
$ npx degit user/repo my-project

# æŒ‡å®šåŒ…ç‰ˆæœ¬
$ npx typescript@5.0.0 --version
```

npx ä¼šä¼˜å…ˆæŸ¥æ‰¾ `node_modules/.bin`ï¼Œè‹¥æœ¬åœ°æ²¡æœ‰åˆ™ä¸´æ—¶ä¸‹è½½æ‰§è¡Œã€‚

## é…ç½®ç®¡ç†

### æŸ¥çœ‹ä¸è®¾ç½®é…ç½®

```bash
# æŸ¥çœ‹æ‰€æœ‰é…ç½®
$ npm config list

# æŸ¥çœ‹å•ä¸ªé…ç½®
$ npm config get registry

# è®¾ç½®é…ç½®
$ npm config set registry https://registry.npmmirror.com

# åˆ é™¤é…ç½®
$ npm config delete registry
```

### å¸¸ç”¨é…ç½®é¡¹

| é…ç½®é¡¹           | ç”¨é€”           | ç¤ºä¾‹å€¼                     |
| ---------------- | -------------- | -------------------------- |
| registry         | npm æºåœ°å€     | https://registry.npmjs.org |
| prefix           | å…¨å±€åŒ…å®‰è£…è·¯å¾„ | /usr/local                 |
| cache            | ç¼“å­˜ç›®å½•       | ~/.npm                     |
| init-author-name | é»˜è®¤ä½œè€…å     | Your Name                  |

### .npmrc æ–‡ä»¶

é…ç½®ä¹Ÿå¯å†™å…¥ `.npmrc` æ–‡ä»¶ï¼Œæ”¯æŒé¡¹ç›®çº§ã€ç”¨æˆ·çº§ã€å…¨å±€çº§ä¸‰ä¸ªå±‚çº§ï¼š

```bash
# é¡¹ç›®çº§ .npmrcï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
registry=https://registry.npmmirror.com

# ç”¨æˆ·çº§ ~/.npmrc
//registry.npmjs.org/:_authToken=npm_xxxx

# å…¨å±€çº§ /etc/npmrc
prefix=/usr/local
```

é¡¹ç›®çº§é…ç½®ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¾¿äºå›¢é˜Ÿç»Ÿä¸€é…ç½®ã€‚

## å‘å¸ƒåŒ…

### æ³¨å†Œä¸ç™»å½•

```bash
# æ³¨å†Œè´¦å·ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
$ npm adduser

# ç™»å½•
$ npm login

# æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·
$ npm whoami
```

### å‘å¸ƒæµç¨‹

```bash
# 1. ç¡®ä¿ package.json é…ç½®æ­£ç¡®
# nameã€versionã€main/exportsã€files ç­‰å­—æ®µ

# 2. å‘å¸ƒ
$ npm publish

# å‘å¸ƒ scoped åŒ…ä¸ºå…¬å¼€
$ npm publish --access public
```

### ç‰ˆæœ¬ç®¡ç†

```bash
# å‡çº§è¡¥ä¸ç‰ˆæœ¬ 1.0.0 â†’ 1.0.1
$ npm version patch

# å‡çº§æ¬¡ç‰ˆæœ¬ 1.0.1 â†’ 1.1.0
$ npm version minor

# å‡çº§ä¸»ç‰ˆæœ¬ 1.1.0 â†’ 2.0.0
$ npm version major

# è‡ªå®šä¹‰ç‰ˆæœ¬
$ npm version 2.0.0-beta.1
```

`npm version` ä¼šè‡ªåŠ¨æ›´æ–° `package.json` å’Œ `package-lock.json`ï¼Œå¹¶åˆ›å»º git tagã€‚

### åºŸå¼ƒä¸åˆ é™¤

```bash
# åºŸå¼ƒæŒ‡å®šç‰ˆæœ¬ï¼ˆä¸æ¨èä½¿ç”¨ï¼Œä½†ä»å¯å®‰è£…ï¼‰
$ npm deprecate my-package@1.0.0 "æ­¤ç‰ˆæœ¬å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œè¯·å‡çº§"

# å–æ¶ˆå‘å¸ƒï¼ˆ72å°æ—¶å†…å¯æ“ä½œï¼‰
$ npm unpublish my-package@1.0.0

# å–æ¶ˆå‘å¸ƒæ•´ä¸ªåŒ…
$ npm unpublish my-package --force
```

## ç§æœ‰åŒ…ä¸ Scope

npm æ”¯æŒ scoped åŒ…ï¼Œæ ¼å¼ä¸º `@scope/package-name`ï¼š

```bash
# å®‰è£… scoped åŒ…
$ npm install @babel/core

# åˆ›å»º scoped é¡¹ç›®
$ npm init --scope=myorg
```

ç»„ç»‡çº§ç§æœ‰åŒ…éœ€è¦ä»˜è´¹è®¢é˜… npm Pro æˆ–ä½¿ç”¨ç§æœ‰ registryï¼ˆå¦‚ Verdaccioã€Nexusï¼‰ã€‚

## å®‰å…¨ä¸å®¡è®¡

ğŸ”¶ å®šæœŸæ£€æŸ¥é¡¹ç›®ä¾èµ–çš„å®‰å…¨æ¼æ´ï¼š

```bash
# æ£€æŸ¥å·²çŸ¥æ¼æ´
$ npm audit

# è‡ªåŠ¨ä¿®å¤å¯ä¿®å¤çš„æ¼æ´
$ npm audit fix

# å¼ºåˆ¶ä¿®å¤ï¼ˆå¯èƒ½å¼•å…¥ç ´åæ€§æ›´æ–°ï¼‰
$ npm audit fix --force

# ä»…æ˜¾ç¤ºé«˜å±åŠä»¥ä¸Šæ¼æ´
$ npm audit --audit-level=high
```

## ç¼“å­˜ç®¡ç†

```bash
# æŸ¥çœ‹ç¼“å­˜ç›®å½•
$ npm config get cache

# æ¸…ç†ç¼“å­˜
$ npm cache clean --force

# éªŒè¯ç¼“å­˜å®Œæ•´æ€§
$ npm cache verify
```

## Workspacesï¼ˆMonorepo æ”¯æŒï¼‰

npm v7+ åŸç”Ÿæ”¯æŒ workspacesï¼Œé€‚ç”¨äº monorepo é¡¹ç›®ï¼š

```json
{
  "name": "my-monorepo",
  "workspaces": ["packages/*"]
}
```

```bash
# åœ¨æ ¹ç›®å½•å®‰è£…æ‰€æœ‰ workspace ä¾èµ–
$ npm install

# åœ¨æŒ‡å®š workspace æ‰§è¡Œå‘½ä»¤
$ npm run build -w packages/core

# åœ¨æ‰€æœ‰ workspace æ‰§è¡Œå‘½ä»¤
$ npm run build --workspaces
```

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

| å‘½ä»¤                      | ç”¨é€”           |
| ------------------------- | -------------- |
| `npm init -y`             | å¿«é€Ÿåˆå§‹åŒ–é¡¹ç›® |
| `npm install`             | å®‰è£…æ‰€æœ‰ä¾èµ–   |
| `npm install <pkg>`       | å®‰è£…ç”Ÿäº§ä¾èµ–   |
| `npm install -D <pkg>`    | å®‰è£…å¼€å‘ä¾èµ–   |
| `npm install -g <pkg>`    | å…¨å±€å®‰è£…       |
| `npm uninstall <pkg>`     | å¸è½½åŒ…         |
| `npm update`              | æ›´æ–°ä¾èµ–       |
| `npm outdated`            | æ£€æŸ¥è¿‡æ—¶åŒ…     |
| `npm run <script>`        | è¿è¡Œè„šæœ¬       |
| `npm publish`             | å‘å¸ƒåŒ…         |
| `npm version <type>`      | å‡çº§ç‰ˆæœ¬       |
| `npm audit`               | å®‰å…¨å®¡è®¡       |
| `npm cache clean --force` | æ¸…ç†ç¼“å­˜       |

## å‚è€ƒèµ„æ–™

- [npm å®˜æ–¹æ–‡æ¡£](https://docs.npmjs.com/)
- [npm CLI å‘½ä»¤å‚è€ƒ](https://docs.npmjs.com/cli/v10/commands)
- [SemVer è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)
- [package.json å­—æ®µè¯´æ˜](https://docs.npmjs.com/cli/v10/configuring-npm/package-json)
