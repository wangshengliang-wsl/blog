---
title: ARIA 基础
description: 学习 WAI-ARIA 的基础知识，了解 role、aria-* 属性的使用方法，让网页对辅助技术更友好
pubDate: 2025-11-28
toc: true
ogImage: true
category: HTML
---

ARIA（Accessible Rich Internet Applications）是一套属性，用于增强 HTML 的无障碍性。当原生 HTML 语义不足时，ARIA 可以帮助辅助技术（如屏幕阅读器）更好地理解页面。

## 什么是 ARIA

ARIA 全称是 WAI-ARIA（Web Accessibility Initiative - Accessible Rich Internet Applications），由 W3C 制定。它提供了一组属性，让开发者可以向辅助技术描述：

- 元素是什么（role）
- 元素的状态和属性（aria-\*）
- 元素之间的关系

### ARIA 的基本原则

**第一原则**：如果能用原生 HTML 实现，就不要用 ARIA。

```html
<!-- 不好：用 ARIA 给 div 添加按钮语义 -->
<div role="button" tabindex="0" onclick="submit()">提交</div>

<!-- 好：直接用 button -->
<button onclick="submit()">提交</button>
```

原生 HTML 元素自带：

- 正确的语义
- 键盘交互
- 焦点管理
- 默认样式

ARIA 只是**补充**，不能替代正确的 HTML。

## role 属性

`role` 属性定义元素的角色（是什么）。

### 地标角色（Landmark Roles）

用于定义页面的主要区域：

```html
<div role="banner">页头（等同于 header）</div>
<div role="navigation">导航（等同于 nav）</div>
<div role="main">主内容（等同于 main）</div>
<div role="complementary">侧边内容（等同于 aside）</div>
<div role="contentinfo">页脚（等同于 footer）</div>
<div role="search">搜索区域</div>
<div role="form">表单区域</div>
```

如果已经用了语义标签，不需要再添加 role：

```html
<!-- 冗余：header 已经有 banner 语义 -->
<header role="banner">...</header>

<!-- 正确：直接用 header -->
<header>...</header>
```

### 组件角色（Widget Roles）

用于自定义交互组件：

```html
<div role="button">按钮</div>
<div role="checkbox">复选框</div>
<div role="dialog">对话框</div>
<div role="tab">标签页</div>
<div role="tabpanel">标签面板</div>
<div role="menu">菜单</div>
<div role="menuitem">菜单项</div>
<div role="progressbar">进度条</div>
<div role="slider">滑块</div>
<div role="tooltip">提示</div>
<div role="alert">警告</div>
```

### 文档结构角色

```html
<div role="article">文章</div>
<div role="heading" aria-level="2">标题</div>
<div role="list">列表</div>
<div role="listitem">列表项</div>
<div role="table">表格</div>
<div role="row">行</div>
<div role="cell">单元格</div>
```

### 实时区域角色

用于动态更新的内容：

```html
<div role="alert">警告消息</div>
<div role="status">状态消息</div>
<div role="log">日志</div>
<div role="timer">计时器</div>
```

## aria-\* 属性

aria-\* 属性描述元素的状态和属性。

### 状态属性

```html
<!-- 展开/收起 -->
<button aria-expanded="false">展开</button>
<div hidden>内容</div>

<!-- 选中状态 -->
<div role="checkbox" aria-checked="true">已选中</div>
<div role="checkbox" aria-checked="false">未选中</div>
<div role="checkbox" aria-checked="mixed">部分选中</div>

<!-- 禁用状态 -->
<button aria-disabled="true">禁用的按钮</button>

<!-- 按下状态 -->
<button aria-pressed="true">已按下</button>

<!-- 隐藏状态 -->
<div aria-hidden="true">对辅助技术隐藏</div>

<!-- 当前状态 -->
<a href="/" aria-current="page">首页</a>

<!-- 忙碌状态 -->
<div aria-busy="true">加载中...</div>
```

### 属性（Properties）

```html
<!-- 标签 -->
<button aria-label="关闭">×</button>
<input aria-label="搜索" type="search" />

<!-- 描述 -->
<button aria-describedby="help-text">提交</button>
<p id="help-text">点击提交表单</p>

<!-- 标签引用 -->
<div aria-labelledby="title">
  <h2 id="title">标题</h2>
  <p>内容...</p>
</div>

<!-- 必填 -->
<input aria-required="true" />

<!-- 无效 -->
<input aria-invalid="true" />

<!-- 控制关系 -->
<button aria-controls="panel">切换面板</button>
<div id="panel">面板内容</div>

<!-- 拥有关系 -->
<div aria-owns="external-content">...</div>

<!-- 流程关系 -->
<div aria-flowto="next-section">...</div>
```

### 值属性

```html
<!-- 当前值 -->
<div role="slider" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">
  50%
</div>

<!-- 文本值 -->
<div role="slider" aria-valuetext="中等">...</div>

<!-- 级别 -->
<div role="heading" aria-level="3">三级标题</div>

<!-- 排序 -->
<th aria-sort="ascending">名称</th>

<!-- 位置 -->
<li aria-posinset="3" aria-setsize="10">第3项/共10项</li>
```

### 实时区域属性

```html
<!-- 实时更新区域 -->
<div aria-live="polite">内容更新时会通知用户</div>
<div aria-live="assertive">紧急消息，立即通知</div>
<div aria-live="off">不通知</div>

<!-- 原子更新 -->
<div aria-live="polite" aria-atomic="true">整个区域作为一个整体更新</div>

<!-- 相关更新 -->
<div aria-live="polite" aria-relevant="additions text">
  只通知添加和文本变化
</div>
```

## 常见 ARIA 模式

### 自定义按钮

```html
<div
  role="button"
  tabindex="0"
  onclick="handleClick()"
  onkeydown="handleKeyDown(event)"
>
  自定义按钮
</div>

<script>
  function handleKeyDown(event) {
    if (event.key === 'Enter' || event.key === ' ') {
      event.preventDefault()
      handleClick()
    }
  }

  function handleClick() {
    console.log('按钮被点击')
  }
</script>
```

**但是**，直接用 `<button>` 更好，它自带这些功能。

### 展开/收起

```html
<button aria-expanded="false" aria-controls="content">展开详情</button>
<div id="content" hidden>详细内容...</div>

<script>
  const button = document.querySelector('button')
  const content = document.getElementById('content')

  button.addEventListener('click', () => {
    const isExpanded = button.getAttribute('aria-expanded') === 'true'
    button.setAttribute('aria-expanded', !isExpanded)
    content.hidden = isExpanded
    button.textContent = isExpanded ? '展开详情' : '收起详情'
  })
</script>
```

### 标签页

```html
<div role="tablist" aria-label="示例标签页">
  <button role="tab" id="tab1" aria-selected="true" aria-controls="panel1">
    标签1
  </button>
  <button
    role="tab"
    id="tab2"
    aria-selected="false"
    aria-controls="panel2"
    tabindex="-1"
  >
    标签2
  </button>
</div>

<div role="tabpanel" id="panel1" aria-labelledby="tab1">面板1内容</div>

<div role="tabpanel" id="panel2" aria-labelledby="tab2" hidden>面板2内容</div>
```

### 模态对话框

```html
<div
  role="dialog"
  aria-labelledby="dialog-title"
  aria-describedby="dialog-desc"
  aria-modal="true"
>
  <h2 id="dialog-title">对话框标题</h2>
  <p id="dialog-desc">对话框描述文字</p>

  <button>确定</button>
  <button>取消</button>
</div>

<script>
  // 打开对话框时
  function openDialog() {
    const dialog = document.querySelector('[role="dialog"]')
    dialog.hidden = false

    // 保存之前的焦点
    const previousFocus = document.activeElement

    // 聚焦到对话框
    dialog.querySelector('button').focus()

    // 关闭时恢复焦点
    dialog.addEventListener('close', () => {
      previousFocus.focus()
    })
  }
</script>
```

### 下拉菜单

```html
<div class="dropdown">
  <button
    aria-haspopup="true"
    aria-expanded="false"
    aria-controls="dropdown-menu"
  >
    菜单
  </button>

  <ul id="dropdown-menu" role="menu" hidden>
    <li role="menuitem"><a href="#">选项1</a></li>
    <li role="menuitem"><a href="#">选项2</a></li>
    <li role="menuitem"><a href="#">选项3</a></li>
  </ul>
</div>
```

### 进度条

```html
<div
  role="progressbar"
  aria-valuenow="75"
  aria-valuemin="0"
  aria-valuemax="100"
  aria-label="下载进度"
>
  <div style="width: 75%">75%</div>
</div>
```

### 警告消息

```html
<div role="alert">保存失败，请重试。</div>

<!-- 或者用实时区域 -->
<div aria-live="assertive">紧急消息</div>

<div aria-live="polite">普通通知</div>
```

## aria-label vs aria-labelledby vs aria-describedby

| 属性               | 用途                 | 示例                                   |
| ------------------ | -------------------- | -------------------------------------- |
| `aria-label`       | 直接提供标签文本     | `<button aria-label="关闭">×</button>` |
| `aria-labelledby`  | 引用其他元素作为标签 | `<div aria-labelledby="title">`        |
| `aria-describedby` | 引用其他元素作为描述 | `<input aria-describedby="help">`      |

```html
<!-- aria-label：直接写文本 -->
<button aria-label="关闭对话框">×</button>

<!-- aria-labelledby：引用其他元素的文本 -->
<h2 id="section-title">用户设置</h2>
<div aria-labelledby="section-title">设置内容...</div>

<!-- aria-describedby：引用额外说明 -->
<input type="password" aria-describedby="password-help" />
<p id="password-help">密码至少8位，包含大小写字母和数字</p>
```

### 优先级

如果同时存在多个标签来源，优先级为：

1. `aria-labelledby`
2. `aria-label`
3. 原生标签（如 `<label>`）
4. 元素内容

## aria-hidden

`aria-hidden` 让元素对辅助技术不可见：

```html
<!-- 对辅助技术隐藏 -->
<span aria-hidden="true">👍</span> 点赞

<!-- 装饰性图标 -->
<button>
  <span aria-hidden="true" class="icon-save"></span>
  保存
</button>
```

注意：

- `aria-hidden="true"` 不会从视觉上隐藏元素
- 不要在可聚焦元素上使用 `aria-hidden="true"`
- 模态对话框打开时，可以给背景内容添加 `aria-hidden="true"`

## 常见错误

### 1. 冗余的 ARIA

```html
<!-- 冗余：nav 已经有 navigation 语义 -->
<nav role="navigation">...</nav>

<!-- 冗余：button 已经有按钮语义 -->
<button role="button">提交</button>

<!-- 正确：直接使用原生标签 -->
<nav>...</nav>
<button>提交</button>
```

### 2. 错误的 role

```html
<!-- 错误：div 加了 button role 但没有键盘支持 -->
<div role="button" onclick="submit()">提交</div>

<!-- 正确：用原生 button 或完整实现 -->
<button onclick="submit()">提交</button>
```

### 3. 隐藏可聚焦元素

```html
<!-- 错误：按钮被隐藏但仍可聚焦 -->
<button aria-hidden="true">隐藏的按钮</button>

<!-- 正确：使用 hidden 或 display:none -->
<button hidden>隐藏的按钮</button>
```

### 4. aria-label 在非交互元素上

```html
<!-- 错误：div 不是交互元素 -->
<div aria-label="说明">内容</div>

<!-- 正确：用于交互元素 -->
<button aria-label="关闭">×</button>
```

## ARIA 测试

### 浏览器开发者工具

Chrome DevTools 的 Accessibility 面板可以查看元素的无障碍属性。

### 屏幕阅读器测试

- Windows：NVDA（免费）、JAWS
- Mac：VoiceOver（内置）
- 移动端：TalkBack（Android）、VoiceOver（iOS）

### 自动化测试

```javascript
// 使用 axe-core
import axe from 'axe-core'

axe.run(document, (err, results) => {
  console.log(results.violations)
})
```

## 小结

ARIA 是增强无障碍性的重要工具：

**核心概念**：

- `role`：定义元素是什么
- `aria-*`：定义元素的状态和属性

**使用原则**：

1. 优先使用原生 HTML
2. 不要改变原生语义
3. 所有交互元素必须键盘可访问
4. 不要在可聚焦元素上使用 aria-hidden

**常用属性**：

- `aria-label`/`aria-labelledby`：提供标签
- `aria-describedby`：提供描述
- `aria-expanded`：展开状态
- `aria-hidden`：隐藏状态
- `aria-live`：实时区域

下一篇会介绍更多无障碍实践技巧。
