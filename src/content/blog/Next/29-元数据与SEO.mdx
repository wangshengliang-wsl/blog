---
title: å…ƒæ•°æ®ä¸ SEO
description: æŒæ¡ Next.js Metadata APIï¼Œä¼˜åŒ–ç½‘ç«™çš„æœç´¢å¼•æ“è¡¨ç°å’Œç¤¾äº¤åˆ†äº«æ•ˆæœ
pubDate: 2025-12-03
toc: true
ogImage: true
category: Next
tags: ['Next.js', 'Metadata', 'SEO', 'Open Graph']
---

ğŸ™‹ ç½‘ç«™åœ¨æœç´¢ç»“æœä¸­è¡¨ç°ä¸ä½³ï¼Ÿæ­£ç¡®é…ç½®å…ƒæ•°æ®æ˜¯ SEO çš„åŸºç¡€ã€‚

## Metadata API æ¦‚è¿°

Next.js æä¾›ä¸¤ç§é…ç½®å…ƒæ•°æ®çš„æ–¹å¼ï¼š

| æ–¹å¼                  | é€‚ç”¨åœºæ™¯ |
| --------------------- | -------- |
| é™æ€ metadata å¯¹è±¡    | å›ºå®šå†…å®¹ |
| generateMetadata å‡½æ•° | åŠ¨æ€å†…å®¹ |

## é™æ€å…ƒæ•°æ®

### åŸºç¡€é…ç½®

```tsx
// app/layout.tsx
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'æˆ‘çš„ç½‘ç«™',
  description: 'è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Next.js æ„å»ºçš„ç½‘ç«™',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="zh-CN">
      <body>{children}</body>
    </html>
  )
}
```

### å®Œæ•´é…ç½®

```tsx
// app/layout.tsx
import type { Metadata } from 'next'

export const metadata: Metadata = {
  // åŸºç¡€
  title: {
    default: 'æˆ‘çš„ç½‘ç«™',
    template: '%s | æˆ‘çš„ç½‘ç«™', // å­é¡µé¢æ ‡é¢˜æ¨¡æ¿
  },
  description: 'ç½‘ç«™æè¿°ï¼Œç”¨äºæœç´¢ç»“æœå±•ç¤º',
  keywords: ['Next.js', 'React', 'JavaScript'],
  authors: [{ name: 'ä½œè€…å', url: 'https://example.com' }],
  creator: 'åˆ›å»ºè€…',
  publisher: 'å‘å¸ƒè€…',

  // å›¾æ ‡
  icons: {
    icon: '/favicon.ico',
    shortcut: '/favicon-16x16.png',
    apple: '/apple-touch-icon.png',
  },

  // æ¸…å•
  manifest: '/manifest.json',

  // Open Graph
  openGraph: {
    title: 'æˆ‘çš„ç½‘ç«™',
    description: 'ç½‘ç«™æè¿°',
    url: 'https://example.com',
    siteName: 'æˆ‘çš„ç½‘ç«™',
    images: [
      {
        url: 'https://example.com/og.jpg',
        width: 1200,
        height: 630,
        alt: 'ç½‘ç«™é¢„è§ˆå›¾',
      },
    ],
    locale: 'zh_CN',
    type: 'website',
  },

  // Twitter
  twitter: {
    card: 'summary_large_image',
    title: 'æˆ‘çš„ç½‘ç«™',
    description: 'ç½‘ç«™æè¿°',
    images: ['https://example.com/og.jpg'],
    creator: '@username',
  },

  // æœºå™¨äºº
  robots: {
    index: true,
    follow: true,
    googleBot: {
      'index': true,
      'follow': true,
      'max-video-preview': -1,
      'max-image-preview': 'large',
      'max-snippet': -1,
    },
  },

  // éªŒè¯
  verification: {
    google: 'google-site-verification-code',
    yandex: 'yandex-verification-code',
  },

  // å…¶ä»–
  alternates: {
    canonical: 'https://example.com',
    languages: {
      'en-US': 'https://example.com/en',
      'zh-CN': 'https://example.com/zh',
    },
  },
  category: 'æŠ€æœ¯',
}
```

### é¡µé¢çº§å…ƒæ•°æ®

```tsx
// app/about/page.tsx
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'å…³äºæˆ‘ä»¬', // ä½¿ç”¨æ¨¡æ¿ï¼šå…³äºæˆ‘ä»¬ | æˆ‘çš„ç½‘ç«™
  description: 'äº†è§£æ›´å¤šå…³äºæˆ‘ä»¬çš„ä¿¡æ¯',
}

export default function AboutPage() {
  return <div>å…³äºé¡µé¢</div>
}
```

## åŠ¨æ€å…ƒæ•°æ®

### generateMetadata å‡½æ•°

```tsx
// app/blog/[slug]/page.tsx
import type { Metadata } from 'next'

interface Props {
  params: Promise<{ slug: string }>
}

async function getPost(slug: string) {
  const res = await fetch(`https://api.example.com/posts/${slug}`)
  return res.json()
}

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { slug } = await params
  const post = await getPost(slug)

  return {
    title: post.title,
    description: post.excerpt,
    openGraph: {
      title: post.title,
      description: post.excerpt,
      images: [post.coverImage],
      type: 'article',
      publishedTime: post.publishedAt,
      authors: [post.author.name],
    },
  }
}

export default async function BlogPost({ params }: Props) {
  const { slug } = await params
  const post = await getPost(slug)

  return <article>{post.content}</article>
}
```

### è®¿é—®çˆ¶çº§å…ƒæ•°æ®

```tsx
export async function generateMetadata(
  { params }: Props,
  parent: ResolvingMetadata
): Promise<Metadata> {
  const { slug } = await params
  const post = await getPost(slug)

  // è·å–çˆ¶çº§å…ƒæ•°æ®
  const previousImages = (await parent).openGraph?.images || []

  return {
    title: post.title,
    openGraph: {
      images: [post.coverImage, ...previousImages],
    },
  }
}
```

## Open Graph ä¼˜åŒ–

### æ–‡ç« ç±»å‹

```tsx
// app/blog/[slug]/page.tsx
export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { slug } = await params
  const post = await getPost(slug)

  return {
    openGraph: {
      type: 'article',
      title: post.title,
      description: post.excerpt,
      url: `https://example.com/blog/${slug}`,
      images: [
        {
          url: post.coverImage,
          width: 1200,
          height: 630,
          alt: post.title,
        },
      ],
      publishedTime: post.publishedAt,
      modifiedTime: post.updatedAt,
      authors: [post.author.name],
      section: post.category,
      tags: post.tags,
    },
  }
}
```

### äº§å“ç±»å‹

```tsx
// app/products/[id]/page.tsx
export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { id } = await params
  const product = await getProduct(id)

  return {
    title: product.name,
    description: product.description,
    openGraph: {
      type: 'website',
      title: product.name,
      description: product.description,
      images: product.images.map((img) => ({
        url: img.url,
        width: 1200,
        height: 630,
        alt: img.alt,
      })),
    },
    other: {
      'product:price:amount': product.price.toString(),
      'product:price:currency': 'CNY',
    },
  }
}
```

## Twitter Cards

```tsx
export const metadata: Metadata = {
  twitter: {
    card: 'summary_large_image', // summary, summary_large_image, app, player
    site: '@site_username',
    creator: '@creator_username',
    title: 'æ ‡é¢˜',
    description: 'æè¿°',
    images: {
      url: 'https://example.com/og.jpg',
      alt: 'å›¾ç‰‡æè¿°',
    },
  },
}
```

## ç»“æ„åŒ–æ•°æ®

### JSON-LD

```tsx
// app/blog/[slug]/page.tsx
import Script from 'next/script'

export default async function BlogPost({ params }: Props) {
  const { slug } = await params
  const post = await getPost(slug)

  const jsonLd = {
    '@context': 'https://schema.org',
    '@type': 'BlogPosting',
    'headline': post.title,
    'description': post.excerpt,
    'image': post.coverImage,
    'datePublished': post.publishedAt,
    'dateModified': post.updatedAt,
    'author': {
      '@type': 'Person',
      'name': post.author.name,
      'url': post.author.url,
    },
    'publisher': {
      '@type': 'Organization',
      'name': 'æˆ‘çš„ç½‘ç«™',
      'logo': {
        '@type': 'ImageObject',
        'url': 'https://example.com/logo.png',
      },
    },
  }

  return (
    <>
      <Script
        id="json-ld"
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
      />
      <article>{post.content}</article>
    </>
  )
}
```

### ç»„ç»‡ç»“æ„åŒ–æ•°æ®

```tsx
// app/layout.tsx
import Script from 'next/script'

const organizationJsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  'name': 'å…¬å¸åç§°',
  'url': 'https://example.com',
  'logo': 'https://example.com/logo.png',
  'sameAs': ['https://twitter.com/company', 'https://github.com/company'],
  'contactPoint': {
    '@type': 'ContactPoint',
    'telephone': '+86-xxx-xxxx-xxxx',
    'contactType': 'customer service',
  },
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="zh-CN">
      <body>
        <Script
          id="organization-jsonld"
          type="application/ld+json"
          dangerouslySetInnerHTML={{
            __html: JSON.stringify(organizationJsonLd),
          }}
        />
        {children}
      </body>
    </html>
  )
}
```

## ç«™ç‚¹åœ°å›¾

### é™æ€ç«™ç‚¹åœ°å›¾

```tsx
// app/sitemap.ts
import type { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://example.com',
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    {
      url: 'https://example.com/about',
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.8,
    },
    {
      url: 'https://example.com/blog',
      lastModified: new Date(),
      changeFrequency: 'weekly',
      priority: 0.9,
    },
  ]
}
```

### åŠ¨æ€ç«™ç‚¹åœ°å›¾

```tsx
// app/sitemap.ts
import type { MetadataRoute } from 'next'

async function getPosts() {
  const res = await fetch('https://api.example.com/posts')
  return res.json()
}

export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  const posts = await getPosts()

  const blogUrls = posts.map((post: any) => ({
    url: `https://example.com/blog/${post.slug}`,
    lastModified: new Date(post.updatedAt),
    changeFrequency: 'weekly' as const,
    priority: 0.7,
  }))

  return [
    {
      url: 'https://example.com',
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    ...blogUrls,
  ]
}
```

### å¤šç«™ç‚¹åœ°å›¾

```tsx
// app/sitemap.ts
import type { MetadataRoute } from 'next'

export async function generateSitemaps() {
  // è¿”å›ç«™ç‚¹åœ°å›¾ç´¢å¼•
  return [{ id: 0 }, { id: 1 }, { id: 2 }]
}

export default async function sitemap({
  id,
}: {
  id: number
}): Promise<MetadataRoute.Sitemap> {
  const start = id * 50000
  const end = start + 50000

  const posts = await getPostsRange(start, end)

  return posts.map((post) => ({
    url: `https://example.com/blog/${post.slug}`,
    lastModified: post.updatedAt,
  }))
}
```

## robots.txt

```tsx
// app/robots.ts
import type { MetadataRoute } from 'next'

export default function robots(): MetadataRoute.Robots {
  return {
    rules: [
      {
        userAgent: '*',
        allow: '/',
        disallow: ['/api/', '/admin/', '/private/'],
      },
      {
        userAgent: 'Googlebot',
        allow: '/',
      },
    ],
    sitemap: 'https://example.com/sitemap.xml',
  }
}
```

## åŠ¨æ€ OG å›¾ç‰‡

### ä½¿ç”¨ ImageResponse

```tsx
// app/api/og/route.tsx
import { ImageResponse } from 'next/og'

export const runtime = 'edge'

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url)
  const title = searchParams.get('title') || 'é»˜è®¤æ ‡é¢˜'

  return new ImageResponse(
    (
      <div
        style={{
          height: '100%',
          width: '100%',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
          justifyContent: 'center',
          backgroundColor: '#fff',
          fontSize: 60,
          fontWeight: 700,
        }}
      >
        <div style={{ marginBottom: 40 }}>æˆ‘çš„ç½‘ç«™</div>
        <div style={{ fontSize: 40, color: '#666' }}>{title}</div>
      </div>
    ),
    {
      width: 1200,
      height: 630,
    }
  )
}
```

### åœ¨å…ƒæ•°æ®ä¸­ä½¿ç”¨

```tsx
// app/blog/[slug]/page.tsx
export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { slug } = await params
  const post = await getPost(slug)

  return {
    title: post.title,
    openGraph: {
      images: [
        {
          url: `/api/og?title=${encodeURIComponent(post.title)}`,
          width: 1200,
          height: 630,
        },
      ],
    },
  }
}
```

### è‡ªå®šä¹‰å­—ä½“

```tsx
// app/api/og/route.tsx
import { ImageResponse } from 'next/og'

export const runtime = 'edge'

export async function GET(request: Request) {
  const font = await fetch(
    new URL('../../assets/fonts/NotoSansSC-Bold.ttf', import.meta.url)
  ).then((res) => res.arrayBuffer())

  return new ImageResponse(
    (
      <div
        style={{
          fontFamily: 'Noto Sans SC',
          // ...
        }}
      >
        ä¸­æ–‡æ ‡é¢˜
      </div>
    ),
    {
      width: 1200,
      height: 630,
      fonts: [
        {
          name: 'Noto Sans SC',
          data: font,
          style: 'normal',
          weight: 700,
        },
      ],
    }
  )
}
```

## SEO æœ€ä½³å®è·µ

### è¯­ä¹‰åŒ– HTML

```tsx
export default function BlogPost({ post }: { post: Post }) {
  return (
    <article>
      <header>
        <h1>{post.title}</h1>
        <time dateTime={post.publishedAt}>{formatDate(post.publishedAt)}</time>
      </header>

      <main>{post.content}</main>

      <footer>
        <address>
          ä½œè€…ï¼š
          <a rel="author" href={post.author.url}>
            {post.author.name}
          </a>
        </address>
      </footer>
    </article>
  )
}
```

### é¢åŒ…å±‘å¯¼èˆª

```tsx
// components/Breadcrumb.tsx
import Link from 'next/link'
import Script from 'next/script'

interface BreadcrumbItem {
  name: string
  href: string
}

export function Breadcrumb({ items }: { items: BreadcrumbItem[] }) {
  const jsonLd = {
    '@context': 'https://schema.org',
    '@type': 'BreadcrumbList',
    'itemListElement': items.map((item, index) => ({
      '@type': 'ListItem',
      'position': index + 1,
      'name': item.name,
      'item': `https://example.com${item.href}`,
    })),
  }

  return (
    <>
      <Script
        id="breadcrumb-jsonld"
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
      />
      <nav aria-label="é¢åŒ…å±‘">
        <ol className="flex gap-2">
          {items.map((item, index) => (
            <li key={item.href} className="flex items-center gap-2">
              {index > 0 && <span>/</span>}
              <Link href={item.href}>{item.name}</Link>
            </li>
          ))}
        </ol>
      </nav>
    </>
  )
}
```

## å¸¸è§é—®é¢˜

ğŸ¤” **Q: å¦‚ä½•é¿å…é‡å¤çš„å…ƒæ•°æ®ï¼Ÿ**

ä½¿ç”¨ `title.template` å’Œå¸ƒå±€å±‚çº§ï¼š

```tsx
// app/layout.tsx
export const metadata: Metadata = {
  title: {
    template: '%s | æˆ‘çš„ç½‘ç«™',
    default: 'æˆ‘çš„ç½‘ç«™',
  },
}

// app/blog/page.tsx
export const metadata: Metadata = {
  title: 'åšå®¢', // è¾“å‡ºï¼šåšå®¢ | æˆ‘çš„ç½‘ç«™
}
```

ğŸ¤” **Q: åŠ¨æ€å…ƒæ•°æ®è¯·æ±‚ä¼šé‡å¤å—ï¼Ÿ**

ä¸ä¼šã€‚Next.js è‡ªåŠ¨å»é‡ç›¸åŒçš„ fetch è¯·æ±‚ã€‚

ğŸ¤” **Q: å¦‚ä½•éªŒè¯å…ƒæ•°æ®ï¼Ÿ**

ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼š

- Google Rich Results Test
- Facebook Sharing Debugger
- Twitter Card Validator

---

ä¸‹ä¸€ç¯‡å°†ä»‹ç»æ€§èƒ½åˆ†æï¼Œå­¦ä¹ å¦‚ä½•åˆ†æå’Œä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚

-EOF-
