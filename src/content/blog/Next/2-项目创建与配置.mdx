---
title: é¡¹ç›®åˆ›å»ºä¸é…ç½®
description: ä½¿ç”¨ create-next-app åˆ›å»º Next.js 15 é¡¹ç›®ï¼Œè¯¦è§£ç›®å½•ç»“æ„ä¸ next.config.js æ ¸å¿ƒé…ç½®é¡¹
pubDate: 2025-12-03
toc: true
ogImage: true
category: Next
tags: ['Next.js', 'é…ç½®', 'é¡¹ç›®ç»“æ„', 'next.config.js']
---

ğŸ™‹ åˆ›å»ºä¸€ä¸ª Next.js é¡¹ç›®æœ‰å¤šç®€å•ï¼Ÿä¸€è¡Œå‘½ä»¤ã€‚ä½†ç†è§£é¡¹ç›®ç»“æ„å’Œé…ç½®é¡¹ï¼Œæ‰èƒ½åœ¨å¼€å‘ä¸­æ¸¸åˆƒæœ‰ä½™ã€‚

## åˆ›å»ºé¡¹ç›®

### ä½¿ç”¨ create-next-appï¼ˆæ¨èï¼‰

```bash
# ç¯å¢ƒè¦æ±‚ï¼šNode.js 20+, pnpm 9+
# Next.js 15.x

# äº¤äº’å¼åˆ›å»º
pnpm create next-app@latest

# æˆ–ä¸€é”®åˆ›å»ºï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰
pnpm create next-app@latest my-app --yes
```

äº¤äº’å¼åˆ›å»ºä¼šè¯¢é—®ä»¥ä¸‹é€‰é¡¹ï¼š

```
âœ” What is your project named? my-app
âœ” Would you like to use TypeScript? Yes
âœ” Would you like to use ESLint? Yes
âœ” Would you like to use Tailwind CSS? Yes
âœ” Would you like your code inside a `src/` directory? Yes
âœ” Would you like to use App Router? (recommended) Yes
âœ” Would you like to use Turbopack for `next dev`? Yes
âœ” Would you like to customize the import alias (@/* by default)? No
```

ğŸ¯ **æ¨èé…ç½®**ï¼šTypeScript + ESLint + Tailwind + src ç›®å½• + App Router

### æ‰‹åŠ¨å®‰è£…

å¦‚æœéœ€è¦é›†æˆåˆ°ç°æœ‰é¡¹ç›®ï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…ï¼š

```bash
# å®‰è£…ä¾èµ–
pnpm add next@latest react@latest react-dom@latest

# å®‰è£…å¼€å‘ä¾èµ–
pnpm add -D typescript @types/node @types/react @types/react-dom
```

åˆ›å»º `package.json` è„šæœ¬ï¼š

```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix"
  }
}
```

## ç›®å½•ç»“æ„

ä½¿ç”¨ `src/` ç›®å½•çš„æ ‡å‡†é¡¹ç›®ç»“æ„ï¼š

```
my-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                 # App Router è·¯ç”±ç›®å½•
â”‚   â”‚   â”œâ”€â”€ layout.tsx       # æ ¹å¸ƒå±€ï¼ˆå¿…éœ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ page.tsx         # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ globals.css      # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ favicon.ico      # ç½‘ç«™å›¾æ ‡
â”‚   â”œâ”€â”€ components/          # å…±äº«ç»„ä»¶
â”‚   â””â”€â”€ lib/                 # å·¥å…·å‡½æ•°
â”œâ”€â”€ public/                  # é™æ€èµ„æºï¼ˆç›´æ¥è®¿é—®ï¼‰
â”œâ”€â”€ next.config.ts           # Next.js é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ tailwind.config.ts       # Tailwind é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ .env.local               # ç¯å¢ƒå˜é‡
```

### æ ¸å¿ƒç›®å½•è¯´æ˜

| ç›®å½•/æ–‡ä»¶        | ç”¨é€”                          |
| ---------------- | ----------------------------- |
| `src/app/`       | App Router è·¯ç”±ï¼Œæ–‡ä»¶å¤¹å³è·¯ç”± |
| `public/`        | é™æ€æ–‡ä»¶ï¼Œå¯é€šè¿‡ `/` ç›´æ¥è®¿é—® |
| `next.config.ts` | æ¡†æ¶é…ç½®ï¼Œè‡ªå®šä¹‰æ„å»ºè¡Œä¸º      |
| `.env.local`     | æœ¬åœ°ç¯å¢ƒå˜é‡ï¼Œä¸æäº¤åˆ° Git    |

### ç‰¹æ®Šæ–‡ä»¶çº¦å®š

App Router ä¸­çš„ç‰¹æ®Šæ–‡ä»¶ï¼š

```
app/
â”œâ”€â”€ layout.tsx      # å¸ƒå±€ç»„ä»¶ï¼ŒåŒ…è£¹å­è·¯ç”±
â”œâ”€â”€ page.tsx        # é¡µé¢ç»„ä»¶ï¼Œå®šä¹‰è·¯ç”±å†…å®¹
â”œâ”€â”€ loading.tsx     # åŠ è½½çŠ¶æ€ UI
â”œâ”€â”€ error.tsx       # é”™è¯¯è¾¹ç•Œ UI
â”œâ”€â”€ not-found.tsx   # 404 é¡µé¢
â”œâ”€â”€ route.ts        # API è·¯ç”±å¤„ç†
â””â”€â”€ template.tsx    # æ¨¡æ¿ç»„ä»¶ï¼ˆæ¯æ¬¡å¯¼èˆªé‡æ–°æŒ‚è½½ï¼‰
```

ğŸ”¶ **æ³¨æ„**ï¼š`layout.tsx` å’Œ `page.tsx` æ˜¯æœ€å¸¸ç”¨çš„ä¸¤ä¸ªæ–‡ä»¶ã€‚åªæœ‰æ·»åŠ äº† `page.tsx` çš„æ–‡ä»¶å¤¹æ‰ä¼šæˆä¸ºå¯è®¿é—®çš„è·¯ç”±ã€‚

## next.config.ts é…ç½®

Next.js 15 æ¨èä½¿ç”¨ TypeScript é…ç½®æ–‡ä»¶ï¼š

```typescript
// next.config.ts
// Next.js 15.x
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  // é…ç½®é¡¹
}

export default nextConfig
```

### å¸¸ç”¨é…ç½®é¡¹

#### 1. å›¾ç‰‡åŸŸåç™½åå•

```typescript
// next.config.ts
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'example.com',
        pathname: '/images/**',
      },
      {
        protocol: 'https',
        hostname: '*.amazonaws.com',
      },
    ],
  },
}

export default nextConfig
```

#### 2. ç¯å¢ƒå˜é‡

```typescript
// next.config.ts
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  env: {
    CUSTOM_KEY: 'custom-value',
  },
  // æš´éœ²ç»™å®¢æˆ·ç«¯çš„ç¯å¢ƒå˜é‡å¿…é¡»ä»¥ NEXT_PUBLIC_ å¼€å¤´
}

export default nextConfig
```

#### 3. é‡å®šå‘ä¸é‡å†™

```typescript
// next.config.ts
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  async redirects() {
    return [
      {
        source: '/old-page',
        destination: '/new-page',
        permanent: true, // 301 æ°¸ä¹…é‡å®šå‘
      },
    ]
  },

  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: 'https://api.example.com/:path*',
      },
    ]
  },
}

export default nextConfig
```

#### 4. è‡ªå®šä¹‰ Headers

```typescript
// next.config.ts
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  async headers() {
    return [
      {
        source: '/api/:path*',
        headers: [
          { key: 'Access-Control-Allow-Origin', value: '*' },
          { key: 'Access-Control-Allow-Methods', value: 'GET,POST,PUT,DELETE' },
        ],
      },
    ]
  },
}

export default nextConfig
```

### å®Œæ•´é…ç½®ç¤ºä¾‹

```typescript
// next.config.ts
// Next.js 15.x
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  // ä¸¥æ ¼æ¨¡å¼
  reactStrictMode: true,

  // å›¾ç‰‡ä¼˜åŒ–
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**.example.com',
      },
    ],
    formats: ['image/avif', 'image/webp'],
  },

  // å®éªŒæ€§åŠŸèƒ½
  experimental: {
    // React Compilerï¼ˆéœ€è¦é¢å¤–å®‰è£…ï¼‰
    // reactCompiler: true,
  },

  // Turbopack é…ç½®ï¼ˆå¼€å‘æ¨¡å¼é»˜è®¤å¯ç”¨ï¼‰
  turbopack: {
    // è‡ªå®šä¹‰è§„åˆ™
  },

  // è¾“å‡ºæ¨¡å¼
  // output: 'standalone', // ç”¨äº Docker éƒ¨ç½²

  // å‹ç¼©
  compress: true,

  // ç”Ÿäº§ç¯å¢ƒç§»é™¤ console
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
}

export default nextConfig
```

## ç¯å¢ƒå˜é‡

### æ–‡ä»¶ä¼˜å…ˆçº§

Next.js æŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½ç¯å¢ƒå˜é‡ï¼ˆåé¢è¦†ç›–å‰é¢ï¼‰ï¼š

1. `.env` - æ‰€æœ‰ç¯å¢ƒ
2. `.env.local` - æ‰€æœ‰ç¯å¢ƒï¼Œæœ¬åœ°è¦†ç›–
3. `.env.development` / `.env.production` - ç‰¹å®šç¯å¢ƒ
4. `.env.development.local` / `.env.production.local` - ç‰¹å®šç¯å¢ƒæœ¬åœ°è¦†ç›–

### å®¢æˆ·ç«¯è®¿é—®

```bash
# .env.local

# ä»…æœåŠ¡ç«¯å¯ç”¨
DATABASE_URL=postgresql://...
API_SECRET=xxx

# å®¢æˆ·ç«¯å¯ç”¨ï¼ˆå¿…é¡» NEXT_PUBLIC_ å‰ç¼€ï¼‰
NEXT_PUBLIC_API_URL=https://api.example.com
```

```tsx
// æœåŠ¡ç«¯ç»„ä»¶ä¸­ä½¿ç”¨
const dbUrl = process.env.DATABASE_URL

// å®¢æˆ·ç«¯ç»„ä»¶ä¸­ä½¿ç”¨
const apiUrl = process.env.NEXT_PUBLIC_API_URL
```

ğŸ”¶ **è­¦å‘Š**ï¼šä¸è¦å°†æ•æ„Ÿä¿¡æ¯æ”¾åœ¨ `NEXT_PUBLIC_` å˜é‡ä¸­ï¼Œå®ƒä»¬ä¼šè¢«æ‰“åŒ…åˆ°å®¢æˆ·ç«¯ä»£ç ã€‚

## TypeScript é…ç½®

`create-next-app` è‡ªåŠ¨ç”Ÿæˆçš„ `tsconfig.json`ï¼š

```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

ğŸ¯ **é‡ç‚¹é…ç½®**ï¼š

- `strict: true` - å¯ç”¨ä¸¥æ ¼ç±»å‹æ£€æŸ¥
- `paths` - é…ç½®è·¯å¾„åˆ«åï¼Œ`@/` æŒ‡å‘ `src/`

## å¯åŠ¨é¡¹ç›®

```bash
# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨ä½¿ç”¨ Turbopackï¼‰
pnpm dev

# ç”Ÿäº§æ„å»º
pnpm build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
pnpm start
```

è®¿é—® `http://localhost:3000` å³å¯çœ‹åˆ°é¡¹ç›®é¦–é¡µã€‚

## å¸¸è§é—®é¢˜

ğŸ¤” **Q: src ç›®å½•æ˜¯å¿…é¡»çš„å—ï¼Ÿ**

ä¸æ˜¯å¿…é¡»çš„ã€‚ä½ å¯ä»¥ç›´æ¥æŠŠ `app` ç›®å½•æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ã€‚ä½¿ç”¨ `src` çš„å¥½å¤„æ˜¯å°†åº”ç”¨ä»£ç ä¸é…ç½®æ–‡ä»¶åˆ†ç¦»ï¼Œç»“æ„æ›´æ¸…æ™°ã€‚

ğŸ¤” **Q: é…ç½®æ”¹äº†ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼Ÿ**

ä¿®æ”¹ `next.config.ts` åéœ€è¦é‡å¯å¼€å‘æœåŠ¡å™¨ã€‚ç¯å¢ƒå˜é‡çš„ä¿®æ”¹ä¹Ÿéœ€è¦é‡å¯ã€‚

ğŸ¤” **Q: å¦‚ä½•ç¦ç”¨ Turbopackï¼Ÿ**

```bash
# ä½¿ç”¨ Webpack
pnpm dev --webpack
```

---

ä¸‹ä¸€ç¯‡å°†è¯¦ç»†ä»‹ç» App Router çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…æ‹¬ä¸ Pages Router çš„åŒºåˆ«å’Œè¿ç§»ç­–ç•¥ã€‚

-EOF-
