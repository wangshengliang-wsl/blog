---
title: æ··åˆæ¸²æŸ“æ¨¡å¼
description: æŒæ¡ Server å’Œ Client Components çš„ç»„åˆç­–ç•¥ï¼Œæ„å»ºé«˜æ€§èƒ½ä¸”äº¤äº’ä¸°å¯Œçš„åº”ç”¨
pubDate: 2025-12-03
toc: true
ogImage: true
category: Next
tags: ['Next.js', 'æ··åˆæ¸²æŸ“', 'ç»„ä»¶è¾¹ç•Œ', 'æ€§èƒ½ä¼˜åŒ–']
---

ğŸ™‹ ä¸€ä¸ªé¡µé¢æ—¢éœ€è¦å¿«é€ŸåŠ è½½ï¼Œåˆéœ€è¦ä¸°å¯Œäº¤äº’ã€‚å¦‚ä½•åˆç†åˆ’åˆ† Server å’Œ Client ç»„ä»¶çš„è¾¹ç•Œï¼Ÿ

## ç»„ä»¶ç±»å‹å†³ç­–

### å†³ç­–æµç¨‹å›¾

```
éœ€è¦ useState/useEffectï¼Ÿâ”€â”€æ˜¯â”€â”€â†’ Client Component
         â”‚
         å¦
         â†“
éœ€è¦äº‹ä»¶å¤„ç†ï¼ˆonClick ç­‰ï¼‰ï¼Ÿâ”€â”€æ˜¯â”€â”€â†’ Client Component
         â”‚
         å¦
         â†“
éœ€è¦æµè§ˆå™¨ APIï¼Ÿâ”€â”€æ˜¯â”€â”€â†’ Client Component
         â”‚
         å¦
         â†“
ä½¿ç”¨ä»…å®¢æˆ·ç«¯åº“ï¼Ÿâ”€â”€æ˜¯â”€â”€â†’ Client Component
         â”‚
         å¦
         â†“
Server Component âœ…
```

### å¿«é€Ÿå‚è€ƒè¡¨

| åœºæ™¯         | Server | Client |
| ------------ | ------ | ------ |
| è·å–æ•°æ®     | âœ…     | å¯ä»¥   |
| è®¿é—®åç«¯èµ„æº | âœ…     | âŒ     |
| æ•æ„Ÿä¿¡æ¯     | âœ…     | âŒ     |
| ä½¿ç”¨ Hooks   | âŒ     | âœ…     |
| äº‹ä»¶ç›‘å¬     | âŒ     | âœ…     |
| æµè§ˆå™¨ API   | âŒ     | âœ…     |
| å‡å°‘ JS ä½“ç§¯ | âœ…     | âŒ     |

## ç»„ä»¶è¾¹ç•Œè®¾è®¡

### åŸåˆ™ï¼šå°† Client è¾¹ç•Œæ¨åˆ°å¶å­èŠ‚ç‚¹

```tsx
// âŒ ä¸å¥½ï¼šæ•´ä¸ªåˆ—è¡¨éƒ½æ˜¯ Client
'use client'

export default function ProductList({ products }) {
  const [favorites, setFavorites] = useState([])

  return (
    <ul>
      {products.map((product) => (
        <li key={product.id}>
          <h3>{product.name}</h3> {/* é™æ€å†…å®¹ */}
          <p>{product.description}</p> {/* é™æ€å†…å®¹ */}
          <button onClick={() => toggleFavorite(product.id)}>æ”¶è—</button>
        </li>
      ))}
    </ul>
  )
}
```

```tsx
// âœ… å¥½ï¼šåªæœ‰äº¤äº’éƒ¨åˆ†æ˜¯ Client

// app/products/page.tsx - Server Component
import { FavoriteButton } from '@/components/FavoriteButton'

async function getProducts() {
  return fetch('...').then((r) => r.json())
}

export default async function ProductList() {
  const products = await getProducts()

  return (
    <ul>
      {products.map((product) => (
        <li key={product.id}>
          <h3>{product.name}</h3> {/* Server */}
          <p>{product.description}</p> {/* Server */}
          <FavoriteButton productId={product.id} /> {/* Client */}
        </li>
      ))}
    </ul>
  )
}
```

```tsx
// components/FavoriteButton.tsx - Client Component
'use client'

import { useState } from 'react'

export function FavoriteButton({ productId }: { productId: string }) {
  const [isFavorite, setIsFavorite] = useState(false)

  return (
    <button onClick={() => setIsFavorite(!isFavorite)}>
      {isFavorite ? 'â¤ï¸' : 'ğŸ¤'}
    </button>
  )
}
```

### ç»„åˆæ¨¡å¼

#### 1. Wrapper æ¨¡å¼

Client åŒ…è£¹ Serverï¼ˆé€šè¿‡ childrenï¼‰ï¼š

```tsx
// components/Accordion.tsx - Client Component
'use client'

import { useState, ReactNode } from 'react'

interface AccordionProps {
  title: string
  children: ReactNode
}

export function Accordion({ title, children }: AccordionProps) {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <div className="border rounded">
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="w-full p-4 text-left font-bold"
      >
        {title} {isOpen ? 'â–¼' : 'â–¶'}
      </button>
      {isOpen && <div className="p-4 border-t">{children}</div>}
    </div>
  )
}
```

```tsx
// app/faq/page.tsx - Server Component
import { Accordion } from '@/components/Accordion'

async function getFAQs() {
  return fetch('...').then((r) => r.json())
}

export default async function FAQPage() {
  const faqs = await getFAQs()

  return (
    <div className="space-y-4">
      {faqs.map((faq) => (
        <Accordion key={faq.id} title={faq.question}>
          {/* Server Component ä½œä¸º children */}
          <FAQContent content={faq.answer} />
        </Accordion>
      ))}
    </div>
  )
}

// Server Component
function FAQContent({ content }: { content: string }) {
  return <div dangerouslySetInnerHTML={{ __html: content }} />
}
```

#### 2. Slots æ¨¡å¼

å¤šä¸ª Server ç»„ä»¶ä½œä¸ºä¸åŒ propsï¼š

```tsx
// components/Modal.tsx - Client Component
'use client'

import { useState, ReactNode } from 'react'

interface ModalProps {
  trigger: ReactNode
  header: ReactNode
  content: ReactNode
  footer: ReactNode
}

export function Modal({ trigger, header, content, footer }: ModalProps) {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <>
      <div onClick={() => setIsOpen(true)}>{trigger}</div>
      {isOpen && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center">
          <div className="bg-white rounded-lg max-w-md w-full">
            <div className="p-4 border-b">{header}</div>
            <div className="p-4">{content}</div>
            <div className="p-4 border-t flex justify-end gap-2">
              {footer}
              <button onClick={() => setIsOpen(false)}>å…³é—­</button>
            </div>
          </div>
        </div>
      )}
    </>
  )
}
```

```tsx
// app/page.tsx - Server Component
import { Modal } from '@/components/Modal'

export default function Page() {
  return (
    <Modal
      trigger={<button>æ‰“å¼€è¯¦æƒ…</button>}
      header={<ProductHeader />}   {/* Server */}
      content={<ProductDetails />} {/* Server */}
      footer={<ProductActions />}  {/* Server */}
    />
  )
}
```

## å®æˆ˜æ¡ˆä¾‹

### ç”µå•†äº§å“é¡µ

```
app/products/[id]/page.tsx (Server)
â”œâ”€â”€ ProductImages (Server) - å›¾ç‰‡å±•ç¤º
â”œâ”€â”€ ProductInfo (Server) - åŸºæœ¬ä¿¡æ¯
â”œâ”€â”€ PriceDisplay (Server) - ä»·æ ¼å±•ç¤º
â”œâ”€â”€ AddToCartButton (Client) - åŠ è´­æŒ‰é’®
â”œâ”€â”€ QuantitySelector (Client) - æ•°é‡é€‰æ‹©
â”œâ”€â”€ ProductTabs (Client) - æ ‡ç­¾åˆ‡æ¢å®¹å™¨
â”‚   â”œâ”€â”€ Description (Server) - å•†å“æè¿°
â”‚   â”œâ”€â”€ Specifications (Server) - è§„æ ¼å‚æ•°
â”‚   â””â”€â”€ Reviews (Server) - è¯„ä»·åˆ—è¡¨
â””â”€â”€ SimilarProducts (Server) - ç›¸ä¼¼æ¨è
```

```tsx
// app/products/[id]/page.tsx
// Next.js 15.x
import { AddToCartButton } from '@/components/AddToCartButton'
import { QuantitySelector } from '@/components/QuantitySelector'
import { ProductTabs } from '@/components/ProductTabs'

async function getProduct(id: string) {
  return fetch(`https://api.example.com/products/${id}`).then((r) => r.json())
}

export default async function ProductPage({
  params,
}: {
  params: Promise<{ id: string }>
}) {
  const { id } = await params
  const product = await getProduct(id)

  return (
    <div className="grid grid-cols-2 gap-8">
      {/* Server: å›¾ç‰‡ */}
      <div className="space-y-4">
        <img src={product.image} alt={product.name} className="w-full" />
      </div>

      {/* äº§å“ä¿¡æ¯ */}
      <div className="space-y-4">
        {/* Server: åŸºæœ¬ä¿¡æ¯ */}
        <h1 className="text-2xl font-bold">{product.name}</h1>
        <p className="text-3xl text-red-600">Â¥{product.price}</p>
        <p className="text-gray-600">{product.summary}</p>

        {/* Client: äº¤äº’ç»„ä»¶ */}
        <div className="flex gap-4 items-center">
          <QuantitySelector />
          <AddToCartButton productId={id} />
        </div>
      </div>

      {/* Client + Server: æ ‡ç­¾é¡µ */}
      <div className="col-span-2">
        <ProductTabs
          description={<Description content={product.description} />}
          specs={<Specifications data={product.specs} />}
          reviews={<Reviews productId={id} />}
        />
      </div>
    </div>
  )
}

// Server Components
function Description({ content }: { content: string }) {
  return <div dangerouslySetInnerHTML={{ __html: content }} />
}

async function Specifications({ data }: { data: Record<string, string> }) {
  return (
    <table className="w-full">
      <tbody>
        {Object.entries(data).map(([key, value]) => (
          <tr key={key} className="border-b">
            <td className="py-2 font-medium">{key}</td>
            <td className="py-2">{value}</td>
          </tr>
        ))}
      </tbody>
    </table>
  )
}

async function Reviews({ productId }: { productId: string }) {
  const reviews = await fetch(
    `https://api.example.com/products/${productId}/reviews`
  ).then((r) => r.json())

  return (
    <ul className="space-y-4">
      {reviews.map((review: any) => (
        <li key={review.id} className="border-b pb-4">
          <div className="flex gap-2 items-center">
            <span className="font-medium">{review.author}</span>
            <span className="text-yellow-500">{'â˜…'.repeat(review.rating)}</span>
          </div>
          <p className="mt-2">{review.content}</p>
        </li>
      ))}
    </ul>
  )
}
```

```tsx
// components/ProductTabs.tsx - Client Component
'use client'

import { useState, ReactNode } from 'react'

interface Props {
  description: ReactNode
  specs: ReactNode
  reviews: ReactNode
}

export function ProductTabs({ description, specs, reviews }: Props) {
  const [activeTab, setActiveTab] = useState<'desc' | 'specs' | 'reviews'>(
    'desc'
  )

  const tabs = [
    { key: 'desc', label: 'å•†å“è¯¦æƒ…', content: description },
    { key: 'specs', label: 'è§„æ ¼å‚æ•°', content: specs },
    { key: 'reviews', label: 'ç”¨æˆ·è¯„ä»·', content: reviews },
  ] as const

  return (
    <div>
      <div className="flex border-b">
        {tabs.map((tab) => (
          <button
            key={tab.key}
            onClick={() => setActiveTab(tab.key)}
            className={`px-4 py-2 ${
              activeTab === tab.key ? 'border-b-2 border-blue-600' : ''
            }`}
          >
            {tab.label}
          </button>
        ))}
      </div>
      <div className="py-4">
        {tabs.find((t) => t.key === activeTab)?.content}
      </div>
    </div>
  )
}
```

### æ•°æ®ä»ªè¡¨ç›˜

```tsx
// app/dashboard/page.tsx - Server Component
import { RefreshButton } from '@/components/RefreshButton'
import { DateRangePicker } from '@/components/DateRangePicker'

async function getStats() {
  return fetch('https://api.example.com/stats', {
    next: { revalidate: 60 },
  }).then((r) => r.json())
}

export default async function DashboardPage() {
  const stats = await getStats()

  return (
    <div>
      {/* Client: æ—¥æœŸç­›é€‰å’Œåˆ·æ–° */}
      <div className="flex justify-between mb-6">
        <DateRangePicker />
        <RefreshButton />
      </div>

      {/* Server: ç»Ÿè®¡å¡ç‰‡ */}
      <div className="grid grid-cols-4 gap-4 mb-6">
        <StatCard title="æ€»ç”¨æˆ·" value={stats.totalUsers} />
        <StatCard title="ä»Šæ—¥æ´»è·ƒ" value={stats.activeToday} />
        <StatCard title="æ€»æ”¶å…¥" value={`Â¥${stats.revenue}`} />
        <StatCard title="è®¢å•æ•°" value={stats.orders} />
      </div>

      {/* Server: å›¾è¡¨æ•°æ® */}
      <ChartSection data={stats.chartData} />
    </div>
  )
}

function StatCard({ title, value }: { title: string; value: string | number }) {
  return (
    <div className="bg-white p-4 rounded-lg shadow">
      <p className="text-gray-500 text-sm">{title}</p>
      <p className="text-2xl font-bold">{value}</p>
    </div>
  )
}
```

## æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### 1. å»¶è¿ŸåŠ è½½ Client Components

```tsx
import dynamic from 'next/dynamic'

const HeavyChart = dynamic(() => import('@/components/HeavyChart'), {
  loading: () => <div className="h-64 bg-gray-100 animate-pulse" />,
})

export default function Page() {
  return <HeavyChart />
}
```

### 2. æ¡ä»¶æ¸²æŸ“ Client

```tsx
// app/page.tsx
import { Suspense } from 'react'
import { Comments } from '@/components/Comments'

export default function Page() {
  return (
    <article>
      <h1>æ–‡ç« æ ‡é¢˜</h1>
      <p>æ–‡ç« å†…å®¹...</p>

      {/* å»¶è¿ŸåŠ è½½è¯„è®º */}
      <Suspense fallback={<div>åŠ è½½è¯„è®º...</div>}>
        <Comments />
      </Suspense>
    </article>
  )
}
```

## å¸¸è§é—®é¢˜

ğŸ¤” **Q: å¦‚ä½•å…±äº« Server å’Œ Client ä¹‹é—´çš„ä»£ç ï¼Ÿ**

å°†å…±äº«ä»£ç æ”¾åœ¨å•ç‹¬æ–‡ä»¶ï¼Œä¸æ·»åŠ  `"use client"`ï¼š

```tsx
// lib/utils.ts
export function formatPrice(price: number) {
  return `Â¥${price.toFixed(2)}`
}
```

ğŸ¤” **Q: ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ Context vs Server æ•°æ®ä¼ é€’ï¼Ÿ**

- é™æ€æ•°æ®ï¼šServer è·å–åé€šè¿‡ props ä¼ é€’
- éœ€è¦å®æ—¶æ›´æ–°çš„çŠ¶æ€ï¼šContext

ğŸ¤” **Q: å¦‚ä½•å¤„ç†éœ€è¦äº¤äº’çš„é•¿åˆ—è¡¨ï¼Ÿ**

å°†åˆ—è¡¨é¡¹çš„äº¤äº’éƒ¨åˆ†æå–ä¸º Client Componentï¼Œåˆ—è¡¨å®¹å™¨ä¿æŒ Serverã€‚

---

ä¸‹ä¸€ç¯‡å°†ä»‹ç» Streaming ä¸ Suspenseï¼Œå­¦ä¹ å¦‚ä½•å®ç°æ¸è¿›å¼é¡µé¢åŠ è½½ã€‚

-EOF-
