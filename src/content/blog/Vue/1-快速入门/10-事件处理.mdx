---
title: 'Vue3 事件处理完全指南'
pubDate: 2024-01-15
category: 'Vue'
tags: ['Vue3', '事件处理', '修饰符']
description: '掌握 Vue3 事件绑定、事件对象、事件修饰符和按键修饰符的用法'
---

## 基本用法

使用 `v-on` 或简写 `@` 绑定事件：

```vue
<script setup>
import { ref } from 'vue'

const count = ref(0)
const increment = () => count.value++
</script>

<template>
  <!-- 完整写法 -->
  <button v-on:click="increment">+1</button>

  <!-- 简写（推荐） -->
  <button @click="increment">+1</button>

  <!-- 内联表达式（简单逻辑） -->
  <button @click="count++">+1</button>
</template>
```

## 传递参数

```vue
<script setup>
const greet = (name: string) => {
  alert(`Hello, ${name}!`)
}

const greetWithEvent = (name: string, event: MouseEvent) => {
  console.log(name, event.target)
}
</script>

<template>
  <!-- 传参 -->
  <button @click="greet('Vue')">打招呼</button>

  <!-- 传参 + 事件对象：用 $event -->
  <button @click="greetWithEvent('Vue', $event)">打招呼</button>

  <!-- 箭头函数方式 -->
  <button @click="(e) => greetWithEvent('Vue', e)">打招呼</button>
</template>
```

## 事件对象

不传参时，事件对象自动作为第一个参数：

```vue
<script setup>
const handleClick = (event: MouseEvent) => {
  console.log(event.target)       // 触发元素
  console.log(event.currentTarget) // 绑定元素
  console.log(event.clientX, event.clientY) // 坐标
}
</script>

<template>
  <button @click="handleClick">点击</button>
</template>
```

## 事件修饰符

修饰符让事件处理器专注于业务逻辑，不用写 `event.stopPropagation()` 之类的代码。

### 常用修饰符

| 修饰符     | 作用             | 等价代码                                   |
| ---------- | ---------------- | ------------------------------------------ |
| `.stop`    | 阻止冒泡         | `event.stopPropagation()`                  |
| `.prevent` | 阻止默认行为     | `event.preventDefault()`                   |
| `.self`    | 只在元素自身触发 | `if (e.target !== e.currentTarget) return` |
| `.once`    | 只触发一次       | 监听器配置 `{ once: true }`                |
| `.capture` | 捕获阶段触发     | 监听器配置 `{ capture: true }`             |
| `.passive` | 不阻止默认行为   | 监听器配置 `{ passive: true }`             |

### 使用示例

```vue
<template>
  <!-- 阻止冒泡 -->
  <div @click="outer">
    <button @click.stop="inner">不会冒泡到外层</button>
  </div>

  <!-- 阻止表单提交 -->
  <form @submit.prevent="onSubmit">
    <button type="submit">提交</button>
  </form>

  <!-- 只触发一次 -->
  <button @click.once="doOnce">只能点一次</button>

  <!-- 只在元素自身触发 -->
  <div @click.self="onClick">
    <span>点我不会触发</span>
  </div>
</template>
```

### 修饰符可以链式使用

```vue
<!-- 阻止冒泡 + 阻止默认 + 只触发一次 -->
<a @click.stop.prevent.once="handleClick" href="/">链接</a>
```

## 按键修饰符

监听特定按键：

```vue
<template>
  <!-- Enter 键提交 -->
  <input @keyup.enter="submit" />

  <!-- Esc 键取消 -->
  <input @keyup.esc="cancel" />

  <!-- Delete 或 Backspace -->
  <input @keyup.delete="clear" />
</template>
```

### 常用按键修饰符

| 修饰符                               | 按键               |
| ------------------------------------ | ------------------ |
| `.enter`                             | Enter              |
| `.tab`                               | Tab                |
| `.delete`                            | Delete / Backspace |
| `.esc`                               | Escape             |
| `.space`                             | 空格               |
| `.up` / `.down` / `.left` / `.right` | 方向键             |

### 系统修饰键

| 修饰符   | 按键              |
| -------- | ----------------- |
| `.ctrl`  | Ctrl              |
| `.alt`   | Alt (Mac: Option) |
| `.shift` | Shift             |
| `.meta`  | Windows / Command |

```vue
<template>
  <!-- Ctrl + Enter 提交 -->
  <textarea @keyup.ctrl.enter="submit"></textarea>

  <!-- Ctrl + S 保存 -->
  <input @keydown.ctrl.s.prevent="save" />
</template>
```

### .exact 修饰符

精确匹配，不能有其他按键：

```vue
<template>
  <!-- 只有 Ctrl，不能有 Alt/Shift -->
  <button @click.ctrl.exact="onCtrlClick">Ctrl + Click</button>

  <!-- 没有任何系统修饰键 -->
  <button @click.exact="onClick">纯点击</button>
</template>
```

## 鼠标按键修饰符

```vue
<template>
  <div @click.left="onLeftClick">左键</div>
  <div @click.right="onRightClick">右键</div>
  <div @click.middle="onMiddleClick">中键</div>

  <!-- 右键菜单 -->
  <div @contextmenu.prevent="showMenu">右键显示菜单</div>
</template>
```

## 实战场景

### 场景 1：搜索框

```vue
<script setup>
import { ref } from 'vue'

const keyword = ref('')
const search = () => {
  console.log('搜索:', keyword.value)
}
</script>

<template>
  <input v-model="keyword" @keyup.enter="search" placeholder="按 Enter 搜索" />
</template>
```

### 场景 2：快捷键保存

```vue
<script setup>
const save = () => {
  console.log('保存文档')
}
</script>

<template>
  <textarea @keydown.ctrl.s.prevent="save">
    按 Ctrl+S 保存（阻止浏览器默认保存行为）
  </textarea>
</template>
```

### 场景 3：点击外部关闭

```vue
<script setup>
import { ref } from 'vue'

const isOpen = ref(false)
</script>

<template>
  <div @click.self="isOpen = false">
    <div class="modal" v-if="isOpen">点击遮罩层关闭</div>
  </div>
</template>
```

## 速查表

```vue
<!-- 事件绑定 -->
@click="handler" @click="handler(arg)" @click="handler(arg, $event)"

<!-- 事件修饰符 -->
@click.stop
<!-- 阻止冒泡 -->
@click.prevent
<!-- 阻止默认 -->
@click.self
<!-- 仅自身触发 -->
@click.once
<!-- 只触发一次 -->

<!-- 按键修饰符 -->
@keyup.enter
<!-- Enter 键 -->
@keyup.ctrl.enter
<!-- Ctrl + Enter -->
@keyup.ctrl.exact
<!-- 仅 Ctrl，无其他键 -->

<!-- 鼠标修饰符 -->
@click.left
<!-- 左键 -->
@click.right
<!-- 右键 -->
@contextmenu.prevent
<!-- 阻止右键菜单 -->
```

## 小结

- 用 `@` 简写绑定事件
- 修饰符让代码更简洁：`.stop`, `.prevent`, `.once`
- 按键修饰符监听特定按键：`.enter`, `.esc`, `.ctrl`
- 修饰符可以链式使用

下一篇我们来看表单处理。
