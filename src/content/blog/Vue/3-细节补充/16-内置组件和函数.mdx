---
title: 'Vue Router 内置组件和函数'
pubDate: 2024-01-15
category: 'Vue'
tags: ['Vue3', 'Vue Router']
description: 'RouterLink、RouterView 的进阶用法，以及 useRouter、useRoute 等组合式函数'
---

## RouterLink

### 激活样式类

| 属性             | 说明               | 默认类名                 |
| ---------------- | ------------------ | ------------------------ |
| activeClass      | 路径匹配时应用     | router-link-active       |
| exactActiveClass | 路径精确匹配时应用 | router-link-exact-active |

```vue
<router-link to="/about" active-class="active">
  关于
</router-link>
```

| 当前路径    | activeClass | exactActiveClass |
| ----------- | ----------- | ---------------- |
| /about      | ✅          | ✅               |
| /about/team | ✅          | ❌               |
| /other      | ❌          | ❌               |

### 自定义渲染

```vue
<router-link to="/about" custom v-slot="{ navigate, isActive }">
  <button @click="navigate" :class="{ active: isActive }">
    关于
  </button>
</router-link>
```

## RouterView

### 作用域插槽

获取当前匹配的路由组件：

```vue
<router-view v-slot="{ Component, route }">
  <component :is="Component" :key="route.path" />
</router-view>
```

### 配合 KeepAlive

```vue
<router-view v-slot="{ Component }">
  <keep-alive>
    <component :is="Component" />
  </keep-alive>
</router-view>
```

### 配合 Transition

```vue
<router-view v-slot="{ Component }">
  <transition name="fade" mode="out-in">
    <component :is="Component" />
  </transition>
</router-view>
```

### 完整示例

```vue
<router-view v-slot="{ Component }">
  <transition name="fade" mode="out-in">
    <keep-alive>
      <component :is="Component" />
    </keep-alive>
  </transition>
</router-view>
```

### 模板引用

```vue
<router-view v-slot="{ Component }">
  <component :is="Component" ref="pageRef" />
</router-view>

<script setup>
const pageRef = ref(null)
// pageRef 指向的是路由组件，而非 RouterView
</script>
```

## 组合式函数

### useRouter

获取路由实例，用于编程式导航：

```js
import { useRouter } from 'vue-router'

const router = useRouter()

// 导航
router.push('/about')
router.push({ name: 'user', params: { id: 1 } })
router.replace('/home')
router.go(-1)
router.back()
router.forward()
```

### useRoute

获取当前路由信息：

```js
import { useRoute } from 'vue-router'

const route = useRoute()

// 路由信息（响应式）
console.log(route.path) // '/users/123'
console.log(route.params) // { id: '123' }
console.log(route.query) // { page: '1' }
console.log(route.name) // 'user'
console.log(route.meta) // { requiresAuth: true }
console.log(route.matched) // 匹配的路由记录数组
```

### useLink

用于创建自定义导航组件：

```vue
<script setup>
import { useLink } from 'vue-router'

const props = defineProps({
  to: { type: String, required: true },
})

const { route, href, isActive, isExactActive, navigate } = useLink(props)
</script>

<template>
  <a :href="href" @click="navigate" :class="{ active: isActive }">
    <slot />
  </a>
</template>
```

## 模板中的访问

在模板中可以直接使用 `$router` 和 `$route`：

```vue
<template>
  <p>当前路径: {{ $route.path }}</p>
  <button @click="$router.push('/about')">去关于页</button>
</template>
```

## 速查表

| 函数           | 返回值             | 用途           |
| -------------- | ------------------ | -------------- |
| useRouter()    | Router 实例        | 编程式导航     |
| useRoute()     | 当前路由（响应式） | 获取路由信息   |
| useLink(props) | 链接相关状态       | 自定义导航组件 |
