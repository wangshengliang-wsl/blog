---
title: 'Vue3 插槽 Slots'
pubDate: 2024-01-15
category: 'Vue'
tags: ['Vue3', 'slots', '插槽']
description: '掌握默认插槽、具名插槽、作用域插槽的用法'
---

插槽让父组件向子组件传递**模板内容**（而非数据）。

## 默认插槽

子组件用 `<slot>` 占位：

```vue
<!-- Card.vue -->
<template>
  <div class="card">
    <slot></slot>
    <!-- 父组件内容插入这里 -->
  </div>
</template>
```

父组件传递内容：

```vue
<Card>
  <h2>标题</h2>
  <p>这是卡片内容</p>
</Card>
```

### 默认内容

```vue
<slot>如果父组件没传内容，显示这个</slot>
```

## 具名插槽

用 `name` 定义多个插槽：

```vue
<!-- Layout.vue -->
<template>
  <header>
    <slot name="header"></slot>
  </header>
  <main>
    <slot></slot>
    <!-- 默认插槽 -->
  </main>
  <footer>
    <slot name="footer"></slot>
  </footer>
</template>
```

父组件用 `v-slot:name` 或 `#name` 指定：

```vue
<Layout>
  <template #header>
    <h1>页面标题</h1>
  </template>
  
  <p>主要内容</p>  <!-- 进入默认插槽 -->
  
  <template #footer>
    <p>版权信息</p>
  </template>
</Layout>
```

### 动态插槽名

```vue
<template #[slotName]>动态内容</template>
```

## 作用域插槽

有时父组件需要访问子组件的数据。子组件通过 slot 传递数据：

```vue
<!-- List.vue -->
<script setup>
const items = [
  { id: 1, name: 'Vue', done: true },
  { id: 2, name: 'React', done: false },
]
</script>

<template>
  <ul>
    <li v-for="item in items" :key="item.id">
      <!-- 通过 slot 传递数据给父组件 -->
      <slot :item="item" :index="index"></slot>
    </li>
  </ul>
</template>
```

父组件接收数据：

```vue
<List v-slot="{ item, index }">
  <span>{{ index + 1 }}. {{ item.name }}</span>
  <span v-if="item.done">✓</span>
</List>
```

### 具名插槽 + 作用域

```vue
<!-- 子组件 -->
<slot name="item" :data="itemData"></slot>

<!-- 父组件 -->
<template #item="{ data }">
  {{ data }}
</template>
```

## 实战示例

### 可复用的表格组件

```vue
<!-- DataTable.vue -->
<script setup>
defineProps<{
  columns: { key: string; title: string }[]
  data: any[]
}>()
</script>

<template>
  <table>
    <thead>
      <tr>
        <th v-for="col in columns" :key="col.key">
          {{ col.title }}
        </th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="(row, index) in data" :key="index">
        <td v-for="col in columns" :key="col.key">
          <!-- 允许自定义单元格渲染 -->
          <slot :name="col.key" :row="row" :value="row[col.key]">
            {{ row[col.key] }}
          </slot>
        </td>
      </tr>
    </tbody>
  </table>
</template>
```

使用：

```vue
<script setup>
const columns = [
  { key: 'name', title: '姓名' },
  { key: 'status', title: '状态' },
  { key: 'actions', title: '操作' },
]
const users = [
  { name: '张三', status: 'active' },
  { name: '李四', status: 'inactive' },
]
</script>

<template>
  <DataTable :columns="columns" :data="users">
    <!-- 自定义状态列 -->
    <template #status="{ value }">
      <span :class="value">{{ value === 'active' ? '在线' : '离线' }}</span>
    </template>

    <!-- 自定义操作列 -->
    <template #actions="{ row }">
      <button @click="edit(row)">编辑</button>
      <button @click="remove(row)">删除</button>
    </template>
  </DataTable>
</template>
```

### 无渲染组件

只提供逻辑，不渲染 UI：

```vue
<!-- MouseTracker.vue -->
<script setup>
import { ref, onMounted, onUnmounted } from 'vue'

const x = ref(0)
const y = ref(0)

const update = (e: MouseEvent) => {
  x.value = e.clientX
  y.value = e.clientY
}

onMounted(() => window.addEventListener('mousemove', update))
onUnmounted(() => window.removeEventListener('mousemove', update))
</script>

<template>
  <slot :x="x" :y="y"></slot>
</template>
```

使用：

```vue
<MouseTracker v-slot="{ x, y }">
  <p>鼠标位置：{{ x }}, {{ y }}</p>
</MouseTracker>
```

## 语法速查

```vue
<!-- 默认插槽 -->
<slot></slot>
<slot>默认内容</slot>

<!-- 具名插槽 -->
<slot name="header"></slot>
<template #header>内容</template>

<!-- 作用域插槽 -->
<slot :data="item"></slot>
<template #default="{ data }">{{ data }}</template>

<!-- 具名 + 作用域 -->
<slot name="item" :row="row"></slot>
<template #item="{ row }">{{ row }}</template>
```

## 小结

| 类型       | 用途         | 语法                                     |
| ---------- | ------------ | ---------------------------------------- |
| 默认插槽   | 传递内容     | `<slot>`                                 |
| 具名插槽   | 多个插槽位置 | `<slot name="x">` + `#x`                 |
| 作用域插槽 | 子传父数据   | `<slot :data="x">` + `v-slot="{ data }"` |

下一篇我们来看前端路由。
