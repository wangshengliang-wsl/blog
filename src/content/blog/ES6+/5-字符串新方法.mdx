---
title: 'å­—ç¬¦ä¸²æ–°å¢æ–¹æ³•'
description: 'è¯¦è§£ ES6+ å­—ç¬¦ä¸²æ–°æ–¹æ³•ï¼šincludesã€startsWithã€padStartã€replaceAll ç­‰å®ç”¨ API'
pubDate: 2024-01-05
toc: true
ogImage: true
category: 'ES6+'
tags: ['ES6', 'å­—ç¬¦ä¸²', 'includes', 'startsWith', 'padStart']
---

ES6 åŠåç»­ç‰ˆæœ¬ä¸ºå­—ç¬¦ä¸²æ–°å¢äº†è®¸å¤šå®ç”¨æ–¹æ³•ï¼Œè®©å­—ç¬¦ä¸²æ“ä½œæ›´åŠ ä¾¿æ·ã€‚

## æŸ¥æ‰¾æ–¹æ³•

### includes()

åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šå­ä¸²ï¼š

```javascript
const str = 'Hello World'

// ES5 å†™æ³•
str.indexOf('World') !== -1 // true

// ES6
str.includes('World') // true
str.includes('world') // falseï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰
str.includes('World', 7) // falseï¼ˆä»ä½ç½®7å¼€å§‹æŸ¥æ‰¾ï¼‰
```

### startsWith() å’Œ endsWith()

```javascript
const filename = 'image.png'

// åˆ¤æ–­å‰ç¼€
filename.startsWith('image') // true
filename.startsWith('img') // false

// åˆ¤æ–­åç¼€
filename.endsWith('.png') // true
filename.endsWith('.jpg') // false

// æŒ‡å®šèµ·å§‹ä½ç½®
const url = 'https://example.com'
url.startsWith('example', 8) // trueï¼ˆä»ä½ç½®8å¼€å§‹ï¼‰

// æŒ‡å®šç»“æŸä½ç½®
const text = 'Hello World'
text.endsWith('Hello', 5) // trueï¼ˆåªçœ‹å‰5ä¸ªå­—ç¬¦ï¼‰
```

å®é™…åº”ç”¨ï¼š

```javascript
// æ–‡ä»¶ç±»å‹åˆ¤æ–­
function isImage(filename) {
  return ['.png', '.jpg', '.jpeg', '.gif', '.webp'].some((ext) =>
    filename.toLowerCase().endsWith(ext)
  )
}

// URL åè®®åˆ¤æ–­
function isSecure(url) {
  return url.startsWith('https://')
}

// æ‰‹æœºå·è„±æ•
function maskPhone(phone) {
  if (phone.startsWith('+86')) {
    phone = phone.slice(3)
  }
  return phone.slice(0, 3) + '****' + phone.slice(-4)
}
```

## å¡«å……æ–¹æ³•

### padStart() å’Œ padEnd()

ç”¨æŒ‡å®šå­—ç¬¦å¡«å……åˆ°ç›®æ ‡é•¿åº¦ï¼š

```javascript
// å·¦å¡«å……
'5'.padStart(2, '0') // '05'
'12'.padStart(2, '0') // '12'
'123'.padStart(2, '0') // '123'ï¼ˆå·²è¶…è¿‡ç›®æ ‡é•¿åº¦ï¼Œä¸å˜ï¼‰

// å³å¡«å……
'abc'.padEnd(6, '.') // 'abc...'
'abc'.padEnd(6) // 'abc   'ï¼ˆé»˜è®¤ç”¨ç©ºæ ¼å¡«å……ï¼‰

// å¡«å……å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­
'1'.padStart(5, 'ab') // 'abab1'
```

å®é™…åº”ç”¨ï¼š

```javascript
// æ ¼å¼åŒ–æ•°å­—
function formatNumber(num, digits = 2) {
  return String(num).padStart(digits, '0')
}
formatNumber(5) // '05'
formatNumber(123, 5) // '00123'

// æ ¼å¼åŒ–æ—¥æœŸ
function formatDate(date) {
  const y = date.getFullYear()
  const m = String(date.getMonth() + 1).padStart(2, '0')
  const d = String(date.getDate()).padStart(2, '0')
  return `${y}-${m}-${d}`
}

// æ ¼å¼åŒ–æ—¶é—´
function formatTime(seconds) {
  const h = Math.floor(seconds / 3600)
  const m = Math.floor((seconds % 3600) / 60)
  const s = seconds % 60
  return [h, m, s].map((n) => String(n).padStart(2, '0')).join(':')
}
formatTime(3661) // '01:01:01'

// é“¶è¡Œå¡å·æ ¼å¼åŒ–
function formatBankCard(card) {
  return card
    .replace(/\s/g, '')
    .replace(/(\d{4})/g, '$1 ')
    .trim()
}

// é‡‘é¢æ ¼å¼åŒ–ï¼ˆå³å¯¹é½ï¼‰
function formatMoney(amount) {
  return amount.toFixed(2).padStart(10)
}
```

## å»é™¤ç©ºç™½

### trim()ã€trimStart()ã€trimEnd()

```javascript
const str = '  hello world  '

str.trim() // 'hello world'
str.trimStart() // 'hello world  'ï¼ˆåˆ«åï¼štrimLeftï¼‰
str.trimEnd() // '  hello world'ï¼ˆåˆ«åï¼štrimRightï¼‰
```

å®é™…åº”ç”¨ï¼š

```javascript
// è¡¨å•è¾“å…¥æ¸…ç†
function cleanInput(value) {
  return value.trim()
}

// å»é™¤è¡Œé¦–ç©ºæ ¼ä½†ä¿ç•™è¡Œå°¾
function preserveTrailing(text) {
  return text
    .split('\n')
    .map((line) => line.trimStart())
    .join('\n')
}
```

## æ›¿æ¢æ–¹æ³•

### replaceAll()

ES2021 æ–°å¢ï¼Œæ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹ï¼š

```javascript
const str = 'aabbcc'

// replace åªæ›¿æ¢ç¬¬ä¸€ä¸ª
str.replace('b', 'x') // 'aaxbcc'

// ES5 æ›¿æ¢æ‰€æœ‰éœ€è¦æ­£åˆ™
str.replace(/b/g, 'x') // 'aaxxcc'

// replaceAll ç›´æ¥æ›¿æ¢æ‰€æœ‰
str.replaceAll('b', 'x') // 'aaxxcc'
```

ğŸ”¶ æ³¨æ„ï¼šreplaceAll çš„ç¬¬ä¸€ä¸ªå‚æ•°å¦‚æœæ˜¯æ­£åˆ™ï¼Œå¿…é¡»å¸¦ `g` æ ‡å¿—ï¼š

```javascript
'aabb'.replaceAll(/b/, 'x') // TypeError
'aabb'.replaceAll(/b/g, 'x') // 'aaxx' âœ…
```

å®é™…åº”ç”¨ï¼š

```javascript
// è½¬ä¹‰ HTML
function escapeHTML(str) {
  return str
    .replaceAll('&', '&amp;')
    .replaceAll('<', '&lt;')
    .replaceAll('>', '&gt;')
    .replaceAll('"', '&quot;')
}

// è·¯å¾„æ ‡å‡†åŒ–
function normalizePath(path) {
  return path.replaceAll('\\', '/')
}

// ç§»é™¤æ‰€æœ‰ç©ºæ ¼
function removeSpaces(str) {
  return str.replaceAll(' ', '')
}
```

## é‡å¤æ–¹æ³•

### repeat()

```javascript
'ab'.repeat(3) // 'ababab'
'*'.repeat(10) // '**********'
'x'.repeat(0) // ''

// å°æ•°ä¼šå‘ä¸‹å–æ•´
'ab'.repeat(2.9) // 'abab'

// è´Ÿæ•°æˆ– Infinity æŠ¥é”™
// 'ab'.repeat(-1); // RangeError
```

å®é™…åº”ç”¨ï¼š

```javascript
// ç”Ÿæˆåˆ†éš”çº¿
const line = '-'.repeat(50)

// ç¼©è¿›
function indent(str, level = 1) {
  const spaces = '  '.repeat(level)
  return str
    .split('\n')
    .map((line) => spaces + line)
    .join('\n')
}

// ç®€å•è¿›åº¦æ¡
function progress(percent, width = 20) {
  const filled = Math.round((width * percent) / 100)
  const empty = width - filled
  return '[' + 'â–ˆ'.repeat(filled) + 'â–‘'.repeat(empty) + '] ' + percent + '%'
}
progress(75) // '[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 75%'

// ç”Ÿæˆå ä½ç¬¦
function placeholder(length) {
  return 'â–ˆ'.repeat(length)
}
```

## è®¿é—®æ–¹æ³•

### at()

ES2022 æ–°å¢ï¼Œæ”¯æŒè´Ÿç´¢å¼•ï¼š

```javascript
const str = 'Hello'

// ä¼ ç»Ÿæ–¹å¼
str[0] // 'H'
str[str.length - 1] // 'o'
str.charAt(0) // 'H'

// at() æ”¯æŒè´Ÿç´¢å¼•
str.at(0) // 'H'
str.at(-1) // 'o'
str.at(-2) // 'l'
str.at(100) // undefined
```

å®é™…åº”ç”¨ï¼š

```javascript
// è·å–æ–‡ä»¶æ‰©å±•å
function getExt(filename) {
  const parts = filename.split('.')
  return parts.at(-1)
}
getExt('image.png') // 'png'
getExt('archive.tar.gz') // 'gz'

// è·å–è·¯å¾„æœ€åä¸€éƒ¨åˆ†
function basename(path) {
  return path.split('/').at(-1)
}
```

## åˆ†å‰²å’Œæ‹¼æ¥

### split() çš„å¢å¼º

```javascript
// é™åˆ¶åˆ†å‰²æ•°é‡
'a,b,c,d'.split(',', 2) // ['a', 'b']

// ç”¨æ­£åˆ™åˆ†å‰²
'a1b2c3'.split(/\d/) // ['a', 'b', 'c', '']

// ä¿ç•™åˆ†éš”ç¬¦ï¼ˆä½¿ç”¨æ•è·ç»„ï¼‰
'a1b2c3'.split(/(\d)/) // ['a', '1', 'b', '2', 'c', '3', '']
```

## å¤§å°å†™è½¬æ¢å¢å¼º

### toLocaleLowerCase() å’Œ toLocaleUpperCase()

è€ƒè™‘ç‰¹å®šè¯­è¨€çš„å¤§å°å†™è§„åˆ™ï¼š

```javascript
// åœŸè€³å…¶è¯­çš„ I å¤§å°å†™ç‰¹æ®Š
const str = 'I'
str.toLowerCase() // 'i'
str.toLocaleLowerCase('tr-TR') // 'Ä±'ï¼ˆåœŸè€³å…¶è¯­å°å†™ iï¼‰

// å¾·è¯­ ÃŸ è½¬å¤§å†™
const german = 'straÃŸe'
german.toUpperCase() // 'STRASSE'
german.toLocaleUpperCase('de-DE') // 'STRASSE'
```

## å®æˆ˜æŠ€å·§

### æ¨¡æ¿è§£æ

```javascript
function parseTemplate(template, data) {
  return template.replace(/\{\{(\w+)\}\}/g, (_, key) => {
    return data[key] ?? ''
  })
}

const tpl = 'ä½ å¥½ï¼Œ{{name}}ï¼ä»Šå¤©æ˜¯{{date}}ã€‚'
parseTemplate(tpl, { name: 'å¼ ä¸‰', date: '2024-01-01' })
// 'ä½ å¥½ï¼Œå¼ ä¸‰ï¼ä»Šå¤©æ˜¯2024-01-01ã€‚'
```

### é©¼å³°å‘½åè½¬æ¢

```javascript
// kebab-case è½¬ camelCase
function toCamelCase(str) {
  return str.replace(/-([a-z])/g, (_, char) => char.toUpperCase())
}
toCamelCase('background-color') // 'backgroundColor'

// camelCase è½¬ kebab-case
function toKebabCase(str) {
  return str.replace(/([A-Z])/g, '-$1').toLowerCase()
}
toKebabCase('backgroundColor') // 'background-color'

// snake_case è½¬ camelCase
function snakeToCamel(str) {
  return str.replace(/_([a-z])/g, (_, char) => char.toUpperCase())
}
snakeToCamel('user_name') // 'userName'
```

### å­—ç¬¦ä¸²æˆªæ–­

```javascript
function truncate(str, maxLength, suffix = '...') {
  if (str.length <= maxLength) return str
  return str.slice(0, maxLength - suffix.length) + suffix
}

truncate('è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬', 10) // 'è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„...'
```

## æ–¹æ³•æ±‡æ€»

| æ–¹æ³•         | ä½œç”¨                   | ç‰ˆæœ¬   |
| ------------ | ---------------------- | ------ |
| includes()   | æ˜¯å¦åŒ…å«å­ä¸²           | ES6    |
| startsWith() | æ˜¯å¦ä»¥æŒ‡å®šå­—ç¬¦ä¸²å¼€å¤´   | ES6    |
| endsWith()   | æ˜¯å¦ä»¥æŒ‡å®šå­—ç¬¦ä¸²ç»“å°¾   | ES6    |
| padStart()   | å·¦å¡«å……è‡³æŒ‡å®šé•¿åº¦       | ES2017 |
| padEnd()     | å³å¡«å……è‡³æŒ‡å®šé•¿åº¦       | ES2017 |
| trimStart()  | å»é™¤å¼€å¤´ç©ºç™½           | ES2019 |
| trimEnd()    | å»é™¤ç»“å°¾ç©ºç™½           | ES2019 |
| repeat()     | é‡å¤å­—ç¬¦ä¸²             | ES6    |
| replaceAll() | æ›¿æ¢æ‰€æœ‰åŒ¹é…           | ES2021 |
| at()         | æŒ‰ç´¢å¼•è®¿é—®ï¼ˆæ”¯æŒè´Ÿæ•°ï¼‰ | ES2022 |

è¿™äº›æ–¹æ³•è®©å­—ç¬¦ä¸²æ“ä½œå˜å¾—æ›´åŠ ç›´è§‚å’Œä¾¿æ·ï¼Œå–„ç”¨å®ƒä»¬å¯ä»¥å†™å‡ºæ›´ç®€æ´çš„ä»£ç ã€‚
