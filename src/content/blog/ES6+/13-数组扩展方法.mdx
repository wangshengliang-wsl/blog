---
title: 'æ•°ç»„æ‰©å±•æ–¹æ³•'
description: 'è¯¦è§£ ES6 æ•°ç»„æ–°å¢æ–¹æ³•ï¼šArray.fromã€Array.ofã€findã€findIndexã€fill ç­‰'
pubDate: 2024-01-13
toc: true
ogImage: true
category: 'ES6+'
tags: ['ES6', 'æ•°ç»„', 'Array', 'find', 'fill']
---

ES6 ä¸ºæ•°ç»„æ–°å¢äº†è®¸å¤šå®ç”¨æ–¹æ³•ï¼Œè®©æ•°ç»„æ“ä½œæ›´åŠ ä¾¿æ·ã€‚

## Array.from()

å°†ç±»æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚

### åŸºæœ¬ç”¨æ³•

```javascript
// ç±»æ•°ç»„å¯¹è±¡
const arrayLike = { 0: 'a', 1: 'b', 2: 'c', length: 3 }
Array.from(arrayLike) // ['a', 'b', 'c']

// å­—ç¬¦ä¸²
Array.from('hello') // ['h', 'e', 'l', 'l', 'o']

// Set
Array.from(new Set([1, 2, 2, 3])) // [1, 2, 3]

// Map
Array.from(
  new Map([
    ['a', 1],
    ['b', 2],
  ])
) // [['a', 1], ['b', 2]]

// NodeList
const divs = document.querySelectorAll('div')
Array.from(divs) // [div, div, div, ...]
```

### æ˜ å°„å‡½æ•°

ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ˜ å°„å‡½æ•°ï¼Œç±»ä¼¼ `map`ï¼š

```javascript
Array.from([1, 2, 3], (x) => x * 2) // [2, 4, 6]

// ç­‰ä»·äº
Array.from([1, 2, 3]).map((x) => x * 2)

// ç”Ÿæˆæ•°å­—åºåˆ—
Array.from({ length: 5 }, (_, i) => i) // [0, 1, 2, 3, 4]
Array.from({ length: 5 }, (_, i) => i + 1) // [1, 2, 3, 4, 5]

// ç”Ÿæˆéšæœºæ•°ç»„
Array.from({ length: 5 }, () => Math.random())
```

### å®é™…åº”ç”¨

```javascript
// æ•°ç»„å»é‡
function unique(arr) {
  return Array.from(new Set(arr))
}
unique([1, 2, 2, 3, 3, 3]) // [1, 2, 3]

// åˆ›å»ºäºŒç»´æ•°ç»„
function create2DArray(rows, cols, value = 0) {
  return Array.from({ length: rows }, () =>
    Array.from({ length: cols }, () => value)
  )
}
create2DArray(3, 4, 0)
// [[0,0,0,0], [0,0,0,0], [0,0,0,0]]

// ç”Ÿæˆå­—æ¯è¡¨
const alphabet = Array.from({ length: 26 }, (_, i) =>
  String.fromCharCode(65 + i)
)
// ['A', 'B', 'C', ..., 'Z']

// Unicode å­—ç¬¦æ­£ç¡®å¤„ç†
Array.from('ğ ®·') // ['ğ ®·']ï¼ˆæ­£ç¡®å¤„ç† 32 ä½å­—ç¬¦ï¼‰
'ğ ®·'.split('') // ['\uD842', '\uDFB7']ï¼ˆé”™è¯¯ï¼‰
```

## Array.of()

åˆ›å»ºåŒ…å«æŒ‡å®šå…ƒç´ çš„æ•°ç»„ï¼Œè§£å†³ `new Array()` çš„æ€ªå¼‚è¡Œä¸ºï¼š

```javascript
// new Array çš„é—®é¢˜
new Array(3) // [empty Ã— 3]ï¼ˆå•ä¸ªæ•°å­—åˆ›å»ºæŒ‡å®šé•¿åº¦çš„ç©ºæ•°ç»„ï¼‰
new Array(3, 4) // [3, 4]
new Array('3') // ['3']

// Array.of è¡Œä¸ºä¸€è‡´
Array.of(3) // [3]
Array.of(3, 4) // [3, 4]
Array.of('3') // ['3']
Array.of(undefined) // [undefined]
Array.of() // []
```

## find() å’Œ findIndex()

æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æˆ–ç´¢å¼•ï¼š

```javascript
const users = [
  { id: 1, name: 'å¼ ä¸‰' },
  { id: 2, name: 'æå››' },
  { id: 3, name: 'ç‹äº”' },
]

// find è¿”å›å…ƒç´ 
const user = users.find((u) => u.id === 2)
console.log(user) // { id: 2, name: 'æå››' }

// æ‰¾ä¸åˆ°è¿”å› undefined
users.find((u) => u.id === 100) // undefined

// findIndex è¿”å›ç´¢å¼•
users.findIndex((u) => u.id === 2) // 1

// æ‰¾ä¸åˆ°è¿”å› -1
users.findIndex((u) => u.id === 100) // -1
```

ä¸ `indexOf` çš„åŒºåˆ«ï¼š

```javascript
// indexOf ä½¿ç”¨ === æ¯”è¾ƒï¼Œæ— æ³•æŸ¥æ‰¾ NaN
;[NaN].indexOf(NaN) // -1

// find å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ¡ä»¶
;[NaN].find((x) => Number.isNaN(x)) // NaN
;[NaN].findIndex((x) => Number.isNaN(x)) // 0

// indexOf åªèƒ½æŸ¥æ‰¾å€¼ï¼Œfind å¯ä»¥æŸ¥æ‰¾å¯¹è±¡å±æ€§
const arr = [{ id: 1 }, { id: 2 }]
arr.indexOf({ id: 1 }) // -1ï¼ˆå¯¹è±¡å¼•ç”¨ä¸åŒï¼‰
arr.find((item) => item.id === 1) // { id: 1 }
```

## findLast() å’Œ findLastIndex()

ES2023 æ–°å¢ï¼Œä»æ•°ç»„æœ«å°¾å¼€å§‹æŸ¥æ‰¾ï¼š

```javascript
const numbers = [1, 2, 3, 2, 1]

// ä»å‰å¾€åæ‰¾ç¬¬ä¸€ä¸ª
numbers.find((n) => n === 2) // 2ï¼ˆç´¢å¼• 1ï¼‰
numbers.findIndex((n) => n === 2) // 1

// ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ª
numbers.findLast((n) => n === 2) // 2ï¼ˆç´¢å¼• 3ï¼‰
numbers.findLastIndex((n) => n === 2) // 3

// å®é™…åº”ç”¨ï¼šæ‰¾æœ€åä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
const logs = [
  { time: '10:00', type: 'info' },
  { time: '10:05', type: 'error' },
  { time: '10:10', type: 'info' },
  { time: '10:15', type: 'error' },
]

logs.findLast((log) => log.type === 'error')
// { time: '10:15', type: 'error' }
```

## fill()

ç”¨å›ºå®šå€¼å¡«å……æ•°ç»„ï¼š

```javascript
// åŸºæœ¬ç”¨æ³•
;[1, 2, 3].fill(0) // [0, 0, 0]

// æŒ‡å®šèµ·å§‹å’Œç»“æŸä½ç½®
;[1, 2, 3, 4, 5].fill(0, 1, 3) // [1, 0, 0, 4, 5]

// åˆ›å»ºå¹¶å¡«å……
new Array(5).fill(0) // [0, 0, 0, 0, 0]

// ğŸ”¶ æ³¨æ„ï¼šå¯¹è±¡å¡«å……æ˜¯åŒä¸€ä¸ªå¼•ç”¨
const arr = new Array(3).fill({ x: 0 })
arr[0].x = 1
console.log(arr) // [{ x: 1 }, { x: 1 }, { x: 1 }]

// æ­£ç¡®åšæ³•
const arr2 = Array.from({ length: 3 }, () => ({ x: 0 }))
arr2[0].x = 1
console.log(arr2) // [{ x: 1 }, { x: 0 }, { x: 0 }]
```

## copyWithin()

åœ¨æ•°ç»„å†…éƒ¨å¤åˆ¶å…ƒç´ ï¼š

```javascript
// copyWithin(target, start, end)
// target: å¤åˆ¶åˆ°çš„ä½ç½®
// start: å¤åˆ¶æºçš„èµ·å§‹ä½ç½®
// end: å¤åˆ¶æºçš„ç»“æŸä½ç½®ï¼ˆä¸åŒ…å«ï¼‰

;[1, 2, 3, 4, 5].copyWithin(0, 3)
// [4, 5, 3, 4, 5]ï¼ˆä»ä½ç½®3å¼€å§‹å¤åˆ¶åˆ°ä½ç½®0ï¼‰

;[1, 2, 3, 4, 5].copyWithin(0, 3, 4)
// [4, 2, 3, 4, 5]ï¼ˆåªå¤åˆ¶ä¸€ä¸ªå…ƒç´ ï¼‰

;[1, 2, 3, 4, 5].copyWithin(-2, 0, 2)
// [1, 2, 3, 1, 2]ï¼ˆè´Ÿæ•°ä»æœ«å°¾è®¡ç®—ï¼‰
```

## entries()ã€keys()ã€values()

è¿”å›éå†å™¨å¯¹è±¡ï¼š

```javascript
const arr = ['a', 'b', 'c']

// keys() è¿”å›ç´¢å¼•
for (const index of arr.keys()) {
  console.log(index) // 0, 1, 2
}

// values() è¿”å›å€¼
for (const value of arr.values()) {
  console.log(value) // 'a', 'b', 'c'
}

// entries() è¿”å› [ç´¢å¼•, å€¼]
for (const [index, value] of arr.entries()) {
  console.log(index, value) // 0 'a', 1 'b', 2 'c'
}

// è½¬ä¸ºæ•°ç»„
;[...arr.entries()] // [[0, 'a'], [1, 'b'], [2, 'c']]
```

## includes()

åˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼š

```javascript
;[1, 2, 3].includes(2) // true
;[1, 2, 3].includes(4) // false

// å¯ä»¥æ£€æµ‹ NaN
;[1, NaN, 3].includes(NaN) // true
;[1, NaN, 3].indexOf(NaN) // -1ï¼ˆindexOf æ— æ³•æ£€æµ‹ï¼‰

// æŒ‡å®šèµ·å§‹ä½ç½®
;[1, 2, 3].includes(1, 1) // falseï¼ˆä»ç´¢å¼•1å¼€å§‹æŸ¥æ‰¾ï¼‰
;[1, 2, 3].includes(1, -3) // trueï¼ˆè´Ÿæ•°ä»æœ«å°¾è®¡ç®—ï¼‰
```

## ç©ºä½å¤„ç†

ES6 æ˜ç¡®å°†æ•°ç»„ç©ºä½è½¬ä¸º `undefined`ï¼š

```javascript
// ES5 æ–¹æ³•å¯¹ç©ºä½å¤„ç†ä¸ä¸€è‡´
;[, , ,].forEach((x) => console.log(x)) // ä¸è¾“å‡ºï¼ˆè·³è¿‡ç©ºä½ï¼‰
;[, , ,].map((x) => 1) // [empty Ã— 3]ï¼ˆè·³è¿‡ç©ºä½ï¼‰

// ES6 æ–¹æ³•ç»Ÿä¸€å¤„ç†ä¸º undefined
Array.from([, , ,]) // [undefined, undefined, undefined]
;[...[, , ,]] // [undefined, undefined, undefined]
;[, , ,].fill(1) // [1, 1, 1]

// for...of ä¹Ÿä¼šéå†ç©ºä½
for (const x of [, , ,]) {
  console.log(x) // undefined, undefined, undefined
}
```

## å®æˆ˜åº”ç”¨

### æ•°ç»„åˆ†ç»„

```javascript
function groupBy(arr, fn) {
  return arr.reduce((groups, item) => {
    const key = fn(item)
    ;(groups[key] = groups[key] || []).push(item)
    return groups
  }, {})
}

const users = [
  { name: 'å¼ ä¸‰', age: 25 },
  { name: 'æå››', age: 30 },
  { name: 'ç‹äº”', age: 25 },
]

groupBy(users, (u) => u.age)
// { 25: [{...}, {...}], 30: [{...}] }
```

### æ•°ç»„åˆ†å—

```javascript
function chunk(arr, size) {
  return Array.from({ length: Math.ceil(arr.length / size) }, (_, i) =>
    arr.slice(i * size, i * size + size)
  )
}

chunk([1, 2, 3, 4, 5], 2) // [[1, 2], [3, 4], [5]]
```

### æ•°ç»„æ‰“ä¹±

```javascript
function shuffle(arr) {
  const result = [...arr]
  for (let i = result.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    ;[result[i], result[j]] = [result[j], result[i]]
  }
  return result
}

shuffle([1, 2, 3, 4, 5]) // [3, 1, 5, 2, 4]ï¼ˆéšæœºï¼‰
```

### æ•°ç»„å»é‡ï¼ˆä¿æŒé¡ºåºï¼‰

```javascript
function unique(arr, key) {
  if (key) {
    const seen = new Set()
    return arr.filter((item) => {
      const k = item[key]
      if (seen.has(k)) return false
      seen.add(k)
      return true
    })
  }
  return [...new Set(arr)]
}

unique([1, 2, 2, 3]) // [1, 2, 3]
unique([{ id: 1 }, { id: 2 }, { id: 1 }], 'id') // [{ id: 1 }, { id: 2 }]
```

## æ–¹æ³•æ±‡æ€»

| æ–¹æ³•            | ä½œç”¨         | è¿”å›å€¼           |
| --------------- | ------------ | ---------------- |
| Array.from()    | ç±»æ•°ç»„è½¬æ•°ç»„ | æ–°æ•°ç»„           |
| Array.of()      | åˆ›å»ºæ•°ç»„     | æ–°æ•°ç»„           |
| find()          | æŸ¥æ‰¾å…ƒç´      | å…ƒç´ æˆ– undefined |
| findIndex()     | æŸ¥æ‰¾ç´¢å¼•     | ç´¢å¼•æˆ– -1        |
| findLast()      | ä»åæŸ¥æ‰¾å…ƒç´  | å…ƒç´ æˆ– undefined |
| findLastIndex() | ä»åæŸ¥æ‰¾ç´¢å¼• | ç´¢å¼•æˆ– -1        |
| fill()          | å¡«å……æ•°ç»„     | ä¿®æ”¹åçš„åŸæ•°ç»„   |
| copyWithin()    | å†…éƒ¨å¤åˆ¶     | ä¿®æ”¹åçš„åŸæ•°ç»„   |
| includes()      | æ˜¯å¦åŒ…å«     | boolean          |
| entries()       | é”®å€¼å¯¹è¿­ä»£å™¨ | Iterator         |
| keys()          | é”®è¿­ä»£å™¨     | Iterator         |
| values()        | å€¼è¿­ä»£å™¨     | Iterator         |

è¿™äº›æ–¹æ³•è®©æ•°ç»„æ“ä½œæ›´åŠ ç›´è§‚å’Œä¾¿æ·ï¼Œç†Ÿç»ƒæŒæ¡å¯ä»¥å†™å‡ºæ›´ç®€æ´çš„ä»£ç ã€‚
