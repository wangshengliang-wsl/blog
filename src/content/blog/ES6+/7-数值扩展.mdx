---
title: 'æ•°å€¼çš„æ‰©å±•'
description: 'è¯¦è§£ ES6+ æ•°å€¼æ–°ç‰¹æ€§ï¼šäºŒè¿›åˆ¶å…«è¿›åˆ¶è¡¨ç¤ºæ³•ã€Number æ–°æ–¹æ³•ã€Math æ‰©å±•ç­‰'
pubDate: 2024-01-07
toc: true
ogImage: true
category: 'ES6+'
tags: ['ES6', 'Number', 'Math', 'æ•°å€¼']
---

ES6 å¯¹æ•°å€¼ç±»å‹åšäº†å¤šé¡¹å¢å¼ºï¼ŒåŒ…æ‹¬æ–°çš„å­—é¢é‡è¯­æ³•ã€Number å¯¹è±¡æ–°æ–¹æ³•ã€Math å¯¹è±¡æ‰©å±•ç­‰ã€‚

## æ•°å€¼å­—é¢é‡

### äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶

ES6 æ–°å¢äº†äºŒè¿›åˆ¶ï¼ˆ`0b`ï¼‰å’Œå…«è¿›åˆ¶ï¼ˆ`0o`ï¼‰å­—é¢é‡å‰ç¼€ï¼š

```javascript
// äºŒè¿›åˆ¶ï¼ˆBinaryï¼‰
const bin = 0b1010
console.log(bin) // 10

// å…«è¿›åˆ¶ï¼ˆOctalï¼‰
const oct = 0o17
console.log(oct) // 15

// åå…­è¿›åˆ¶ï¼ˆå·²æœ‰ï¼‰
const hex = 0xff
console.log(hex) // 255

// è½¬æ¢ä¸ºäºŒè¿›åˆ¶/å…«è¿›åˆ¶å­—ç¬¦ä¸²
;(10).toString(2) // '1010'
;(15).toString(8) // '17'
;(255).toString(16) // 'ff'
```

å®é™…åº”ç”¨ï¼š

```javascript
// ä½æ©ç æ›´ç›´è§‚
const READ = 0b0001 // 1
const WRITE = 0b0010 // 2
const EXECUTE = 0b0100 // 4

const permission = READ | WRITE // 0b0011 = 3

// æ£€æŸ¥æƒé™
const hasRead = (permission & READ) !== 0 // true
const hasExecute = (permission & EXECUTE) !== 0 // false

// æ–‡ä»¶æƒé™ï¼ˆç±»ä¼¼ Linuxï¼‰
const FILE_PERMISSION = 0o755 // rwxr-xr-x
```

### æ•°å€¼åˆ†éš”ç¬¦

ES2021 å…è®¸ç”¨ä¸‹åˆ’çº¿ `_` åˆ†éš”æ•°å­—ï¼Œæé«˜å¯è¯»æ€§ï¼š

```javascript
const billion = 1_000_000_000
const bytes = 0xff_ff_ff_ff
const bits = 0b1010_0001_1000_0101

// å°æ•°ä¹Ÿå¯ä»¥
const pi = 3.141_592_653

// ç§‘å­¦è®¡æ•°æ³•
const avogadro = 6.022_140_76e23

// ä¸èƒ½æ”¾åœ¨ç‰¹æ®Šä½ç½®
// const bad = _1000; // é”™è¯¯
// const bad = 1000_; // é”™è¯¯
// const bad = 1__000; // é”™è¯¯
// const bad = 1._5; // é”™è¯¯
```

## Number æ–°å±æ€§

### Number.EPSILON

è¡¨ç¤º 1 ä¸å¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ä¹‹å·®ï¼š

```javascript
Number.EPSILON // 2.220446049250313e-16

// ç”¨äºæµ®ç‚¹æ•°æ¯”è¾ƒ
function equal(a, b) {
  return Math.abs(a - b) < Number.EPSILON
}

0.1 + 0.2 === 0.3 // false
equal(0.1 + 0.2, 0.3) // true
```

### Number.MAX_SAFE_INTEGER / MIN_SAFE_INTEGER

å®‰å…¨æ•´æ•°èŒƒå›´ï¼š

```javascript
Number.MAX_SAFE_INTEGER // 9007199254740991 (2^53 - 1)
Number.MIN_SAFE_INTEGER // -9007199254740991

// è¶…å‡ºèŒƒå›´ä¼šä¸¢å¤±ç²¾åº¦
9007199254740992 === 9007199254740993 // trueï¼ˆå±é™©ï¼ï¼‰
```

### Number.isFinite()

åˆ¤æ–­æ˜¯å¦ä¸ºæœ‰é™æ•°ï¼ˆä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼‰ï¼š

```javascript
// å…¨å±€ isFinite ä¼šè½¬æ¢ç±»å‹
isFinite('25') // true
isFinite(null) // true

// Number.isFinite ä¸è½¬æ¢
Number.isFinite('25') // false
Number.isFinite(null) // false
Number.isFinite(25) // true
Number.isFinite(Infinity) // false
Number.isFinite(NaN) // false
```

### Number.isNaN()

åˆ¤æ–­æ˜¯å¦ä¸º NaNï¼ˆä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼‰ï¼š

```javascript
// å…¨å±€ isNaN ä¼šè½¬æ¢ç±»å‹
isNaN('NaN') // trueï¼ˆå­—ç¬¦ä¸²è½¬æ¢åæ˜¯NaNï¼‰
isNaN(undefined) // true

// Number.isNaN ä¸è½¬æ¢
Number.isNaN('NaN') // false
Number.isNaN(undefined) // false
Number.isNaN(NaN) // true
```

### Number.isInteger()

åˆ¤æ–­æ˜¯å¦ä¸ºæ•´æ•°ï¼š

```javascript
Number.isInteger(25) // true
Number.isInteger(25.0) // true
Number.isInteger(25.1) // false
Number.isInteger('25') // false
Number.isInteger(null) // false
```

ğŸ”¶ æ³¨æ„ç²¾åº¦é—®é¢˜ï¼š

```javascript
Number.isInteger(3.0000000000000002) // trueï¼ˆç²¾åº¦ä¸¢å¤±ï¼‰
```

### Number.isSafeInteger()

åˆ¤æ–­æ˜¯å¦åœ¨å®‰å…¨æ•´æ•°èŒƒå›´å†…ï¼š

```javascript
Number.isSafeInteger(3) // true
Number.isSafeInteger(9007199254740991) // true
Number.isSafeInteger(9007199254740992) // false

// å®é™…åº”ç”¨ï¼šéªŒè¯è®¡ç®—ç»“æœ
function safeAdd(a, b) {
  if (!Number.isSafeInteger(a) || !Number.isSafeInteger(b)) {
    throw new Error('æ•°å€¼è¶…å‡ºå®‰å…¨èŒƒå›´')
  }
  const result = a + b
  if (!Number.isSafeInteger(result)) {
    throw new Error('è®¡ç®—ç»“æœè¶…å‡ºå®‰å…¨èŒƒå›´')
  }
  return result
}
```

### Number.parseInt() / parseFloat()

ä»å…¨å±€ç§»æ¤åˆ° Number å¯¹è±¡ï¼Œè¡Œä¸ºå®Œå…¨ä¸€è‡´ï¼š

```javascript
Number.parseInt('12.34') // 12
Number.parseFloat('12.34') // 12.34

// ä¸å…¨å±€æ–¹æ³•ç›¸åŒ
Number.parseInt === parseInt // true
Number.parseFloat === parseFloat // true
```

## Math æ‰©å±•

### Math.trunc()

å»é™¤å°æ•°éƒ¨åˆ†ï¼Œåªä¿ç•™æ•´æ•°ï¼š

```javascript
Math.trunc(4.9) // 4
Math.trunc(-4.9) // -4
Math.trunc(0.123) // 0

// ä¸å…¶ä»–å–æ•´æ–¹æ³•å¯¹æ¯”
const n = -4.7
Math.trunc(n) // -4ï¼ˆç›´æ¥æˆªæ–­ï¼‰
Math.floor(n) // -5ï¼ˆå‘ä¸‹å–æ•´ï¼‰
Math.ceil(n) // -4ï¼ˆå‘ä¸Šå–æ•´ï¼‰
Math.round(n) // -5ï¼ˆå››èˆäº”å…¥ï¼‰
```

### Math.sign()

åˆ¤æ–­æ•°å€¼çš„ç¬¦å·ï¼š

```javascript
Math.sign(5) // 1
Math.sign(-5) // -1
Math.sign(0) // 0
Math.sign(-0) // -0
Math.sign(NaN) // NaN
```

å®é™…åº”ç”¨ï¼š

```javascript
function compareNumbers(a, b) {
  const sign = Math.sign(a - b)
  if (sign === 1) return 'a > b'
  if (sign === -1) return 'a < b'
  return 'a = b'
}
```

### Math.cbrt()

è®¡ç®—ç«‹æ–¹æ ¹ï¼š

```javascript
Math.cbrt(8) // 2
Math.cbrt(-8) // -2
Math.cbrt(27) // 3
```

### Math.clz32()

è¿”å› 32 ä½æ•´æ•°å‰å¯¼é›¶çš„ä¸ªæ•°ï¼š

```javascript
Math.clz32(1) // 31ï¼ˆ0b00000000000000000000000000000001ï¼‰
Math.clz32(2) // 30ï¼ˆ0b00000000000000000000000000000010ï¼‰
Math.clz32(0) // 32

// è®¡ç®—æœ€é«˜ä½
function highestBit(n) {
  return 31 - Math.clz32(n)
}
highestBit(8) // 3ï¼ˆ2^3 = 8ï¼‰
```

### Math.imul()

32 ä½æ•´æ•°ä¹˜æ³•ï¼š

```javascript
// æ™®é€šä¹˜æ³•å¯èƒ½æº¢å‡º
0x7fffffff * 0x7fffffff // 4611686014132420600ï¼ˆä¸ç²¾ç¡®ï¼‰

// imul è¿”å›æ­£ç¡®çš„ 32 ä½ç»“æœ
Math.imul(0x7fffffff, 0x7fffffff) // 1
```

### Math.fround()

è¿”å›æœ€æ¥è¿‘çš„ 32 ä½å•ç²¾åº¦æµ®ç‚¹æ•°ï¼š

```javascript
Math.fround(1.337) // 1.3370000123977661
Math.fround(1.5) // 1.5ï¼ˆæ­£å¥½å¯ä»¥è¡¨ç¤ºï¼‰

// ç”¨äºæ¨¡æ‹Ÿ 32 ä½æµ®ç‚¹è¿ç®—
```

### Math.hypot()

è®¡ç®—æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼š

```javascript
// å‹¾è‚¡å®šç†
Math.hypot(3, 4) // 5

// ä¸‰ç»´è·ç¦»
Math.hypot(3, 4, 5) // 7.0710678118654755

// å®é™…åº”ç”¨ï¼šè®¡ç®—ä¸¤ç‚¹è·ç¦»
function distance(p1, p2) {
  return Math.hypot(p2.x - p1.x, p2.y - p1.y)
}
distance({ x: 0, y: 0 }, { x: 3, y: 4 }) // 5
```

### å¯¹æ•°æ–¹æ³•

```javascript
// ä»¥ e ä¸ºåº•
Math.expm1(1) // e^1 - 1 = 1.718...
Math.log1p(Math.E - 1) // ln(e) = 1

// ä»¥ 10 ä¸ºåº•
Math.log10(100) // 2

// ä»¥ 2 ä¸ºåº•
Math.log2(8) // 3

// å®é™…åº”ç”¨ï¼šè®¡ç®—æ•°å­—ä½æ•°
function digitCount(n) {
  return Math.floor(Math.log10(Math.abs(n))) + 1
}
digitCount(12345) // 5
```

### åŒæ›²å‡½æ•°

```javascript
Math.sinh(x) // åŒæ›²æ­£å¼¦
Math.cosh(x) // åŒæ›²ä½™å¼¦
Math.tanh(x) // åŒæ›²æ­£åˆ‡
Math.asinh(x) // ååŒæ›²æ­£å¼¦
Math.acosh(x) // ååŒæ›²ä½™å¼¦
Math.atanh(x) // ååŒæ›²æ­£åˆ‡
```

## å®æˆ˜åº”ç”¨

### é‡‘é¢è®¡ç®—

```javascript
// é¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ï¼Œè½¬ä¸ºæ•´æ•°è®¡ç®—
function add(a, b) {
  const factor = 100
  return (Math.round(a * factor) + Math.round(b * factor)) / factor
}

add(0.1, 0.2) // 0.3

// æ›´é€šç”¨çš„æ–¹æ¡ˆ
function safeCalculate(a, b, operation) {
  const aStr = String(a)
  const bStr = String(b)
  const aDecimals = (aStr.split('.')[1] || '').length
  const bDecimals = (bStr.split('.')[1] || '').length
  const factor = Math.pow(10, Math.max(aDecimals, bDecimals))

  const aInt = Math.round(a * factor)
  const bInt = Math.round(b * factor)

  switch (operation) {
    case '+':
      return (aInt + bInt) / factor
    case '-':
      return (aInt - bInt) / factor
    case '*':
      return (aInt * bInt) / (factor * factor)
    case '/':
      return aInt / bInt
    default:
      throw new Error('Unknown operation')
  }
}
```

### æ•°å­—æ ¼å¼åŒ–

```javascript
// åƒåˆ†ä½åˆ†éš”
function formatNumber(num) {
  return num.toLocaleString('zh-CN')
}
formatNumber(1234567.89) // '1,234,567.89'

// ä¿ç•™æŒ‡å®šå°æ•°ä½
function toFixed(num, decimals) {
  const factor = Math.pow(10, decimals)
  return Math.round(num * factor) / factor
}
toFixed(3.14159, 2) // 3.14

// ç™¾åˆ†æ¯”
function toPercent(num, decimals = 2) {
  return (num * 100).toFixed(decimals) + '%'
}
toPercent(0.1234) // '12.34%'
```

### èŒƒå›´é™åˆ¶

```javascript
function clamp(value, min, max) {
  return Math.min(Math.max(value, min), max)
}

clamp(5, 0, 10) // 5
clamp(-5, 0, 10) // 0
clamp(15, 0, 10) // 10

// å®é™…åº”ç”¨ï¼šæ»‘å—å€¼ã€éŸ³é‡æ§åˆ¶ç­‰
```

### éšæœºæ•°

```javascript
// æŒ‡å®šèŒƒå›´çš„æ•´æ•°
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min
}

// éšæœºæ•°ç»„å…ƒç´ 
function randomItem(arr) {
  return arr[randomInt(0, arr.length - 1)]
}

// ç”Ÿæˆéšæœº ID
function randomId(length = 8) {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'
  return Array.from({ length }, () => randomItem(chars.split(''))).join('')
}
```

## å°ç»“

| ç±»åˆ«        | æ–°å¢å†…å®¹                                                                 |
| ----------- | ------------------------------------------------------------------------ |
| å­—é¢é‡      | `0b`ï¼ˆäºŒè¿›åˆ¶ï¼‰ã€`0o`ï¼ˆå…«è¿›åˆ¶ï¼‰ã€`_`ï¼ˆåˆ†éš”ç¬¦ï¼‰                            |
| Number å±æ€§ | EPSILONã€MAX_SAFE_INTEGERã€MIN_SAFE_INTEGER                              |
| Number æ–¹æ³• | isFiniteã€isNaNã€isIntegerã€isSafeIntegerã€parseIntã€parseFloat          |
| Math æ–¹æ³•   | truncã€signã€cbrtã€clz32ã€imulã€froundã€hypotã€expm1ã€log1pã€log10ã€log2 |

è¿™äº›æ‰©å±•è®©æ•°å€¼å¤„ç†æ›´åŠ ç²¾ç¡®å’Œä¾¿æ·ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ç²¾åº¦æ•æ„Ÿçš„é‡‘èè®¡ç®—æ—¶ï¼Œè¦æ ¼å¤–æ³¨æ„æµ®ç‚¹æ•°çš„ç²¾åº¦é—®é¢˜ã€‚
