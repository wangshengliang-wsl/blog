---
title: 'Object æ–°å¢æ–¹æ³•'
description: 'è¯¦è§£ ES6+ Object é™æ€æ–¹æ³•ï¼šassignã€keysã€valuesã€entriesã€fromEntries ç­‰'
pubDate: 2024-01-17
toc: true
ogImage: true
category: 'ES6+'
tags: ['ES6', 'Object', 'assign', 'entries', 'fromEntries']
---

ES6 åŠåç»­ç‰ˆæœ¬ä¸º Object æ·»åŠ äº†è®¸å¤šå®ç”¨çš„é™æ€æ–¹æ³•ã€‚

## Object.assign()

å°†æºå¯¹è±¡çš„å¯æšä¸¾å±æ€§å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼š

```javascript
const target = { a: 1 }
const source1 = { b: 2 }
const source2 = { c: 3 }

const result = Object.assign(target, source1, source2)
console.log(result) // { a: 1, b: 2, c: 3 }
console.log(target) // { a: 1, b: 2, c: 3 }ï¼ˆtarget è¢«ä¿®æ”¹ï¼‰
console.log(result === target) // true
```

### åŸºæœ¬ç‰¹æ€§

```javascript
// åŒåå±æ€§åé¢è¦†ç›–å‰é¢
Object.assign({ a: 1 }, { a: 2 }, { a: 3 }) // { a: 3 }

// åªå¤åˆ¶è‡ªæœ‰å¯æšä¸¾å±æ€§
const obj = Object.create({ inherited: true })
obj.own = true
Object.defineProperty(obj, 'nonEnum', {
  value: 'hidden',
  enumerable: false,
})
Object.assign({}, obj) // { own: true }

// æµ…å¤åˆ¶
const original = { nested: { value: 1 } }
const copy = Object.assign({}, original)
copy.nested.value = 2
console.log(original.nested.value) // 2ï¼ˆè¢«å½±å“äº†ï¼‰
```

### å®é™…åº”ç”¨

```javascript
// åˆå¹¶é…ç½®
function createServer(options) {
  const defaults = { port: 3000, host: 'localhost' }
  const config = Object.assign({}, defaults, options)
  return config
}

// å…‹éš†å¯¹è±¡ï¼ˆæµ…å¤åˆ¶ï¼‰
const clone = Object.assign({}, original)

// å¯¹è±¡æ··å…¥
function mixin(target, ...sources) {
  return Object.assign(target, ...sources)
}
```

ğŸ”¶ æ³¨æ„ï¼šæ›´æ¨èä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼š

```javascript
// Object.assign
const merged = Object.assign({}, obj1, obj2)

// æ‰©å±•è¿ç®—ç¬¦ï¼ˆæ›´ç®€æ´ï¼Œä¸”ä¸ä¿®æ”¹ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼‰
const merged2 = { ...obj1, ...obj2 }
```

## Object.is()

åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒï¼Œè§£å†³äº† `===` çš„ç‰¹æ®Šæƒ…å†µï¼š

```javascript
// === çš„é—®é¢˜
;+0 === -0 // true
NaN === NaN // false

// Object.is ä¿®å¤äº†è¿™äº›
Object.is(+0, -0) // false
Object.is(NaN, NaN) // true

// å…¶ä»–æƒ…å†µä¸ === ç›¸åŒ
Object.is(1, 1) // true
Object.is('a', 'a') // true
Object.is({}, {}) // falseï¼ˆä¸åŒå¼•ç”¨ï¼‰
```

## Object.keys() / values() / entries()

è·å–å¯¹è±¡çš„é”®ã€å€¼ã€é”®å€¼å¯¹æ•°ç»„ï¼š

```javascript
const obj = { a: 1, b: 2, c: 3 }

Object.keys(obj) // ['a', 'b', 'c']
Object.values(obj) // [1, 2, 3]
Object.entries(obj) // [['a', 1], ['b', 2], ['c', 3]]
```

### éå†å¯¹è±¡

```javascript
const user = { name: 'å¼ ä¸‰', age: 25, city: 'åŒ—äº¬' }

// éå†é”®
Object.keys(user).forEach((key) => {
  console.log(key)
})

// éå†å€¼
Object.values(user).forEach((value) => {
  console.log(value)
})

// éå†é”®å€¼å¯¹
Object.entries(user).forEach(([key, value]) => {
  console.log(`${key}: ${value}`)
})

// for...of + è§£æ„
for (const [key, value] of Object.entries(user)) {
  console.log(`${key}: ${value}`)
}
```

### å¯¹è±¡è½¬ Map

```javascript
const obj = { a: 1, b: 2 }
const map = new Map(Object.entries(obj))
console.log(map) // Map { 'a' => 1, 'b' => 2 }
```

## Object.fromEntries()

ES2019 æ–°å¢ï¼Œ`entries` çš„é€†æ“ä½œï¼š

```javascript
// ä»é”®å€¼å¯¹æ•°ç»„åˆ›å»ºå¯¹è±¡
const entries = [
  ['a', 1],
  ['b', 2],
  ['c', 3],
]
Object.fromEntries(entries) // { a: 1, b: 2, c: 3 }

// Map è½¬å¯¹è±¡
const map = new Map([
  ['name', 'å¼ ä¸‰'],
  ['age', 25],
])
Object.fromEntries(map) // { name: 'å¼ ä¸‰', age: 25 }
```

### å®é™…åº”ç”¨

```javascript
// è¿‡æ»¤å¯¹è±¡å±æ€§
const obj = { a: 1, b: 2, c: 3, d: 4 }
const filtered = Object.fromEntries(
  Object.entries(obj).filter(([key, value]) => value > 2)
)
// { c: 3, d: 4 }

// è½¬æ¢å¯¹è±¡å€¼
const prices = { apple: 1.5, banana: 2.0, orange: 1.8 }
const discounted = Object.fromEntries(
  Object.entries(prices).map(([fruit, price]) => [fruit, price * 0.9])
)
// { apple: 1.35, banana: 1.8, orange: 1.62 }

// URL å‚æ•°è§£æ
const params = new URLSearchParams('name=å¼ ä¸‰&age=25')
Object.fromEntries(params) // { name: 'å¼ ä¸‰', age: '25' }
```

## Object.getOwnPropertyDescriptors()

è·å–å¯¹è±¡æ‰€æœ‰è‡ªæœ‰å±æ€§çš„æè¿°ç¬¦ï¼š

```javascript
const obj = {
  name: 'å¼ ä¸‰',
  get fullName() {
    return this.name
  },
}

Object.getOwnPropertyDescriptors(obj)
// {
//   name: {
//     value: 'å¼ ä¸‰',
//     writable: true,
//     enumerable: true,
//     configurable: true
//   },
//   fullName: {
//     get: [Function: get fullName],
//     set: undefined,
//     enumerable: true,
//     configurable: true
//   }
// }
```

### å®Œæ•´å¤åˆ¶å¯¹è±¡

`Object.assign` æ— æ³•æ­£ç¡®å¤åˆ¶ getter/setterï¼š

```javascript
const source = {
  get foo() {
    return 'foo'
  },
}

// assign å¤åˆ¶çš„æ˜¯å€¼ï¼Œä¸æ˜¯ getter
const copy1 = Object.assign({}, source)
Object.getOwnPropertyDescriptor(copy1, 'foo')
// { value: 'foo', writable: true, ... }

// ä½¿ç”¨ getOwnPropertyDescriptors ä¿æŒ getter
const copy2 = Object.defineProperties(
  {},
  Object.getOwnPropertyDescriptors(source)
)
Object.getOwnPropertyDescriptor(copy2, 'foo')
// { get: [Function], set: undefined, ... }
```

## Object.hasOwn()

ES2022 æ–°å¢ï¼Œæ›¿ä»£ `hasOwnProperty`ï¼š

```javascript
const obj = { name: 'å¼ ä¸‰' }

// ä¼ ç»Ÿæ–¹å¼
obj.hasOwnProperty('name') // true
Object.prototype.hasOwnProperty.call(obj, 'name') // trueï¼ˆæ›´å®‰å…¨ï¼‰

// ES2022
Object.hasOwn(obj, 'name') // true
Object.hasOwn(obj, 'toString') // falseï¼ˆç»§æ‰¿å±æ€§ï¼‰

// å¤„ç†ç‰¹æ®Šå¯¹è±¡
const nullProto = Object.create(null)
nullProto.name = 'å¼ ä¸‰'
// nullProto.hasOwnProperty('name'); // TypeError
Object.hasOwn(nullProto, 'name') // true âœ…
```

## Object.groupBy()

ES2024 æ–°å¢ï¼ŒæŒ‰æ¡ä»¶åˆ†ç»„ï¼š

```javascript
const people = [
  { name: 'å¼ ä¸‰', age: 25 },
  { name: 'æå››', age: 30 },
  { name: 'ç‹äº”', age: 25 },
]

// æŒ‰å¹´é¾„åˆ†ç»„
Object.groupBy(people, (person) => person.age)
// {
//   25: [{ name: 'å¼ ä¸‰', age: 25 }, { name: 'ç‹äº”', age: 25 }],
//   30: [{ name: 'æå››', age: 30 }]
// }

// æŒ‰æ¡ä»¶åˆ†ç»„
Object.groupBy(people, (person) => (person.age >= 30 ? 'senior' : 'junior'))
// {
//   junior: [{ name: 'å¼ ä¸‰', age: 25 }, { name: 'ç‹äº”', age: 25 }],
//   senior: [{ name: 'æå››', age: 30 }]
// }
```

## setPrototypeOf / getPrototypeOf

æ“ä½œå¯¹è±¡åŸå‹ï¼š

```javascript
const proto = {
  greet() {
    return 'Hello'
  },
}
const obj = { name: 'å¼ ä¸‰' }

// è®¾ç½®åŸå‹
Object.setPrototypeOf(obj, proto)
obj.greet() // 'Hello'

// è·å–åŸå‹
Object.getPrototypeOf(obj) === proto // true
```

ğŸ”¶ æ³¨æ„ï¼š`setPrototypeOf` æ€§èƒ½è¾ƒå·®ï¼Œåº”é¿å…é¢‘ç¹ä½¿ç”¨ã€‚

## å®æˆ˜åº”ç”¨

### å¯¹è±¡æ·±åº¦æ¯”è¾ƒ

```javascript
function deepEqual(obj1, obj2) {
  if (Object.is(obj1, obj2)) return true
  if (typeof obj1 !== 'object' || typeof obj2 !== 'object') return false
  if (obj1 === null || obj2 === null) return false

  const keys1 = Object.keys(obj1)
  const keys2 = Object.keys(obj2)

  if (keys1.length !== keys2.length) return false

  return keys1.every(
    (key) => Object.hasOwn(obj2, key) && deepEqual(obj1[key], obj2[key])
  )
}
```

### å¯¹è±¡è½¬æ¢

```javascript
// æ‰€æœ‰å€¼è½¬å¤§å†™
function mapValues(obj, fn) {
  return Object.fromEntries(
    Object.entries(obj).map(([key, value]) => [key, fn(value)])
  )
}

mapValues({ a: 'hello', b: 'world' }, (v) => v.toUpperCase())
// { a: 'HELLO', b: 'WORLD' }

// é‡å‘½åé”®
function renameKeys(obj, keyMap) {
  return Object.fromEntries(
    Object.entries(obj).map(([key, value]) => [keyMap[key] || key, value])
  )
}

renameKeys({ name: 'å¼ ä¸‰', age: 25 }, { name: 'username' })
// { username: 'å¼ ä¸‰', age: 25 }
```

### å¯¹è±¡ pick / omit

```javascript
function pick(obj, keys) {
  return Object.fromEntries(
    keys.filter((key) => Object.hasOwn(obj, key)).map((key) => [key, obj[key]])
  )
}

function omit(obj, keys) {
  const keySet = new Set(keys)
  return Object.fromEntries(
    Object.entries(obj).filter(([key]) => !keySet.has(key))
  )
}

const user = { id: 1, name: 'å¼ ä¸‰', password: '123' }
pick(user, ['id', 'name']) // { id: 1, name: 'å¼ ä¸‰' }
omit(user, ['password']) // { id: 1, name: 'å¼ ä¸‰' }
```

## æ–¹æ³•æ±‡æ€»

| æ–¹æ³•                               | ç‰ˆæœ¬   | ä½œç”¨               |
| ---------------------------------- | ------ | ------------------ |
| Object.assign()                    | ES6    | å¤åˆ¶/åˆå¹¶å¯¹è±¡      |
| Object.is()                        | ES6    | ä¸¥æ ¼ç›¸ç­‰æ¯”è¾ƒ       |
| Object.keys()                      | ES5.1  | è·å–é”®æ•°ç»„         |
| Object.values()                    | ES2017 | è·å–å€¼æ•°ç»„         |
| Object.entries()                   | ES2017 | è·å–é”®å€¼å¯¹æ•°ç»„     |
| Object.fromEntries()               | ES2019 | é”®å€¼å¯¹æ•°ç»„è½¬å¯¹è±¡   |
| Object.getOwnPropertyDescriptors() | ES2017 | è·å–æ‰€æœ‰å±æ€§æè¿°ç¬¦ |
| Object.hasOwn()                    | ES2022 | æ£€æŸ¥è‡ªæœ‰å±æ€§       |
| Object.groupBy()                   | ES2024 | æŒ‰æ¡ä»¶åˆ†ç»„         |
