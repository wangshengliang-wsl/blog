---
title: ES9 ä¸ ES10 æ–°ç‰¹æ€§
description: ES2018 å¢å¼ºæ­£åˆ™è¡¨è¾¾å¼å’Œ Promiseï¼ŒES2019 å¸¦æ¥æ•°ç»„æ‰å¹³åŒ–ã€Object.fromEntries ç­‰å®ç”¨æ–¹æ³•
pubDate: 2025-11-28
toc: true
ogImage: true
category: ES6+
---

ES9 (2018) å’Œ ES10 (2019) ç»§ç»­å®Œå–„ JavaScript çš„åŸºç¡€èƒ½åŠ›ã€‚ES9 å¯¹æ­£åˆ™è¡¨è¾¾å¼åšäº†å¤§å¹…å¢å¼ºï¼ŒES10 åˆ™å¸¦æ¥äº†ä¸€ç³»åˆ—å®ç”¨çš„æ•°ç»„å’Œå¯¹è±¡æ–¹æ³•ã€‚

## ES9 (ES2018)

### Promise.prototype.finally()

`finally` æ–¹æ³•åœ¨ Promise ç»“æŸæ—¶ï¼ˆæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰éƒ½ä¼šæ‰§è¡Œï¼Œé€‚åˆç”¨äºæ¸…ç†æ“ä½œï¼š

```javascript
let loading = true

fetch('/api/data')
  .then((res) => res.json())
  .then((data) => {
    console.log(data)
  })
  .catch((err) => {
    console.error(err)
  })
  .finally(() => {
    loading = false // æ— è®ºæˆåŠŸå¤±è´¥ï¼Œéƒ½å…³é—­ loading
  })
```

`finally` ä¸æ¥æ”¶å‚æ•°ï¼Œä¹Ÿä¸ä¼šæ”¹å˜ Promise çš„è¿”å›å€¼ï¼š

```javascript
Promise.resolve(2)
  .finally(() => {
    return 10 // è¿”å›å€¼è¢«å¿½ç•¥
  })
  .then((val) => console.log(val)) // 2

Promise.reject(new Error('fail'))
  .finally(() => {})
  .catch((err) => console.log(err.message)) // 'fail'
```

ä½†å¦‚æœ `finally` ä¸­æŠ›å‡ºé”™è¯¯æˆ–è¿”å› rejected Promiseï¼Œä¼šæ”¹å˜ç»“æœï¼š

```javascript
Promise.resolve(1)
  .finally(() => {
    throw new Error('finally error')
  })
  .catch((err) => console.log(err.message)) // 'finally error'

Promise.resolve(1)
  .finally(() => Promise.reject('rejected in finally'))
  .catch((err) => console.log(err)) // 'rejected in finally'
```

### å¯¹è±¡çš„ Rest/Spread å±æ€§

ES6 ä¸ºæ•°ç»„å¼•å…¥äº† rest å‚æ•°å’Œ spread è¿ç®—ç¬¦ï¼ŒES9 å°†è¿™ä¸¤ä¸ªç‰¹æ€§æ‰©å±•åˆ°äº†å¯¹è±¡ã€‚

**å¯¹è±¡ Spread**

å±•å¼€å¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼š

```javascript
const base = { a: 1, b: 2 }
const extended = { ...base, c: 3 }
// { a: 1, b: 2, c: 3 }

// åé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„
const overwrite = { ...base, b: 10 }
// { a: 1, b: 10 }

// åˆå¹¶å¤šä¸ªå¯¹è±¡
const merged = { ...obj1, ...obj2, ...obj3 }
```

å¸¸è§ç”¨é€”ï¼š

```javascript
// æµ…æ‹·è´
const copy = { ...original }

// åˆå¹¶é»˜è®¤é…ç½®
const config = {
  ...defaultConfig,
  ...userConfig,
}

// æ›´æ–°å¯¹è±¡å±æ€§ï¼ˆä¸å¯å˜æ›´æ–°ï¼‰
const newState = {
  ...state,
  count: state.count + 1,
}

// æ¡ä»¶æ·»åŠ å±æ€§
const user = {
  name: 'å¼ ä¸‰',
  ...(isAdmin && { role: 'admin' }),
}
```

**å¯¹è±¡ Rest**

åœ¨è§£æ„æ—¶æ”¶é›†å‰©ä½™å±æ€§ï¼š

```javascript
const { a, ...rest } = { a: 1, b: 2, c: 3 }
// a = 1
// rest = { b: 2, c: 3 }
```

å¸¸è§ç”¨é€”ï¼š

```javascript
// æå–ç‰¹å®šå±æ€§ï¼Œä¿ç•™å…¶ä½™
const { password, ...safeUser } = user

// å‡½æ•°å‚æ•°è§£æ„
function process({ id, ...options }) {
  console.log(id) // æå– id
  console.log(options) // å…¶ä½™å‚æ•°
}

// ç§»é™¤å¯¹è±¡å±æ€§ï¼ˆä¸å¯å˜æ–¹å¼ï¼‰
const { unwanted, ...cleaned } = obj
```

### æ­£åˆ™è¡¨è¾¾å¼å¢å¼º

ES9 å¯¹æ­£åˆ™è¡¨è¾¾å¼åšäº†å››é¡¹é‡è¦å¢å¼ºã€‚

**å‘½åæ•è·ç»„**

ä¹‹å‰çš„æ•è·ç»„åªèƒ½é€šè¿‡æ•°å­—ç´¢å¼•è®¿é—®ï¼Œå‘½åæ•è·ç»„ç”¨ `(?<name>...)` è¯­æ³•ç»™æ•è·ç»„å‘½åï¼š

```javascript
// æ—§æ–¹å¼ï¼šæ•°å­—ç´¢å¼•
const dateRegex = /(\d{4})-(\d{2})-(\d{2})/
const match = dateRegex.exec('2024-03-15')
match[1] // '2024'
match[2] // '03'
match[3] // '15'

// æ–°æ–¹å¼ï¼šå‘½åæ•è·ç»„
const namedRegex = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
const result = namedRegex.exec('2024-03-15')
result.groups.year // '2024'
result.groups.month // '03'
result.groups.day // '15'
```

é…åˆ `replace` ä½¿ç”¨ï¼š

```javascript
const dateRegex = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/

// $<name> å¼•ç”¨å‘½åæ•è·ç»„
'2024-03-15'.replace(dateRegex, '$<day>/$<month>/$<year>')
// '15/03/2024'

// æ›¿æ¢å‡½æ•°ä¸­ä½¿ç”¨ groups
'2024-03-15'.replace(dateRegex, (...args) => {
  const { year, month, day } = args.at(-1) // groups æ˜¯æœ€åä¸€ä¸ªå‚æ•°
  return `${year}å¹´${month}æœˆ${day}æ—¥`
})
// '2024å¹´03æœˆ15æ—¥'
```

**åè¡Œæ–­è¨€ (Lookbehind Assertions)**

ES6 å·²ç»æ”¯æŒå…ˆè¡Œæ–­è¨€ï¼ˆlookaheadï¼‰ï¼ŒES9 æ·»åŠ äº†åè¡Œæ–­è¨€ï¼š

```javascript
// å…ˆè¡Œæ–­è¨€ï¼šåŒ¹é…åé¢è·Ÿç€ç‰¹å®šå†…å®¹çš„ä½ç½®
/x(?=y)/ // åŒ¹é…åé¢æ˜¯ y çš„ x
/x(?!y)/ // åŒ¹é…åé¢ä¸æ˜¯ y çš„ x

// åè¡Œæ–­è¨€ï¼šåŒ¹é…å‰é¢æ˜¯ç‰¹å®šå†…å®¹çš„ä½ç½®
/(?<=y)x/ // åŒ¹é…å‰é¢æ˜¯ y çš„ x
/(?<!y)x/ // åŒ¹é…å‰é¢ä¸æ˜¯ y çš„ x
```

```javascript
// åŒ¹é…ç¾å…ƒé‡‘é¢çš„æ•°å­—éƒ¨åˆ†
const price = '$100'
price.match(/(?<=\$)\d+/)[0] // '100'

// åŒ¹é…ä¸ä»¥ $ å¼€å¤´çš„æ•°å­—
'â‚¬50 $100'.match(/(?<!\$)\d+/g) // ['50']

// æå– HTML æ ‡ç­¾å†…å®¹
const html = '<span>hello</span>'
html.match(/(?<=<span>).*(?=<\/span>)/)[0] // 'hello'
```

**dotAll æ¨¡å¼ (s æ ‡å¿—)**

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`.` ä¸åŒ¹é…æ¢è¡Œç¬¦ã€‚`s` æ ‡å¿—è®© `.` åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼š

```javascript
// é»˜è®¤ï¼š. ä¸åŒ¹é…æ¢è¡Œç¬¦
;/hello.world/.test('hello\nworld') / // false
  // s æ ‡å¿—ï¼š. åŒ¹é…ä»»æ„å­—ç¬¦
  hello.world /
  s.test('hello\nworld') // true

// å®é™…åº”ç”¨ï¼šåŒ¹é…å¤šè¡Œ HTML
const html = `<div>
  content
</div>`

html.match(/<div>.*<\/div>/s)[0]
// '<div>\n  content\n</div>'
```

æ£€æŸ¥æ­£åˆ™æ˜¯å¦å¯ç”¨äº† `s` æ ‡å¿—ï¼š

```javascript
const regex = /./s
regex.dotAll // true
regex.flags // 's'
```

**Unicode å±æ€§è½¬ä¹‰**

é€šè¿‡ `\p{...}` å’Œ `\P{...}` åŒ¹é… Unicode å­—ç¬¦å±æ€§ï¼Œéœ€è¦é…åˆ `u` æ ‡å¿—ä½¿ç”¨ï¼š

```javascript
// åŒ¹é…ä»»æ„å­—æ¯ï¼ˆåŒ…æ‹¬ä¸­æ–‡ã€æ—¥æ–‡ç­‰ï¼‰
/\p{Letter}/u.test('ä¸­') // true
/\p{Letter}/u.test('A') // true
/\p{Letter}/u.test('1') // false

// ç®€å†™å½¢å¼
/\p{L}/u.test('å­—') // true

// åŒ¹é…ä¸­æ–‡å­—ç¬¦
/\p{Script=Han}/u.test('ä¸­') // true
/\p{Script=Han}/u.test('ã‚') // falseï¼ˆæ—¥æ–‡ï¼‰

// åŒ¹é…æ•°å­—
/\p{Number}/u.test('â‘ ') // true
/\p{Number}/u.test('5') // true

// åŒ¹é… emoji
/\p{Emoji}/u.test('ğŸ˜€') // true

// \P æ˜¯ \p çš„å¦å®š
/\P{Number}/u.test('a') // true
/\P{Number}/u.test('5') // false
```

å¸¸ç”¨ Unicode å±æ€§ï¼š

| å±æ€§                | è¯´æ˜           |
| ------------------- | -------------- |
| `Letter` / `L`      | ä»»æ„è¯­è¨€çš„å­—æ¯ |
| `Number` / `N`      | ä»»æ„æ•°å­—       |
| `Punctuation` / `P` | æ ‡ç‚¹ç¬¦å·       |
| `Script=Han`        | æ±‰å­—           |
| `Script=Hiragana`   | æ—¥æ–‡å¹³å‡å     |
| `Emoji`             | Emoji å­—ç¬¦     |

## ES10 (ES2019)

### Array.prototype.flat()

`flat()` å°†åµŒå¥—æ•°ç»„"å±•å¹³"ï¼Œé»˜è®¤å±•å¹³ä¸€å±‚ï¼š

```javascript
const nested = [1, [2, 3], [4, [5, 6]]]

nested.flat() // [1, 2, 3, 4, [5, 6]]
nested.flat(2) // [1, 2, 3, 4, 5, 6]

// ä½¿ç”¨ Infinity å±•å¹³ä»»æ„æ·±åº¦
const deep = [1, [2, [3, [4, [5]]]]]
deep.flat(Infinity) // [1, 2, 3, 4, 5]
```

`flat()` ä¼šç§»é™¤æ•°ç»„ä¸­çš„ç©ºä½ï¼š

```javascript
const sparse = [1, , 3, , 5]
sparse.flat() // [1, 3, 5]

// æ³¨æ„ï¼šåªç§»é™¤ç©ºä½ï¼Œä¸ç§»é™¤ undefined
const withUndefined = [1, undefined, 3]
withUndefined.flat() // [1, undefined, 3]
```

### Array.prototype.flatMap()

`flatMap()` ç›¸å½“äº `map()` åå† `flat(1)`ï¼Œä½†æ›´é«˜æ•ˆï¼š

```javascript
const sentences = ['Hello World', 'Goodbye Moon']

// map + flat
sentences.map((s) => s.split(' ')).flat()
// ['Hello', 'World', 'Goodbye', 'Moon']

// flatMap ä¸€æ­¥åˆ°ä½
sentences.flatMap((s) => s.split(' '))
// ['Hello', 'World', 'Goodbye', 'Moon']
```

å¸¸è§ç”¨é€”ï¼š

```javascript
// è¿‡æ»¤å¹¶è½¬æ¢
const nums = [1, 2, 3, 4, 5]
nums.flatMap((n) => (n % 2 === 0 ? [n * 2] : []))
// [4, 8]ï¼Œåªä¿ç•™å¶æ•°å¹¶ä¹˜ 2

// ä¸€å¯¹å¤šæ˜ å°„
const users = [{ name: 'å¼ ä¸‰', tags: ['dev', 'js'] }]
users.flatMap((u) => u.tags.map((tag) => ({ user: u.name, tag })))
// [{ user: 'å¼ ä¸‰', tag: 'dev' }, { user: 'å¼ ä¸‰', tag: 'js' }]

// å±•å¼€å¯é€‰å€¼
const items = [{ value: 1 }, { value: null }, { value: 3 }]
items.flatMap((item) => (item.value !== null ? [item.value] : []))
// [1, 3]
```

### Object.fromEntries()

`Object.fromEntries()` æ˜¯ `Object.entries()` çš„é€†æ“ä½œï¼Œå°†é”®å€¼å¯¹æ•°ç»„è½¬ä¸ºå¯¹è±¡ï¼š

```javascript
const entries = [
  ['name', 'å¼ ä¸‰'],
  ['age', 25],
]
Object.fromEntries(entries)
// { name: 'å¼ ä¸‰', age: 25 }
```

ä»»ä½•å¯è¿­ä»£çš„é”®å€¼å¯¹ç»“æ„éƒ½å¯ä»¥è½¬æ¢ï¼š

```javascript
// Map è½¬å¯¹è±¡
const map = new Map([
  ['a', 1],
  ['b', 2],
])
Object.fromEntries(map) // { a: 1, b: 2 }

// URLSearchParams è½¬å¯¹è±¡
const params = new URLSearchParams('name=å¼ ä¸‰&age=25')
Object.fromEntries(params) // { name: 'å¼ ä¸‰', age: '25' }
```

é…åˆ `Object.entries()` å®ç°å¯¹è±¡è½¬æ¢ï¼š

```javascript
const obj = { a: 1, b: 2, c: 3 }

// è¿‡æ»¤å¯¹è±¡å±æ€§
Object.fromEntries(Object.entries(obj).filter(([k, v]) => v > 1))
// { b: 2, c: 3 }

// è½¬æ¢å¯¹è±¡å€¼
Object.fromEntries(Object.entries(obj).map(([k, v]) => [k, v * 2]))
// { a: 2, b: 4, c: 6 }

// é”®åè½¬æ¢
Object.fromEntries(Object.entries(obj).map(([k, v]) => [k.toUpperCase(), v]))
// { A: 1, B: 2, C: 3 }
```

### String.prototype.trimStart() / trimEnd()

å®šå‘å»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦ï¼š

```javascript
const str = '   hello world   '

str.trim() // 'hello world'
str.trimStart() // 'hello world   '
str.trimEnd() // '   hello world'
```

`trimLeft()` å’Œ `trimRight()` æ˜¯å®ƒä»¬çš„åˆ«åï¼š

```javascript
str.trimStart() === str.trimLeft() // true
str.trimEnd() === str.trimRight() // true
```

å¤„ç†çš„ç©ºç™½å­—ç¬¦åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼š

```javascript
const multiline = '\n\t hello \n\t'

multiline.trimStart() // 'hello \n\t'
multiline.trimEnd() // '\n\t hello'
```

### Symbol.prototype.description

ç›´æ¥è·å– Symbol çš„æè¿°å­—ç¬¦ä¸²ï¼š

```javascript
const sym = Symbol('my symbol')

// ES9 ä¹‹å‰ï¼šéœ€è¦è½¬å­—ç¬¦ä¸²åè§£æ
String(sym) // 'Symbol(my symbol)'
sym.toString() // 'Symbol(my symbol)'

// ES10ï¼šç›´æ¥è·å–æè¿°
sym.description // 'my symbol'
```

æ²¡æœ‰æè¿°çš„ Symbol è¿”å› `undefined`ï¼š

```javascript
Symbol().description // undefined
Symbol('').description // ''
```

### å¯é€‰çš„ catch ç»‘å®š

ES10 å…è®¸ `catch` çœç•¥é”™è¯¯å‚æ•°ï¼š

```javascript
// ES9 ä¹‹å‰ï¼šå¿…é¡»å†™å‚æ•°ï¼Œå³ä½¿ä¸ä½¿ç”¨
try {
  JSON.parse(str)
} catch (e) {
  // e æ²¡æœ‰ä½¿ç”¨ï¼Œä½†å¿…é¡»å£°æ˜
  return null
}

// ES10ï¼šå¯ä»¥çœç•¥å‚æ•°
try {
  JSON.parse(str)
} catch {
  return null
}
```

åœ¨åªéœ€è¦çŸ¥é“æ˜¯å¦å‡ºé”™ã€ä¸å…³å¿ƒå…·ä½“é”™è¯¯æ—¶å¾ˆæœ‰ç”¨ï¼š

```javascript
function isValidJSON(str) {
  try {
    JSON.parse(str)
    return true
  } catch {
    return false
  }
}
```

### Array.prototype.sort() ç¨³å®šæ€§

ES10 è§„èŒƒè¦æ±‚ `Array.prototype.sort()` å¿…é¡»æ˜¯ç¨³å®šæ’åºã€‚ç¨³å®šæ’åºæ„å‘³ç€ç›¸ç­‰å…ƒç´ çš„ç›¸å¯¹é¡ºåºä¿æŒä¸å˜ï¼š

```javascript
const items = [
  { name: 'A', score: 80 },
  { name: 'B', score: 90 },
  { name: 'C', score: 80 },
  { name: 'D', score: 90 },
]

// æŒ‰åˆ†æ•°æ’åº
items.sort((a, b) => a.score - b.score)

// ç¨³å®šæ’åºä¿è¯ï¼š
// - A ä»ç„¶åœ¨ C å‰é¢ï¼ˆéƒ½æ˜¯ 80 åˆ†ï¼‰
// - B ä»ç„¶åœ¨ D å‰é¢ï¼ˆéƒ½æ˜¯ 90 åˆ†ï¼‰
// [{ name: 'A', score: 80 }, { name: 'C', score: 80 },
//  { name: 'B', score: 90 }, { name: 'D', score: 90 }]
```

åœ¨ ES10 ä¹‹å‰ï¼ŒV8 å¼•æ“å¯¹è¶…è¿‡ 10 ä¸ªå…ƒç´ çš„æ•°ç»„ä½¿ç”¨å¿«é€Ÿæ’åºï¼ˆä¸ç¨³å®šï¼‰ï¼Œç°åœ¨ç»Ÿä¸€ä½¿ç”¨ TimSortï¼ˆç¨³å®šï¼‰ã€‚

---

ES9 çš„æ­£åˆ™è¡¨è¾¾å¼å¢å¼ºè®©å¤æ‚æ–‡æœ¬å¤„ç†å˜å¾—æ›´ç®€å•ï¼Œå‘½åæ•è·ç»„å’Œåè¡Œæ–­è¨€å¤§å¹…æå‡äº†æ­£åˆ™çš„å¯è¯»æ€§å’Œèƒ½åŠ›ã€‚ES10 çš„ `flat/flatMap` å’Œ `Object.fromEntries` å¡«è¡¥äº†æ•°ç»„å’Œå¯¹è±¡æ“ä½œçš„ç©ºç™½ã€‚è¿™äº›ç‰¹æ€§ç°åœ¨å·²ç»æ˜¯æ—¥å¸¸å¼€å‘çš„åŸºç¡€å·¥å…·ã€‚
