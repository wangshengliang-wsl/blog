---
title: 'BOM åŸºç¡€'
description: 'æŒæ¡æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼Œç†è§£ windowã€locationã€history å’Œ navigator'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'BOM', 'window', 'location']
---

BOMï¼ˆBrowser Object Modelï¼‰æ˜¯æµè§ˆå™¨æä¾›çš„å¯¹è±¡æ¨¡å‹ï¼Œç”¨äºä¸æµè§ˆå™¨çª—å£è¿›è¡Œäº¤äº’ã€‚BOM çš„æ ¸å¿ƒæ˜¯ window å¯¹è±¡ã€‚

## ğŸ¯ window å¯¹è±¡

### å…¨å±€ä½œç”¨åŸŸ

```javascript
// window æ˜¯å…¨å±€å¯¹è±¡
var globalVar = 'å…¨å±€å˜é‡'
console.log(window.globalVar) // 'å…¨å±€å˜é‡'

// å…¨å±€å‡½æ•°ä¹Ÿæ˜¯ window çš„å±æ€§
function globalFunc() {
  return 'hello'
}
console.log(window.globalFunc()) // 'hello'

// ğŸ”¶ let/const ä¸ä¼šæˆä¸º window å±æ€§
let letVar = 'let å˜é‡'
console.log(window.letVar) // undefined
```

### çª—å£å°ºå¯¸

```javascript
// è§†å£å°ºå¯¸ï¼ˆä¸å«æ»šåŠ¨æ¡ï¼‰
window.innerWidth // è§†å£å®½åº¦
window.innerHeight // è§†å£é«˜åº¦

// çª—å£å°ºå¯¸ï¼ˆå«å·¥å…·æ ç­‰ï¼‰
window.outerWidth // çª—å£æ€»å®½åº¦
window.outerHeight // çª—å£æ€»é«˜åº¦

// æ–‡æ¡£å°ºå¯¸
document.documentElement.clientWidth // æ–‡æ¡£å®½åº¦
document.documentElement.clientHeight // æ–‡æ¡£é«˜åº¦

// å±å¹•å°ºå¯¸
screen.width // å±å¹•å®½åº¦
screen.height // å±å¹•é«˜åº¦
screen.availWidth // å¯ç”¨å®½åº¦ï¼ˆæ’é™¤ä»»åŠ¡æ ï¼‰
screen.availHeight // å¯ç”¨é«˜åº¦

// æ»šåŠ¨ä½ç½®
window.scrollX // æ°´å¹³æ»šåŠ¨è·ç¦»
window.scrollY // å‚ç›´æ»šåŠ¨è·ç¦»
// æˆ–
window.pageXOffset
window.pageYOffset
```

### æ»šåŠ¨æ§åˆ¶

```javascript
// æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
window.scrollTo(0, 100) // æ»šåŠ¨åˆ° y=100
window.scrollTo({
  top: 100,
  left: 0,
  behavior: 'smooth', // å¹³æ»‘æ»šåŠ¨
})

// ç›¸å¯¹æ»šåŠ¨
window.scrollBy(0, 100) // å‘ä¸‹æ»šåŠ¨ 100px
window.scrollBy({
  top: 100,
  behavior: 'smooth',
})

// æ»šåŠ¨å…ƒç´ åˆ°è§†å›¾
element.scrollIntoView()
element.scrollIntoView({ behavior: 'smooth', block: 'center' })
```

### å¼¹çª—æ–¹æ³•

```javascript
// è­¦å‘Šæ¡†
window.alert('æç¤ºä¿¡æ¯')

// ç¡®è®¤æ¡†
const confirmed = window.confirm('ç¡®å®šåˆ é™¤å—ï¼Ÿ')
if (confirmed) {
  // ç”¨æˆ·ç‚¹å‡»äº†ç¡®å®š
}

// è¾“å…¥æ¡†
const name = window.prompt('è¯·è¾“å…¥å§“å', 'é»˜è®¤å€¼')
if (name !== null) {
  console.log('è¾“å…¥:', name)
}

// ğŸ”¶ è¿™äº›æ–¹æ³•ä¼šé˜»å¡ JavaScript æ‰§è¡Œ
// ç°ä»£å¼€å‘ä¸­å°½é‡é¿å…ä½¿ç”¨ï¼Œæ”¹ç”¨è‡ªå®šä¹‰å¼¹çª—
```

### æ‰“å¼€æ–°çª—å£

```javascript
// æ‰“å¼€æ–°çª—å£/æ ‡ç­¾é¡µ
const newWindow = window.open('https://example.com', '_blank')

// æŒ‡å®šçª—å£å¤§å°å’Œä½ç½®
window.open(
  'https://example.com',
  'popup',
  'width=400,height=300,left=100,top=100'
)

// å…³é—­çª—å£
newWindow.close()

// æ£€æŸ¥çª—å£æ˜¯å¦å…³é—­
if (newWindow.closed) {
  console.log('çª—å£å·²å…³é—­')
}

// ğŸ”¶ å¼¹çª—å¯èƒ½è¢«æµè§ˆå™¨æ‹¦æˆª
// æœ€å¥½ç”±ç”¨æˆ·æ“ä½œè§¦å‘ï¼ˆå¦‚ç‚¹å‡»äº‹ä»¶ï¼‰
```

## location å¯¹è±¡

### URL ä¿¡æ¯

```javascript
// å‡è®¾å½“å‰ URL: https://example.com:8080/path/page.html?id=123#section

location.href // å®Œæ•´ URL
location.protocol // 'https:'
location.host // 'example.com:8080'
location.hostname // 'example.com'
location.port // '8080'
location.pathname // '/path/page.html'
location.search // '?id=123'
location.hash // '#section'
location.origin // 'https://example.com:8080'
```

### é¡µé¢è·³è½¬

```javascript
// æ–¹å¼1ï¼šè®¾ç½® hrefï¼ˆä¼šç•™ä¸‹å†å²è®°å½•ï¼‰
location.href = 'https://example.com'

// æ–¹å¼2ï¼šä½¿ç”¨ assignï¼ˆç­‰åŒäºè®¾ç½® hrefï¼‰
location.assign('https://example.com')

// æ–¹å¼3ï¼šä½¿ç”¨ replaceï¼ˆä¸ç•™å†å²è®°å½•ï¼‰
location.replace('https://example.com')

// åˆ·æ–°é¡µé¢
location.reload() // æ™®é€šåˆ·æ–°
location.reload(true) // å¼ºåˆ¶åˆ·æ–°ï¼ˆä»æœåŠ¡å™¨ï¼‰

// åªæ”¹å˜ hashï¼ˆä¸åˆ·æ–°é¡µé¢ï¼‰
location.hash = '#new-section'
```

### URL å‚æ•°è§£æ

```javascript
// è·å–æŸ¥è¯¢å‚æ•°
const params = new URLSearchParams(location.search)

// è·å–å•ä¸ªå‚æ•°
params.get('id') // '123'
params.get('name') // nullï¼ˆä¸å­˜åœ¨ï¼‰

// æ£€æŸ¥å‚æ•°æ˜¯å¦å­˜åœ¨
params.has('id') // true

// è·å–æ‰€æœ‰å‚æ•°
for (const [key, value] of params) {
  console.log(`${key}: ${value}`)
}

// è·å–åŒåå‚æ•°çš„æ‰€ï¿½ï¿½ï¿½å€¼
params.getAll('tags') // ['a', 'b']ï¼ˆå¦‚æœæœ‰ ?tags=a&tags=bï¼‰

// è½¬ä¸ºå¯¹è±¡
const paramsObj = Object.fromEntries(params)

// ä¿®æ”¹å‚æ•°
params.set('id', '456')
params.append('new', 'value')
params.delete('id')

// è½¬å›å­—ç¬¦ä¸²
params.toString() // 'new=value'
```

### æ„å»º URL

```javascript
// ä½¿ç”¨ URL å¯¹è±¡
const url = new URL('https://example.com/path')
url.searchParams.set('id', '123')
url.searchParams.set('name', 'å¼ ä¸‰')
url.hash = 'section'

console.log(url.href)
// 'https://example.com/path?id=123&name=%E5%BC%A0%E4%B8%89#section'

// ç›¸å¯¹ URL
const relative = new URL('/api/users', 'https://example.com')
console.log(relative.href) // 'https://example.com/api/users'
```

## history å¯¹è±¡

### å†å²å¯¼èˆª

```javascript
// å†å²è®°å½•é•¿åº¦
history.length

// åé€€
history.back() // ç­‰åŒäºç‚¹å‡»åé€€æŒ‰é’®

// å‰è¿›
history.forward() // ç­‰åŒäºç‚¹å‡»å‰è¿›æŒ‰é’®

// è·³è½¬åˆ°æŒ‡å®šå†å²
history.go(-1) // åé€€ä¸€é¡µ
history.go(1) // å‰è¿›ä¸€é¡µ
history.go(-2) // åé€€ä¸¤é¡µ
history.go(0) // åˆ·æ–°å½“å‰é¡µ
```

### History APIï¼ˆSPA è·¯ç”±ï¼‰

```javascript
// æ·»åŠ å†å²è®°å½•ï¼ˆä¸åˆ·æ–°é¡µé¢ï¼‰
history.pushState(
  { page: 1 }, // state å¯¹è±¡
  '', // titleï¼ˆå¤§å¤šæ•°æµè§ˆå™¨å¿½ç•¥ï¼‰
  '/page/1' // URL
)

// æ›¿æ¢å½“å‰å†å²è®°å½•
history.replaceState({ page: 2 }, '', '/page/2')

// è·å–å½“å‰çŠ¶æ€
console.log(history.state) // { page: 2 }

// ç›‘å¬å‰è¿›/åé€€
window.addEventListener('popstate', (event) => {
  console.log('å¯¼èˆªåˆ°:', location.pathname)
  console.log('çŠ¶æ€:', event.state)
})

// ğŸ”¶ æ³¨æ„ï¼špushState ä¸ä¼šè§¦å‘ popstate
// åªæœ‰æµè§ˆå™¨çš„å‰è¿›/åé€€æŒ‰é’®ä¼šè§¦å‘
```

### ç®€å•è·¯ç”±å®ç°

```javascript
class Router {
  constructor() {
    this.routes = {}
    window.addEventListener('popstate', () => this.handleRoute())
  }

  on(path, handler) {
    this.routes[path] = handler
  }

  navigate(path, state = {}) {
    history.pushState(state, '', path)
    this.handleRoute()
  }

  handleRoute() {
    const path = location.pathname
    const handler = this.routes[path]
    if (handler) {
      handler(history.state)
    }
  }
}

// ä½¿ç”¨
const router = new Router()

router.on('/', () => console.log('é¦–é¡µ'))
router.on('/about', () => console.log('å…³äºé¡µ'))
router.on('/user', (state) => console.log('ç”¨æˆ·ï¿½ï¿½', state))

router.navigate('/user', { id: 123 })
```

## navigator å¯¹è±¡

### æµè§ˆå™¨ä¿¡æ¯

```javascript
// ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²
navigator.userAgent
// 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...'

// æµè§ˆå™¨åç§°å’Œç‰ˆæœ¬
navigator.appName // 'Netscape'ï¼ˆå†å²é—ç•™ï¼‰
navigator.appVersion // ç‰ˆæœ¬ä¿¡æ¯

// å¹³å°
navigator.platform // 'Win32', 'MacIntel', 'Linux x86_64'

// è¯­è¨€
navigator.language // 'zh-CN'
navigator.languages // ['zh-CN', 'zh', 'en']

// æ˜¯å¦åœ¨çº¿
navigator.onLine // true/false

// CPU æ ¸å¿ƒæ•°
navigator.hardwareConcurrency // 8

// è®¾å¤‡å†…å­˜ï¼ˆGBï¼‰
navigator.deviceMemory // 8
```

### ç‰¹æ€§æ£€æµ‹

```javascript
// ğŸ”¶ ä¸æ¨èä½¿ç”¨ userAgent æ£€æµ‹æµè§ˆå™¨
// âœ… æ¨èä½¿ç”¨ç‰¹æ€§æ£€æµ‹

// æ£€æµ‹æ˜¯å¦æ”¯æŒæŸä¸ª API
if ('geolocation' in navigator) {
  // æ”¯æŒåœ°ç†å®šä½
}

if ('serviceWorker' in navigator) {
  // æ”¯æŒ Service Worker
}

if ('share' in navigator) {
  // æ”¯æŒ Web Share API
}

if ('clipboard' in navigator) {
  // æ”¯æŒå‰ªè´´æ¿ API
}

// æ£€æµ‹ç§»åŠ¨è®¾å¤‡ï¼ˆä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼‰
const isMobile = window.matchMedia('(max-width: 768px)').matches

// æˆ–æ£€æµ‹è§¦æ‘¸æ”¯æŒ
const hasTouch = 'ontouchstart' in window
```

### å¸¸ç”¨ API

```javascript
// åœ°ç†å®šä½
navigator.geolocation.getCurrentPosition(
  (position) => {
    console.log('çº¬åº¦:', position.coords.latitude)
    console.log('ç»åº¦:', position.coords.longitude)
  },
  (error) => {
    console.error('å®šä½å¤±è´¥:', error.message)
  }
)

// å‰ªè´´æ¿
await navigator.clipboard.writeText('å¤åˆ¶çš„æ–‡æœ¬')
const text = await navigator.clipboard.readText()

// åˆ†äº«
if (navigator.share) {
  await navigator.share({
    title: 'æ ‡é¢˜',
    text: 'æè¿°',
    url: 'https://example.com',
  })
}

// éœ‡åŠ¨ï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰
navigator.vibrate(200) // éœ‡åŠ¨ 200ms
navigator.vibrate([100, 50, 100]) // éœ‡åŠ¨-æš‚åœ-éœ‡åŠ¨
```

## screen å¯¹è±¡

```javascript
// å±å¹•å°ºå¯¸
screen.width // å±å¹•å®½åº¦
screen.height // å±å¹•é«˜åº¦

// å¯ç”¨å°ºå¯¸ï¼ˆæ’é™¤ä»»åŠ¡æ ç­‰ï¼‰
screen.availWidth // å¯ç”¨å®½åº¦
screen.availHeight // å¯ç”¨ï¿½ï¿½åº¦

// é¢œè‰²æ·±åº¦
screen.colorDepth // 24ï¼ˆä½ï¼‰
screen.pixelDepth // 24

// å±å¹•æ–¹å‘ï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰
screen.orientation.type // 'portrait-primary', 'landscape-primary'
screen.orientation.angle // 0, 90, 180, 270

// ç›‘å¬æ–¹å‘å˜åŒ–
screen.orientation.addEventListener('change', () => {
  console.log('æ–¹å‘:', screen.orientation.type)
})
```

## å®é™…åº”ç”¨

### å“åº”å¼æ£€æµ‹

```javascript
// ä½¿ç”¨åª’ä½“æŸ¥è¯¢
const mediaQuery = window.matchMedia('(max-width: 768px)')

function handleMediaChange(e) {
  if (e.matches) {
    console.log('ç§»åŠ¨ç«¯è§†å›¾')
  } else {
    console.log('æ¡Œé¢ç«¯è§†å›¾')
  }
}

mediaQuery.addEventListener('change', handleMediaChange)
handleMediaChange(mediaQuery) // åˆå§‹æ£€æŸ¥
```

### å…¨å± API

```javascript
// è¿›å…¥å…¨å±
async function enterFullscreen(element = document.documentElement) {
  try {
    await element.requestFullscreen()
  } catch (error) {
    console.error('å…¨å±å¤±è´¥:', error)
  }
}

// é€€å‡ºå…¨å±
function exitFullscreen() {
  if (document.fullscreenElement) {
    document.exitFullscreen()
  }
}

// æ£€æŸ¥æ˜¯å¦å…¨å±
document.fullscreenElement // å½“å‰å…¨å±å…ƒç´ æˆ– null

// ç›‘å¬å…¨å±å˜åŒ–
document.addEventListener('fullscreenchange', () => {
  console.log('å…¨å±çŠ¶æ€:', !!document.fullscreenElement)
})
```

### é¡µé¢å¯è§æ€§

```javascript
// æ£€æµ‹é¡µé¢æ˜¯å¦å¯è§
document.visibilityState // 'visible', 'hidden', 'prerender'
document.hidden // true/false

// ç›‘å¬å¯è§æ€§å˜åŒ–
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    console.log('é¡µé¢éšè—')
    // æš‚åœè§†é¢‘ã€åŠ¨ç”»ç­‰
  } else {
    console.log('é¡µé¢å¯è§')
    // æ¢å¤æ“ä½œ
  }
})
```

### ç¦»å¼€é¡µé¢æç¤º

```javascript
// æç¤ºç”¨æˆ·æœ‰æœªä¿å­˜çš„æ›´æ”¹
let hasUnsavedChanges = false

window.addEventListener('beforeunload', (event) => {
  if (hasUnsavedChanges) {
    event.preventDefault()
    event.returnValue = '' // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
  }
})

// æ ‡è®°æœ‰æœªä¿å­˜æ›´æ”¹
input.addEventListener('change', () => {
  hasUnsavedChanges = true
})

// ä¿å­˜åæ¸…é™¤æ ‡è®°
function save() {
  // ä¿å­˜é€»è¾‘
  hasUnsavedChanges = false
}
```

## æ€»ç»“

| å¯¹è±¡        | ç”¨é€”               |
| ----------- | ------------------ |
| `window`    | å…¨å±€å¯¹è±¡ï¼Œçª—å£æ§åˆ¶ |
| `location`  | URL ä¿¡æ¯å’Œé¡µé¢è·³è½¬ |
| `history`   | å†å²è®°å½•ç®¡ç†       |
| `navigator` | æµè§ˆå™¨/è®¾å¤‡ä¿¡æ¯    |
| `screen`    | å±å¹•ä¿¡æ¯           |

| å¸¸ç”¨æ“ä½œ | æ–¹æ³•                                   |
| -------- | -------------------------------------- |
| é¡µé¢è·³è½¬ | `location.href = url`                  |
| åˆ·æ–°é¡µé¢ | `location.reload()`                    |
| åé€€     | `history.back()`                       |
| å‰è¿›     | `history.forward()`                    |
| æ·»åŠ å†å² | `history.pushState()`                  |
| è·å–å‚æ•° | `new URLSearchParams(location.search)` |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- window æ˜¯ BOM çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯å…¨å±€å¯¹è±¡
- location å¤„ç† URL ç›¸å…³æ“ä½œ
- history API æ˜¯ SPA è·¯ç”±çš„åŸºç¡€
- navigator ç”¨äºè·å–æµè§ˆå™¨å’Œè®¾å¤‡ä¿¡æ¯
- ä½¿ç”¨ç‰¹æ€§æ£€æµ‹è€Œé userAgent åˆ¤æ–­
