---
title: 'äº‹ä»¶å¤„ç†'
description: 'æŒæ¡ JavaScript äº‹ä»¶ç›‘å¬ã€äº‹ä»¶å¯¹è±¡ä¸äº‹ä»¶æµæœºåˆ¶'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'äº‹ä»¶', 'DOM', 'äº‹ä»¶ç›‘å¬']
---

äº‹ä»¶æ˜¯ç”¨æˆ·ä¸é¡µé¢äº¤äº’çš„åŸºç¡€ã€‚ç†è§£äº‹ä»¶æœºåˆ¶ï¼Œæ‰èƒ½æ„å»ºå“åº”å¼çš„ Web åº”ç”¨ã€‚

## ğŸ¯ äº‹ä»¶åŸºç¡€

### ä»€ä¹ˆæ˜¯äº‹ä»¶

äº‹ä»¶æ˜¯æµè§ˆå™¨æˆ–ç”¨æˆ·è§¦å‘çš„ç‰¹å®šè¡Œä¸ºï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰ã€‚

```javascript
// ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
button.onclick = function () {
  console.log('æŒ‰é’®è¢«ç‚¹å‡»')
}

// ç”¨æˆ·è¾“å…¥æ–‡å­—
input.oninput = function () {
  console.log('æ­£åœ¨è¾“å…¥')
}

// é¡µé¢åŠ è½½å®Œæˆ
window.onload = function () {
  console.log('é¡µé¢åŠ è½½å®Œæˆ')
}
```

## äº‹ä»¶ç»‘å®šæ–¹å¼

### HTML å±æ€§

```html
<!-- ä¸æ¨èï¼šHTML å’Œ JS æ··åˆ -->
<button onclick="handleClick()">ç‚¹å‡»</button>

<script>
  function handleClick() {
    console.log('ç‚¹å‡»äº†')
  }
</script>
```

### DOM å±æ€§

```javascript
const button = document.getElementById('btn')

// ç»‘å®šäº‹ä»¶
button.onclick = function () {
  console.log('ç‚¹å‡»äº†')
}

// ğŸ”¶ é—®é¢˜ï¼šåªèƒ½ç»‘å®šä¸€ä¸ªå¤„ç†å™¨
button.onclick = function () {
  console.log('æ–°çš„å¤„ç†å™¨')
}
// ä¹‹å‰çš„å¤„ç†å™¨è¢«è¦†ç›–

// ç§»é™¤äº‹ä»¶
button.onclick = null
```

### addEventListenerï¼ˆæ¨èï¼‰

```javascript
const button = document.getElementById('btn')

// åŸºæœ¬ç”¨æ³•
button.addEventListener('click', function () {
  console.log('å¤„ç†å™¨1')
})

button.addEventListener('click', function () {
  console.log('å¤„ç†å™¨2')
})
// ä¸¤ä¸ªå¤„ç†å™¨éƒ½ä¼šæ‰§è¡Œ

// å¸¦é…ç½®é¡¹
button.addEventListener(
  'click',
  function () {
    console.log('ç‚¹å‡»')
  },
  {
    capture: false, // æ˜¯å¦åœ¨æ•è·é˜¶æ®µè§¦å‘
    once: true, // åªæ‰§è¡Œä¸€æ¬¡
    passive: true, // ä¸ä¼šè°ƒç”¨ preventDefault
  }
)

// ç§»é™¤äº‹ä»¶ï¼ˆéœ€è¦ç›¸åŒçš„å‡½æ•°å¼•ç”¨ï¼‰
function handleClick() {
  console.log('ç‚¹å‡»')
}
button.addEventListener('click', handleClick)
button.removeEventListener('click', handleClick)
```

## äº‹ä»¶å¯¹è±¡

### åŸºæœ¬å±æ€§

```javascript
element.addEventListener('click', function (event) {
  // äº‹ä»¶ç±»å‹
  console.log(event.type) // "click"

  // è§¦å‘äº‹ä»¶çš„å…ƒç´ 
  console.log(event.target) // å®é™…ç‚¹å‡»çš„å…ƒç´ 

  // ç»‘å®šäº‹ä»¶çš„å…ƒç´ 
  console.log(event.currentTarget) // ç»‘å®šå¤„ç†å™¨çš„å…ƒç´ 
  console.log(this) // åŒä¸Šï¼ˆéç®­å¤´å‡½æ•°ï¼‰

  // æ—¶é—´æˆ³
  console.log(event.timeStamp)

  // æ˜¯å¦å¯å–æ¶ˆ
  console.log(event.cancelable)
})
```

### é¼ æ ‡äº‹ä»¶å±æ€§

```javascript
element.addEventListener('click', function (event) {
  // é¼ æ ‡ä½ç½®ï¼ˆç›¸å¯¹äºè§†å£ï¼‰
  console.log(event.clientX, event.clientY)

  // é¼ æ ‡ä½ç½®ï¼ˆç›¸å¯¹äºé¡µé¢ï¼‰
  console.log(event.pageX, event.pageY)

  // é¼ æ ‡ä½ç½®ï¼ˆç›¸å¯¹äºå±å¹•ï¼‰
  console.log(event.screenX, event.screenY)

  // é¼ æ ‡ä½ç½®ï¼ˆç›¸å¯¹äºç›®æ ‡å…ƒç´ ï¼‰
  console.log(event.offsetX, event.offsetY)

  // é¼ æ ‡æŒ‰é”®
  console.log(event.button) // 0å·¦ 1ä¸­ 2å³
  console.log(event.buttons) // ä½æ©ç 

  // ï¿½ï¿½é¥°é”®
  console.log(event.ctrlKey)
  console.log(event.shiftKey)
  console.log(event.altKey)
  console.log(event.metaKey) // Mac: Cmd, Win: Winé”®
})
```

### é”®ç›˜äº‹ä»¶å±æ€§

```javascript
input.addEventListener('keydown', function (event) {
  // æŒ‰é”®å€¼
  console.log(event.key) // "Enter", "a", "ArrowUp"

  // æŒ‰é”®ä»£ç 
  console.log(event.code) // "Enter", "KeyA", "ArrowUp"

  // ä¿®é¥°é”®
  console.log(event.ctrlKey)
  console.log(event.shiftKey)
  console.log(event.altKey)
  console.log(event.metaKey)

  // æ˜¯å¦é‡å¤ï¼ˆé•¿æŒ‰ï¼‰
  console.log(event.repeat)

  // å¸¸è§åˆ¤æ–­
  if (event.key === 'Enter') {
    console.log('æŒ‰ä¸‹å›è½¦')
  }

  if (event.ctrlKey && event.key === 's') {
    event.preventDefault()
    console.log('Ctrl+S ä¿å­˜')
  }
})
```

## äº‹ä»¶æµ

äº‹ä»¶ä¼ æ’­åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šæ•è·ã€ç›®æ ‡ã€å†’æ³¡ã€‚

### æ•è·é˜¶æ®µ

```javascript
// <div class="outer">
//   <div class="inner">
//     <button>ç‚¹å‡»</button>
//   </div>
// </div>

const outer = document.querySelector('.outer')
const inner = document.querySelector('.inner')
const button = document.querySelector('button')

// æ•è·é˜¶æ®µç›‘å¬ï¼ˆä»å¤–åˆ°å†…ï¼‰
outer.addEventListener('click', () => console.log('outer æ•è·'), true)
inner.addEventListener('click', () => console.log('inner æ•è·'), true)
button.addEventListener('click', () => console.log('button æ•è·'), true)

// ç‚¹å‡» button æ—¶è¾“å‡ºé¡ºåºï¼š
// outer æ•è·
// inner æ•è·
// button æ•è·
```

### å†’æ³¡é˜¶æ®µ

```javascript
// å†’æ³¡é˜¶æ®µç›‘å¬ï¼ˆé»˜è®¤ï¼Œä»å†…åˆ°å¤–ï¼‰
outer.addEventListener('click', () => console.log('outer å†’æ³¡'))
inner.addEventListener('click', () => console.log('inner å†’æ³¡'))
button.addEventListener('click', () => console.log('button å†’æ³¡'))

// ç‚¹å‡» button æ—¶è¾“å‡ºé¡ºåºï¼š
// button å†’æ³¡
// inner å†’æ³¡
// outer å†’æ³¡
```

### å®Œæ•´äº‹ä»¶æµ

```javascript
// åŒæ—¶ç›‘å¬æ•è·å’Œå†’æ³¡
outer.addEventListener('click', () => console.log('outer æ•è·'), true)
outer.addEventListener('click', () => console.log('outer å†’æ³¡'))

// ç‚¹å‡» button æ—¶è¾“å‡ºé¡ºåºï¼š
// outer æ•è·
// inner æ•è·
// buttonï¼ˆç›®æ ‡é˜¶æ®µï¼ŒæŒ‰æ³¨å†Œé¡ºåºï¼‰
// inner å†’æ³¡
// outer å†’æ³¡
```

## é˜»æ­¢äº‹ä»¶

### preventDefault

é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼š

```javascript
// é˜»æ­¢é“¾æ¥è·³è½¬
link.addEventListener('click', function (event) {
  event.preventDefault()
  console.log('ä¸ä¼šè·³è½¬')
})

// é˜»æ­¢è¡¨å•æäº¤
form.addEventListener('submit', function (event) {
  event.preventDefault()
  // æ‰‹åŠ¨å¤„ç†è¡¨å•
})

// é˜»æ­¢å³é”®èœå•
document.addEventListener('contextmenu', function (event) {
  event.preventDefault()
  // æ˜¾ç¤ºè‡ªå®šä¹‰èœå•
})

// æ£€æŸ¥æ˜¯å¦å¯ä»¥é˜»æ­¢
if (event.cancelable) {
  event.preventDefault()
}
```

### stopPropagation

é˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼š

```javascript
inner.addEventListener('click', function (event) {
  event.stopPropagation()
  console.log('ä¸ä¼šå†’æ³¡åˆ° outer')
})

// é˜»æ­¢åŒä¸€å…ƒç´ çš„å…¶ä»–å¤„ç†å™¨
button.addEventListener('click', function (event) {
  event.stopImmediatePropagation()
  console.log('å¤„ç†å™¨1')
})

button.addEventListener('click', function (event) {
  console.log('å¤„ç†å™¨2') // ä¸ä¼šæ‰§è¡Œ
})
```

## å¸¸ç”¨äº‹ä»¶ç±»å‹

### é¼ æ ‡äº‹ä»¶

```javascript
element.addEventListener('click', handler) // ç‚¹å‡»
element.addEventListener('dblclick', handler) // åŒå‡»
element.addEventListener('mousedown', handler) // æŒ‰ä¸‹
element.addEventListener('mouseup', handler) // é‡Šæ”¾
element.addEventListener('mousemove', handler) // ç§»åŠ¨
element.addEventListener('mouseenter', handler) // è¿›å…¥ï¼ˆä¸å†’æ³¡ï¼‰
element.addEventListener('mouseleave', handler) // ç¦»å¼€ï¼ˆä¸å†’æ³¡ï¼‰
element.addEventListener('mouseover', handler) // è¿›å…¥ï¼ˆå†’æ³¡ï¼‰
element.addEventListener('mouseout', handler) // ç¦»å¼€ï¼ˆå†’æ³¡ï¼‰
element.addEventListener('contextmenu', handler) // å³é”®
element.addEventListener('wheel', handler) // æ»šè½®
```

### é”®ç›˜äº‹ä»¶

```javascript
element.addEventListener('keydown', handler) // æŒ‰ä¸‹
element.addEventListener('keyup', handler) // é‡Šæ”¾
element.addEventListener('keypress', handler) // å·²åºŸå¼ƒ
```

### è¡¨å•äº‹ä»¶

```javascript
input.addEventListener('input', handler) // å€¼æ”¹å˜ï¼ˆå®æ—¶ï¼‰
input.addEventListener('change', handler) // å€¼æ”¹å˜ï¼ˆå¤±ç„¦åï¼‰
input.addEventListener('focus', handler) // è·å¾—ç„¦ç‚¹
input.addEventListener('blur', handler) // å¤±å»ç„¦ç‚¹
form.addEventListener('submit', handler) // æäº¤
form.addEventListener('reset', handler) // é‡ç½®
```

### é¡µé¢äº‹ä»¶

```javascript
window.addEventListener('load', handler) // é¡µé¢å®Œå…¨åŠ è½½
window.addEventListener('DOMContentLoaded', handler) // DOM åŠ è½½å®Œæˆ
window.addEventListener('beforeunload', handler) // é¡µé¢å³å°†å¸è½½
window.addEventListener('unload', handler) // é¡µé¢å¸è½½
window.addEventListener('resize', handler) // çª—å£å¤§å°æ”¹å˜
window.addEventListener('scroll', handler) // é¡µé¢æ»šåŠ¨
```

### è§¦æ‘¸äº‹ä»¶

```javascript
element.addEventListener('touchstart', handler) // è§¦æ‘¸å¼€å§‹
element.addEventListener('touchmove', handler) // è§¦æ‘¸ç§»åŠ¨
element.addEventListener('touchend', handler) // è§¦æ‘¸ç»“æŸ
element.addEventListener('touchcancel', handler) // è§¦æ‘¸å–æ¶ˆ

// è§¦æ‘¸äº‹ä»¶å¯¹è±¡
element.addEventListener('touchstart', function (event) {
  const touch = event.touches[0] // ç¬¬ä¸€ä¸ªè§¦æ‘¸ç‚¹
  console.log(touch.clientX, touch.clientY)
})
```

## è‡ªå®šä¹‰äº‹ä»¶

### CustomEvent

```javascript
// åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶
const event = new CustomEvent('myEvent', {
  detail: { message: 'è‡ªå®šä¹‰æ•°æ®' },
  bubbles: true, // æ˜¯å¦å†’æ³¡
  cancelable: true, // æ˜¯å¦å¯å–æ¶ˆ
})

// ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶
element.addEventListener('myEvent', function (event) {
  console.log(event.detail.message) // "è‡ªå®šä¹‰æ•°æ®"
})

// è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
element.dispatchEvent(event)
```

### å®é™…åº”ç”¨

```javascript
// ç®€å•çš„äº‹ä»¶æ€»çº¿
class EventBus {
  constructor() {
    this.events = {}
  }

  on(event, callback) {
    if (!this.events[event]) {
      this.events[event] = []
    }
    this.events[event].push(callback)
  }

  off(event, callback) {
    if (!this.events[event]) return
    this.events[event] = this.events[event].filter((cb) => cb !== callback)
  }

  emit(event, data) {
    if (!this.events[event]) return
    this.events[event].forEach((callback) => callback(data))
  }
}

const bus = new EventBus()
bus.on('userLogin', (user) => console.log('ç”¨æˆ·ç™»å½•:', user))
bus.emit('userLogin', { name: 'å¼ ä¸‰' })
```

## äº‹ä»¶å¤„ç†æœ€ä½³å®è·µ

### ä½¿ç”¨å…·åå‡½æ•°

```javascript
// ğŸ”¶ åŒ¿åå‡½æ•°æ— æ³•ç§»é™¤
element.addEventListener('click', function () {})

// âœ… å…·åå‡½æ•°å¯ä»¥ç§»é™¤
function handleClick() {}
element.addEventListener('click', handleClick)
element.removeEventListener('click', handleClick)
```

### é¿å…å†…å­˜æ³„æ¼

```javascript
class Component {
  constructor(element) {
    this.element = element
    this.handleClick = this.handleClick.bind(this)
    this.element.addEventListener('click', this.handleClick)
  }

  handleClick() {
    console.log('ç‚¹å‡»')
  }

  // æä¾›é”€æ¯æ–¹æ³•
  destroy() {
    this.element.removeEventListener('click', this.handleClick)
    this.element = null
  }
}
```

### ä½¿ç”¨ passive ä¼˜åŒ–æ»šåŠ¨

```javascript
// å‘Šè¯‰æµè§ˆå™¨ä¸ä¼šè°ƒç”¨ preventDefault
// å¯ä»¥ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½
document.addEventListener('touchmove', handler, { passive: true })

// å¦‚æœéœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œä¸è¦ç”¨ passive
document.addEventListener(
  'touchmove',
  function (e) {
    e.preventDefault()
  },
  { passive: false }
)
```

## æ€»ç»“

| ç»‘å®šæ–¹å¼         | å¤šå¤„ç†å™¨ | ç§»é™¤æ–¹å¼            |
| ---------------- | -------- | ------------------- |
| HTML å±æ€§        | å¦       | è®¾ä¸ºç©º              |
| DOM å±æ€§         | å¦       | è®¾ä¸º null           |
| addEventListener | æ˜¯       | removeEventListener |

| äº‹ä»¶æµé˜¶æ®µ | é¡ºåº  | capture å‚æ•°  |
| ---------- | ----- | ------------- |
| æ•è·       | å¤–â†’å†… | true          |
| ç›®æ ‡       | -     | -             |
| å†’æ³¡       | å†…â†’å¤– | falseï¼ˆé»˜è®¤ï¼‰ |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- ä¼˜å…ˆä½¿ç”¨ `addEventListener`
- ç†è§£äº‹ä»¶å†’æ³¡å’Œæ•è·
- ç”¨ `preventDefault` é˜»æ­¢é»˜è®¤è¡Œä¸º
- ç”¨ `stopPropagation` é˜»æ­¢ä¼ æ’­
- åŠæ—¶ç§»é™¤äº‹ä»¶ç›‘å¬å™¨é¿å…å†…å­˜æ³„æ¼
