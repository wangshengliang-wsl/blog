---
title: 'DOM é€‰æ‹©å™¨'
description: 'æŒæ¡ JavaScript DOM é€‰æ‹©å™¨ï¼Œå­¦ä¼šé«˜æ•ˆè·å–å’Œéå†é¡µé¢å…ƒç´ '
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'DOM', 'é€‰æ‹©å™¨', 'å…ƒç´ ']
---

DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯ JavaScript æ“ä½œç½‘é¡µçš„æ¥å£ã€‚é€‰æ‹©å™¨æ˜¯æ“ä½œ DOM çš„ç¬¬ä¸€æ­¥ã€‚

## ğŸ¯ ä»€ä¹ˆæ˜¯ DOM

DOM å°† HTML æ–‡æ¡£è¡¨ç¤ºä¸ºæ ‘å½¢ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¯¹è±¡ï¼ŒJavaScript å¯ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œã€‚

```html
<!DOCTYPE html>
<html>
  <head>
    <title>é¡µé¢æ ‡é¢˜</title>
  </head>
  <body>
    <div id="app">
      <h1 class="title">æ ‡é¢˜</h1>
      <p>æ®µè½</p>
    </div>
  </body>
</html>
```

```javascript
// DOM æ ‘ç»“æ„
// document
// â””â”€â”€ html
//     â”œâ”€â”€ head
//     â”‚   â””â”€â”€ title
//     â””â”€â”€ body
//         â””â”€â”€ div#app
//             â”œâ”€â”€ h1.title
//             â””â”€â”€ p
```

## åŸºç¡€é€‰æ‹©å™¨

### getElementById

é€šè¿‡ ID è·å–å•ä¸ªå…ƒç´ ï¼ˆæœ€å¿«çš„é€‰æ‹©å™¨ï¼‰ï¼š

```javascript
// <div id="app">å†…å®¹</div>

const app = document.getElementById('app')
console.log(app) // <div id="app">å†…å®¹</div>

// ä¸å­˜åœ¨æ—¶è¿”å› null
const notExist = document.getElementById('not-exist')
console.log(notExist) // null

// ID åº”è¯¥å”¯ä¸€ï¼Œå¦‚æœæœ‰é‡å¤åªè¿”å›ç¬¬ä¸€ä¸ª
```

### getElementsByClassName

é€šè¿‡ç±»åè·å–å…ƒç´ é›†åˆï¼ˆHTMLCollectionï¼‰ï¼š

```javascript
// <div class="item">1</div>
// <div class="item">2</div>
// <div class="item active">3</div>

const items = document.getElementsByClassName('item')
console.log(items.length) // 3
console.log(items[0]) // <div class="item">1</div>

// å¤šä¸ªç±»åï¼ˆç©ºæ ¼åˆ†éš”ï¼Œä¸”å…³ç³»ï¼‰
const activeItems = document.getElementsByClassName('item active')
console.log(activeItems.length) // 1

// HTMLCollection æ˜¯å®æ—¶çš„
const newItem = document.createElement('div')
newItem.className = 'item'
document.body.appendChild(newItem)
console.log(items.length) // 4ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
```

### getElementsByTagName

é€šè¿‡æ ‡ç­¾åè·å–å…ƒç´ é›†åˆï¼š

```javascript
// è·å–æ‰€æœ‰ div
const divs = document.getElementsByTagName('div')

// è·å–æ‰€æœ‰å…ƒç´ 
const all = document.getElementsByTagName('*')

// å¯ä»¥åœ¨å…ƒç´ ä¸Šè°ƒç”¨
const container = document.getElementById('container')
const innerDivs = container.getElementsByTagName('div')
```

### getElementsByName

é€šè¿‡ name ï¿½ï¿½æ€§è·å–å…ƒç´ ï¼ˆå¸¸ç”¨äºè¡¨å•ï¼‰ï¼š

```javascript
// <input type="radio" name="gender" value="male">
// <input type="radio" name="gender" value="female">

const radios = document.getElementsByName('gender')
console.log(radios.length) // 2

// è·å–é€‰ä¸­çš„å€¼
for (const radio of radios) {
  if (radio.checked) {
    console.log(radio.value)
  }
}
```

## ç°ä»£é€‰æ‹©å™¨

### querySelector

ä½¿ç”¨ CSS é€‰æ‹©å™¨è·å–ç¬¬ä¸€ä¸ªåŒ¹é…å…ƒç´ ï¼š

```javascript
// é€šè¿‡ ID
const app = document.querySelector('#app')

// é€šè¿‡ç±»å
const firstItem = document.querySelector('.item')

// é€šè¿‡æ ‡ç­¾
const firstDiv = document.querySelector('div')

// ç»„åˆé€‰æ‹©å™¨
const activeItem = document.querySelector('.item.active')
const firstChild = document.querySelector('#list > li:first-child')
const link = document.querySelector('a[href^="https"]')

// å¤æ‚é€‰æ‹©å™¨
const element = document.querySelector(
  'div.container > ul.list li:nth-child(2) a'
)

// ä¸å­˜åœ¨è¿”å› null
const notExist = document.querySelector('.not-exist')
console.log(notExist) // null
```

### querySelectorAll

è·å–æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼ˆNodeListï¼‰ï¼š

```javascript
// è·å–æ‰€æœ‰åŒ¹é…å…ƒç´ 
const items = document.querySelectorAll('.item')
console.log(items.length)

// NodeList æ”¯æŒ forEach
items.forEach((item) => {
  console.log(item.textContent)
})

// ğŸ”¶ æ³¨æ„ï¼šquerySelectorAll è¿”å›çš„æ˜¯é™æ€ NodeList
const staticList = document.querySelectorAll('.item')
document.body.appendChild(createItem())
console.log(staticList.length) // ä¸å˜

// å¯¹æ¯”ï¼šgetElementsByClassName è¿”å›å®æ—¶ HTMLCollection
const liveList = document.getElementsByClassName('item')
document.body.appendChild(createItem())
console.log(liveList.length) // +1
```

### é€‰æ‹©å™¨æ€§èƒ½

```javascript
// æ€§èƒ½ä»é«˜åˆ°ä½ï¼š
// 1. getElementById - æœ€å¿«
document.getElementById('app')

// 2. getElementsByClassName - å¾ˆå¿«
document.getElementsByClassName('item')

// 3. getElementsByTagName - å¾ˆå¿«
document.getElementsByTagName('div')

// 4. querySelector - è¾ƒå¿«
document.querySelector('#app')

// 5. querySelectorAll - è¾ƒæ…¢ï¼ˆéœ€è¦éå†ï¼‰
document.querySelectorAll('.item')

// å®è·µå»ºè®®ï¼š
// - ID é€‰æ‹©ç”¨ getElementById
// - ç®€å•ç±»åç”¨ getElementsByClassName
// - å¤æ‚é€‰æ‹©å™¨ç”¨ querySelector/querySelectorAll
```

## éå† DOM

### çˆ¶å­å…³ç³»

```javascript
// <div id="parent">
//   æ–‡æœ¬èŠ‚ç‚¹
//   <span id="child">å­å…ƒç´ </span>
//   <!-- æ³¨é‡Š -->
// </div>

const parent = document.getElementById('parent')
const child = document.getElementById('child')

// å­èŠ‚ç‚¹ï¼ˆåŒ…å«æ‰€æœ‰ç±»å‹ï¼‰
console.log(parent.childNodes) // NodeList(5)ï¼šæ–‡æœ¬ã€spanã€æ–‡æœ¬ã€æ³¨é‡Šã€æ–‡æœ¬

// å­å…ƒç´ ï¼ˆåªæœ‰å…ƒç´ ï¿½ï¿½ï¿½ç‚¹ï¼‰
console.log(parent.children) // HTMLCollection(1)ï¼šspan

// ç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ªå­èŠ‚ç‚¹
console.log(parent.firstChild) // æ–‡æœ¬èŠ‚ç‚¹
console.log(parent.lastChild) // æ–‡æœ¬èŠ‚ç‚¹

// ç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ªå­å…ƒç´ 
console.log(parent.firstElementChild) // <span>
console.log(parent.lastElementChild) // <span>

// çˆ¶èŠ‚ç‚¹
console.log(child.parentNode) // <div id="parent">
console.log(child.parentElement) // <div id="parent">

// å­å…ƒç´ æ•°é‡
console.log(parent.childElementCount) // 1
```

### å…„å¼Ÿå…³ç³»

```javascript
// <ul>
//   <li id="first">1</li>
//   <li id="second">2</li>
//   <li id="third">3</li>
// </ul>

const second = document.getElementById('second')

// ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹
console.log(second.nextSibling) // å¯èƒ½æ˜¯æ–‡æœ¬èŠ‚ç‚¹
console.log(second.previousSibling) // å¯èƒ½æ˜¯æ–‡æœ¬èŠ‚ç‚¹

// ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ 
console.log(second.nextElementSibling) // <li id="third">
console.log(second.previousElementSibling) // <li id="first">
```

### closest

å‘ä¸ŠæŸ¥æ‰¾åŒ¹é…çš„ç¥–å…ˆå…ƒç´ ï¼š

```javascript
// <div class="container">
//   <div class="wrapper">
//     <button id="btn">ç‚¹å‡»</button>
//   </div>
// </div>

const btn = document.getElementById('btn')

// æŸ¥æ‰¾æœ€è¿‘çš„åŒ¹é…ç¥–å…ˆ
console.log(btn.closest('.wrapper')) // <div class="wrapper">
console.log(btn.closest('.container')) // <div class="container">
console.log(btn.closest('div')) // <div class="wrapper">
console.log(btn.closest('.not-exist')) // null

// å®é™…åº”ç”¨ï¼šäº‹ä»¶å§”æ‰˜ä¸­æ‰¾åˆ°ç›®æ ‡å…ƒç´ 
document.addEventListener('click', (e) => {
  const item = e.target.closest('.list-item')
  if (item) {
    console.log('ç‚¹å‡»äº†åˆ—è¡¨é¡¹:', item)
  }
})
```

### contains

æ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªèŠ‚ç‚¹ï¼š

```javascript
const parent = document.getElementById('parent')
const child = document.getElementById('child')
const other = document.getElementById('other')

console.log(parent.contains(child)) // true
console.log(parent.contains(parent)) // trueï¼ˆåŒ…å«è‡ªèº«ï¼‰
console.log(parent.contains(other)) // false
```

## matches å’Œ ç›¸å…³æ–¹æ³•

### matches

æ£€æŸ¥å…ƒç´ æ˜¯å¦åŒ¹é…é€‰æ‹©å™¨ï¼š

```javascript
const element = document.querySelector('.item.active')

console.log(element.matches('.item')) // true
console.log(element.matches('.active')) // true
console.log(element.matches('.item.active')) // true
console.log(element.matches('#app .item')) // å–å†³äº DOM ç»“æ„
console.log(element.matches('.other')) // false

// å®é™…åº”ç”¨
function handleClick(e) {
  if (e.target.matches('button.submit')) {
    // å¤„ç†æäº¤æŒ‰é’®ç‚¹å‡»
  }
  if (e.target.matches('a[href^="http"]')) {
    // å¤„ç†å¤–éƒ¨é“¾æ¥ç‚¹å‡»
  }
}
```

## ç‰¹æ®Šé€‰æ‹©å™¨

### document å±æ€§

```javascript
// æ–‡æ¡£å…ƒç´ 
console.log(document.documentElement) // <html>

// body å’Œ head
console.log(document.body) // <body>
console.log(document.head) // <head>

// æ‰€æœ‰è¡¨å•
console.log(document.forms) // HTMLCollection

// æ‰€æœ‰é“¾æ¥
console.log(document.links) // HTMLCollection

// æ‰€æœ‰å›¾ç‰‡
console.log(document.images) // HTMLCollection

// å½“å‰æ´»åŠ¨å…ƒç´ 
console.log(document.activeElement) // å½“å‰èšç„¦çš„å…ƒç´ 
```

### è¡¨å•å…ƒç´ 

```javascript
// <form id="myForm">
//   <input name="username">
//   <input name="password">
// </form>

const form = document.getElementById('myForm')

// é€šè¿‡ name è®¿é—®è¡¨å•å…ƒç´ 
console.log(form.username) // <input name="username">
console.log(form.password) // <input name="password">

// æ‰€æœ‰è¡¨å•å…ƒç´ 
console.log(form.elements) // HTMLFormControlsCollection
```

## å®ç”¨æŠ€å·§

### è½¬æ¢ä¸ºæ•°ç»„

```javascript
// HTMLCollection å’Œ NodeList ä¸æ˜¯çœŸæ­£çš„æ•°ç»„
const items = document.getElementsByClassName('item')

// æ–¹æ³•1ï¼šArray.from
const arr1 = Array.from(items)

// æ–¹æ³•2ï¼šå±•å¼€è¿ç®—ç¬¦
const arr2 = [...items]

// æ–¹æ³•3ï¼šArray.prototype.slice
const arr3 = Array.prototype.slice.call(items)

// ç°åœ¨å¯ä»¥ä½¿ç”¨æ•°ç»„æ–¹æ³•
arr1.filter((item) => item.classList.contains('active'))
arr1.map((item) => item.textContent)
```

### é“¾å¼é€‰æ‹©

```javascript
// åœ¨ç‰¹å®šå…ƒç´ å†…æŸ¥æ‰¾
const container = document.getElementById('container')
const items = container.querySelectorAll('.item')
const firstLink = container.querySelector('a')

// ç»„åˆä½¿ç”¨
const activeItem = document.getElementById('list').querySelector('.item.active')
```

### æ£€æŸ¥å…ƒç´ å­˜åœ¨

```javascript
// ä½¿ç”¨å¯é€‰é“¾
const text = document.querySelector('.item')?.textContent ?? 'é»˜è®¤'

// ä½¿ç”¨æ¡ä»¶åˆ¤æ–­
const element = document.querySelector('.item')
if (element) {
  element.style.color = 'red'
}

// ä½¿ç”¨ try-catchï¼ˆä¸æ¨èï¼‰
try {
  document.querySelector('.item').style.color = 'red'
} catch (e) {
  console.log('å…ƒç´ ä¸å­˜åœ¨')
}
```

### ç­‰å¾… DOM åŠ è½½

```javascript
// æ–¹æ³•1ï¼šDOMContentLoaded
document.addEventListener('DOMContentLoaded', () => {
  const app = document.getElementById('app')
  // DOM å·²åŠ è½½å®Œæˆ
})

// æ–¹æ³•2ï¼šå°†è„šæœ¬æ”¾åœ¨ body æœ«å°¾

// æ–¹æ³•3ï¼šdefer å±æ€§
// <script defer src="app.js"></script>

// æ–¹æ³•4ï¼šæ£€æŸ¥ readyState
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', init)
} else {
  init()
}
```

## å¸¸è§æ¨¡å¼

### è·å–æ‰€æœ‰æŒ‡å®šå…ƒç´ 

```javascript
// è·å–æ‰€æœ‰å¤é€‰æ¡†çš„å€¼
function getCheckedValues(name) {
  return [...document.querySelectorAll(`input[name="${name}"]:checked`)].map(
    (input) => input.value
  )
}

// ä½¿ç”¨
const selectedOptions = getCheckedValues('options')
```

### æŸ¥æ‰¾ç‰¹å®šæ¡ä»¶çš„å…ƒç´ 

```javascript
// æŸ¥æ‰¾åŒ…å«ç‰¹å®šæ–‡æœ¬çš„å…ƒç´ 
function findByText(selector, text) {
  return [...document.querySelectorAll(selector)].find((el) =>
    el.textContent.includes(text)
  )
}

const item = findByText('.menu-item', 'è®¾ç½®')
```

### å®‰å…¨çš„é€‰æ‹©å™¨å‡½æ•°

```javascript
function $(selector, context = document) {
  return context.querySelector(selector)
}

function $$(selector, context = document) {
  return [...context.querySelectorAll(selector)]
}

// ä½¿ç”¨
const app = $('#app')
const items = $$('.item')
const innerItems = $$('.inner-item', app)
```

## æ€»ç»“

| æ–¹æ³•                   | è¿”å›å€¼         | å®æ—¶æ€§ | é€Ÿåº¦ |
| ---------------------- | -------------- | ------ | ---- |
| getElementById         | Element/null   | -      | æœ€å¿« |
| getElementsByClassName | HTMLCollection | å®æ—¶   | å¿«   |
| getElementsByTagName   | HTMLCollection | å®æ—¶   | å¿«   |
| querySelector          | Element/null   | -      | è¾ƒå¿« |
| querySelectorAll       | NodeList       | é™æ€   | è¾ƒæ…¢ |

| éå†å±æ€§           | åŒ…å«æ–‡æœ¬/æ³¨é‡Š |
| ------------------ | ------------- |
| childNodes         | æ˜¯            |
| children           | å¦            |
| firstChild         | æ˜¯            |
| firstElementChild  | å¦            |
| nextSibling        | æ˜¯            |
| nextElementSibling | å¦            |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- ID é€‰æ‹©ç”¨ `getElementById`ï¼Œæœ€å¿«
- å¤æ‚é€‰æ‹©ç”¨ `querySelector/querySelectorAll`
- `getElementsBy*` è¿”å›å®æ—¶é›†åˆ
- `querySelectorAll` è¿”å›é™æ€é›†åˆ
- ä½¿ç”¨ `closest` å‘ä¸ŠæŸ¥æ‰¾ç¥–å…ˆå…ƒç´ 
