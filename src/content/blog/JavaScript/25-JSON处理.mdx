---
title: 'JSON å¤„ç†'
description: 'æŒæ¡ JavaScript JSON çš„è§£æä¸åºåˆ—åŒ–ï¼Œç†è§£æ•°æ®äº¤æ¢æ ¼å¼'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'JSON', 'åºåˆ—åŒ–', 'æ•°æ®äº¤æ¢']
---

JSONï¼ˆJavaScript Object Notationï¼‰æ˜¯è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚å®ƒåŸºäº JavaScript å¯¹è±¡è¯­æ³•ï¼Œä½†ç‹¬ç«‹äºè¯­è¨€ï¼Œè¢«å¹¿æ³›ç”¨äºå‰åç«¯æ•°æ®ä¼ è¾“ã€‚

## ğŸ¯ JSON è¯­æ³•

### åŸºæœ¬è§„åˆ™

```javascript
// JSON æ˜¯çº¯æ–‡æœ¬æ ¼å¼
const jsonString = '{"name": "å¼ ä¸‰", "age": 25}'

// åˆæ³•çš„ JSON å€¼ç±»å‹ï¼š
// - å­—ç¬¦ä¸²ï¼ˆå¿…é¡»ç”¨åŒå¼•å·ï¼‰
// - æ•°å­—
// - å¸ƒå°”å€¼ï¼ˆtrue/falseï¼‰
// - null
// - æ•°ç»„
// - å¯¹è±¡

// âœ… åˆæ³• JSON
;('{"name": "å¼ ä¸‰"}')
;('[1, 2, 3]')
;('"hello"')
;('123')
;('true')
;('null')

// ğŸ”¶ ä¸åˆæ³• JSON
;("{'name': 'å¼ ä¸‰'}") // å•å¼•å·ä¸è¡Œ
;('{name: "å¼ ä¸‰"}') // é”®å¿…é¡»ç”¨åŒå¼•å·
;('undefined') // undefined ä¸æ˜¯ JSON å€¼
;('{a: function(){}}') // å‡½æ•°ä¸æ˜¯ JSON å€¼
```

### ä¸ JavaScript å¯¹è±¡çš„åŒºåˆ«

```javascript
// JavaScript å¯¹è±¡
const jsObject = {
  'name': 'å¼ ä¸‰', // é”®ä¸éœ€è¦å¼•å·
  'my-age': 25, // ç‰¹æ®Šé”®éœ€è¦å¼•å·
  'sayHi'() {}, // å¯ä»¥æœ‰æ–¹æ³•
  'date': new Date(), // å¯ä»¥æœ‰ Date å¯¹è±¡
  'regex': /abc/, // å¯ä»¥æœ‰æ­£åˆ™
  'undefined': undefined,
}

// JSON å­—ç¬¦ä¸²
const jsonString = `{
  "name": "å¼ ä¸‰",
  "my-age": 25
}`
// ä¸èƒ½æœ‰æ–¹æ³•ã€Dateã€æ­£åˆ™ã€undefined
```

## JSON.parse

### åŸºæœ¬ç”¨æ³•

```javascript
// å°† JSON å­—ç¬¦ä¸²è§£æä¸º JavaScript å€¼
const jsonString = '{"name": "å¼ ä¸‰", "age": 25}'
const obj = JSON.parse(jsonString)

console.log(obj.name) // 'å¼ ä¸‰'
console.log(obj.age) // 25

// è§£ææ•°ç»„
const arrString = '[1, 2, 3]'
const arr = JSON.parse(arrString)
console.log(arr) // [1, 2, 3]

// è§£æåŸºæœ¬ç±»å‹
JSON.parse('"hello"') // 'hello'
JSON.parse('123') // 123
JSON.parse('true') // true
JSON.parse('null') // null
```

### é”™è¯¯å¤„ç†

```javascript
// ğŸ”¶ è§£ææ— æ•ˆ JSON ä¼šæŠ›å‡ºé”™è¯¯
try {
  JSON.parse('invalid json')
} catch (error) {
  console.log(error.message) // Unexpected token...
}

// å®‰å…¨çš„è§£æï¿½ï¿½ï¿½æ•°
function safeJsonParse(str, defaultValue = null) {
  try {
    return JSON.parse(str)
  } catch {
    return defaultValue
  }
}

safeJsonParse('{"valid": true}') // { valid: true }
safeJsonParse('invalid') // null
safeJsonParse('invalid', {}) // {}
```

### reviver å‡½æ•°

```javascript
// ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥è½¬æ¢è§£æç»“æœ
const jsonString = '{"name": "å¼ ä¸‰", "birthDate": "1990-05-20"}'

const obj = JSON.parse(jsonString, (key, value) => {
  // key æ˜¯å±æ€§åï¼Œvalue æ˜¯å±æ€§å€¼
  if (key === 'birthDate') {
    return new Date(value) // è½¬ä¸º Date å¯¹è±¡
  }
  return value
})

console.log(obj.birthDate instanceof Date) // true

// è¿‡æ»¤å±æ€§
const filtered = JSON.parse('{"a": 1, "b": 2, "c": 3}', (key, value) => {
  if (key === 'b') return undefined // æ’é™¤ b
  return value
})
console.log(filtered) // { a: 1, c: 3 }
```

## JSON.stringify

### åŸºæœ¬ç”¨æ³•

```javascript
// å°† JavaScript å€¼è½¬ä¸º JSON å­—ç¬¦ä¸²
const obj = { name: 'å¼ ä¸‰', age: 25 }
const jsonString = JSON.stringify(obj)

console.log(jsonString) // '{"name":"å¼ ä¸‰","age":25}'

// è½¬æ¢æ•°ç»„
JSON.stringify([1, 2, 3]) // '[1,2,3]'

// è½¬æ¢åŸºæœ¬ç±»å‹
JSON.stringify('hello') // '"hello"'
JSON.stringify(123) // '123'
JSON.stringify(true) // 'true'
JSON.stringify(null) // 'null'
```

### ç‰¹æ®Šå€¼å¤„ç†

```javascript
// undefinedã€å‡½æ•°ã€Symbol ä¼šè¢«å¿½ç•¥æˆ–è½¬ä¸º null
const obj = {
  a: undefined,
  b: function () {},
  c: Symbol('sym'),
  d: 'valid',
}

JSON.stringify(obj) // '{"d":"valid"}'

// åœ¨æ•°ç»„ä¸­ä¼šè½¬ä¸º null
JSON.stringify([undefined, function () {}, Symbol()])
// '[null,null,null]'

// NaN å’Œ Infinity è½¬ä¸º null
JSON.stringify(NaN) // 'null'
JSON.stringify(Infinity) // 'null'

// Date è½¬ä¸º ISO å­—ç¬¦ä¸²
JSON.stringify(new Date()) // '"2025-01-15T02:30:00.000Z"'

// æ­£åˆ™è½¬ä¸ºç©ºå¯¹è±¡
JSON.stringify(/abc/) // '{}'
```

### replacer å‚æ•°

```javascript
// æ•°ç»„å½¢å¼ï¼šåªåŒ…å«æŒ‡å®šå±æ€§
const obj = { a: 1, b: 2, c: 3 }
JSON.stringify(obj, ['a', 'b']) // '{"a":1,"b":2}'

// å‡½æ•°å½¢å¼ï¼šè‡ªå®šä¹‰è½¬æ¢
const data = {
  name: 'å¼ ä¸‰',
  password: '123456',
  age: 25,
}

const result = JSON.stringify(data, (key, value) => {
  if (key === 'password') {
    return undefined // æ’é™¤å¯†ç 
  }
  if (typeof value === 'number') {
    return value * 2 // æ•°å­—ç¿»å€
  }
  return value
})
console.log(result) // '{"name":"å¼ ä¸‰","age":50}'
```

### space å‚æ•°ï¼ˆæ ¼å¼åŒ–ï¼‰

```javascript
const obj = { name: 'å¼ ä¸‰', info: { age: 25, city: 'åŒ—äº¬' } }

// ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ç¼©è¿›
console.log(JSON.stringify(obj, null, 2))
/*
{
  "name": "å¼ ä¸‰",
  "info": {
    "age": 25,
    "city": "åŒ—äº¬"
  }
}
*/

// ä½¿ç”¨ tab ç¼©è¿›
console.log(JSON.stringify(obj, null, '\t'))

// ä½¿ç”¨ 4 ä¸ªç©ºæ ¼
console.log(JSON.stringify(obj, null, 4))
```

### toJSON æ–¹æ³•

```javascript
// å¯¹è±¡å¯ä»¥å®šä¹‰ toJSON æ–¹æ³•è‡ªå®šä¹‰åºåˆ—åŒ–
const user = {
  name: 'å¼ ä¸‰',
  password: '123456',
  toJSON() {
    return {
      name: this.name,
      // ä¸åŒ…å« password
    }
  },
}

JSON.stringify(user) // '{"name":"å¼ ä¸‰"}'

// Date å†…ç½®äº† toJSON
const date = new Date()
date.toJSON() // '2025-01-15T02:30:00.000Z'
```

## æ·±æ‹·è´

### JSON æ–¹å¼

```javascript
// ä½¿ç”¨ JSON å®ç°æ·±æ‹·è´
function deepClone(obj) {
  return JSON.parse(JSON.stringify(obj))
}

const original = {
  name: 'å¼ ä¸‰',
  info: { age: 25 },
}

const cloned = deepClone(original)
cloned.info.age = 30

console.log(original.info.age) // 25ï¼ˆåŸå¯¹è±¡æœªå˜ï¼‰
console.log(cloned.info.age) // 30
```

### ğŸ”¶ JSON æ·±æ‹·è´çš„é™åˆ¶

```javascript
const obj = {
  date: new Date(), // å˜æˆå­—ç¬¦ä¸²
  regex: /abc/, // å˜æˆç©ºå¯¹è±¡
  func: function () {}, // ä¸¢å¤±
  undef: undefined, // ä¸¢å¤±
  symbol: Symbol('sym'), // ä¸¢å¤±
  nan: NaN, // å˜æˆ null
  infinity: Infinity, // å˜æˆ null
  circular: null, // å¾ªç¯å¼•ç”¨ä¼šæŠ¥é”™
}

// obj.circular = obj  // å¾ªç¯å¼•ç”¨
// JSON.stringify(obj)  // TypeError: Converting circular structure to JSON

const cloned = JSON.parse(JSON.stringify(obj))
console.log(cloned)
// {
//   date: '2025-01-15T02:30:00.000Z',
//   regex: {},
//   nan: null,
//   infinity: null
// }
```

### æ›´å®Œå–„çš„æ·±æ‹·è´

```javascript
function deepClone(obj, hash = new WeakMap()) {
  // å¤„ç† null å’Œéå¯¹è±¡
  if (obj === null || typeof obj !== 'object') {
    return obj
  }

  // å¤„ç† Date
  if (obj instanceof Date) {
    return new Date(obj)
  }

  // å¤„ç† RegExp
  if (obj instanceof RegExp) {
    return new RegExp(obj)
  }

  // å¤„ç†å¾ªç¯å¼•ç”¨
  if (hash.has(obj)) {
    return hash.get(obj)
  }

  // å¤„ç†æ•°ç»„å’Œå¯¹è±¡
  const cloned = Array.isArray(obj) ? [] : {}
  hash.set(obj, cloned)

  for (const key in obj) {
    if (obj.hasOwnProperty(key)) {
      cloned[key] = deepClone(obj[key], hash)
    }
  }

  return cloned
}

// ç°ä»£æ–¹æ³•ï¼šstructuredCloneï¼ˆæµè§ˆå™¨å’Œ Node.js 17+ï¼‰
const cloned = structuredClone(obj)
```

## å®é™…åº”ç”¨

### æœ¬åœ°å­˜å‚¨

```javascript
// å­˜å‚¨å¯¹è±¡åˆ° localStorage
const user = { name: 'å¼ ä¸‰', age: 25, preferences: { theme: 'dark' } }

// å­˜å‚¨
localStorage.setItem('user', JSON.stringify(user))

// è¯»å–
const stored = localStorage.getItem('user')
const parsedUser = stored ? JSON.parse(stored) : null

// å°è£…
const storage = {
  set(key, value) {
    localStorage.setItem(key, JSON.stringify(value))
  },
  get(key, defaultValue = null) {
    const item = localStorage.getItem(key)
    try {
      return item ? JSON.parse(item) : defaultValue
    } catch {
      return defaultValue
    }
  },
  remove(key) {
    localStorage.removeItem(key)
  },
}

storage.set('config', { theme: 'dark' })
storage.get('config') // { theme: 'dark' }
```

### API æ•°æ®å¤„ç†

```javascript
// å‘é€ JSON æ•°æ®
async function postData(url, data) {
  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
  })

  return response.json() // è‡ªåŠ¨è§£æ JSON
}

// å¤„ç†å“åº”
async function fetchUser(id) {
  const response = await fetch(`/api/users/${id}`)
  const data = await response.json()

  // è½¬æ¢æ—¥æœŸå­—æ®µ
  return {
    ...data,
    createdAt: new Date(data.createdAt),
    updatedAt: new Date(data.updatedAt),
  }
}
```

### æ—¥å¿—å’Œè°ƒè¯•

```javascript
// æ ¼å¼åŒ–è¾“å‡ºå¯¹è±¡
function prettyPrint(obj) {
  console.log(JSON.stringify(obj, null, 2))
}

// å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—
function log(message, data) {
  console.log(
    JSON.stringify(
      {
        timestamp: new Date().toISOString(),
        message,
        data,
      },
      null,
      2
    )
  )
}

log('ï¿½ï¿½æˆ·ç™»å½•', { userId: 123, ip: '192.168.1.1' })
```

### æ¯”è¾ƒå¯¹è±¡

```javascript
// ç®€å•å¯¹è±¡æ¯”è¾ƒï¼ˆæœ‰å±€é™æ€§ï¼‰
function simpleEqual(obj1, obj2) {
  return JSON.stringify(obj1) === JSON.stringify(obj2)
}

simpleEqual({ a: 1, b: 2 }, { a: 1, b: 2 }) // true

// ğŸ”¶ æ³¨æ„ï¼šå±æ€§é¡ºåºä¼šå½±å“ç»“æœ
simpleEqual({ a: 1, b: 2 }, { b: 2, a: 1 }) // false

// æ”¹è¿›ç‰ˆï¼šæ’åºé”®
function sortedStringify(obj) {
  return JSON.stringify(obj, Object.keys(obj).sort())
}

// æ›´å¥½çš„æ–¹å¼ï¼šæ·±åº¦æ¯”è¾ƒå‡½æ•°
function deepEqual(a, b) {
  if (a === b) return true
  if (typeof a !== 'object' || typeof b !== 'object') return false
  if (a === null || b === null) return false

  const keysA = Object.keys(a)
  const keysB = Object.keys(b)

  if (keysA.length !== keysB.length) return false

  return keysA.every((key) => deepEqual(a[key], b[key]))
}
```

### é…ç½®æ–‡ä»¶å¤„ç†

```javascript
// åˆå¹¶é…ç½®
function mergeConfig(defaults, custom) {
  // æ·±æ‹·è´é»˜è®¤é…ç½®
  const config = JSON.parse(JSON.stringify(defaults))

  // é€’å½’åˆå¹¶
  function merge(target, source) {
    for (const key in source) {
      if (
        source[key] &&
        typeof source[key] === 'object' &&
        !Array.isArray(source[key])
      ) {
        target[key] = target[key] || {}
        merge(target[key], source[key])
      } else {
        target[key] = source[key]
      }
    }
    return target
  }

  return merge(config, custom)
}

const defaults = {
  theme: 'light',
  language: 'zh',
  features: { darkMode: false, animations: true },
}

const custom = {
  theme: 'dark',
  features: { darkMode: true },
}

mergeConfig(defaults, custom)
// { theme: 'dark', language: 'zh', features: { darkMode: true, animations: true } }
```

## æ€§èƒ½ä¼˜åŒ–

### å¤§æ•°æ®å¤„ç†

```javascript
// ğŸ”¶ å¤§å¯¹è±¡åºåˆ—åŒ–å¯èƒ½é˜»å¡ä¸»çº¿ç¨‹
const hugeArray = new Array(100000).fill({ data: 'some data' })

// è€ƒè™‘ä½¿ç”¨ Web Worker
const worker = new Worker('json-worker.js')
worker.postMessage({ action: 'stringify', data: hugeArray })
worker.onmessage = (e) => {
  const jsonString = e.data
}

// æˆ–åˆ†æ‰¹å¤„ç†
async function stringifyLargeArray(arr, batchSize = 1000) {
  const chunks = []
  for (let i = 0; i < arr.length; i += batchSize) {
    chunks.push(JSON.stringify(arr.slice(i, i + batchSize)))
    await new Promise((resolve) => setTimeout(resolve, 0)) // è®©å‡ºä¸»çº¿ç¨‹
  }
  return '[' + chunks.map((c) => c.slice(1, -1)).join(',') + ']'
}
```

### é€‰æ‹©æ€§åºåˆ—åŒ–

```javascript
// åªåºåˆ—åŒ–éœ€è¦çš„å­—æ®µ
const user = {
  id: 1,
  name: 'å¼ ä¸‰',
  password: 'secret',
  profile: {
    /* å¤§é‡æ•°æ® */
  },
  logs: [
    /* æ›´å¤šæ•°æ® */
  ],
}

// ä½¿ç”¨ replacer æ•°ç»„
JSON.stringify(user, ['id', 'name']) // '{"id":1,"name":"å¼ ä¸‰"}'
```

## æ€»ç»“

| æ–¹æ³•                               | è¯´æ˜             |
| ---------------------------------- | ---------------- |
| `JSON.parse(str)`                  | è§£æ JSON å­—ç¬¦ä¸² |
| `JSON.parse(str, reviver)`         | å¸¦è½¬æ¢å‡½æ•°çš„è§£æ |
| `JSON.stringify(obj)`              | è½¬ä¸º JSON å­—ç¬¦ä¸² |
| `JSON.stringify(obj, replacer)`    | å¸¦è¿‡æ»¤çš„åºåˆ—åŒ–   |
| `JSON.stringify(obj, null, space)` | æ ¼å¼åŒ–è¾“å‡º       |

| ç±»å‹           | stringify ç»“æœ |
| -------------- | -------------- |
| `undefined`    | è¢«å¿½ç•¥/null    |
| `function`     | è¢«å¿½ç•¥/null    |
| `Symbol`       | è¢«å¿½ç•¥/null    |
| `Date`         | ISO å­—ç¬¦ä¸²     |
| `RegExp`       | ç©ºå¯¹è±¡ `{}`    |
| `NaN/Infinity` | `null`         |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- JSON é”®å¿…é¡»ç”¨åŒå¼•å·
- ä¸æ”¯æŒ undefinedã€å‡½æ•°ã€Symbolã€å¾ªç¯å¼•ç”¨
- ç”¨ try-catch åŒ…è£¹ parse é˜²æ­¢é”™è¯¯
- æ·±æ‹·è´æœ‰é™åˆ¶ï¼Œå¤æ‚åœºæ™¯ç”¨ structuredClone
- å¤§æ•°æ®å¤„ç†æ³¨æ„æ€§èƒ½é—®é¢˜
