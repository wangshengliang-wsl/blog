---
title: 'ä½œç”¨åŸŸ'
description: 'æ·±å…¥ç†è§£ JavaScript çš„å…¨å±€ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸå’Œå—çº§ä½œç”¨åŸŸ'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'ä½œç”¨åŸŸ', 'å˜é‡', 'è¯æ³•ä½œç”¨åŸŸ']
---

ä½œç”¨åŸŸå†³å®šäº†å˜é‡çš„å¯è®¿é—®èŒƒå›´ã€‚JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸï¼Œå˜é‡çš„ä½œç”¨åŸŸåœ¨ä»£ç ç¼–å†™æ—¶å°±ç¡®å®šäº†ã€‚

## ğŸ¯ ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ

ä½œç”¨åŸŸæ˜¯å˜é‡å’Œå‡½æ•°çš„å¯è®¿é—®åŒºåŸŸã€‚å®ƒå†³å®šäº†ä»£ç ä¸­å˜é‡çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚

```javascript
// å…¨å±€å˜é‡ï¼šä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®
const globalVar = 'å…¨å±€'

function outer() {
  // å‡½æ•°å†…å˜é‡ï¼šåªåœ¨å‡½æ•°å†…å¯è®¿é—®
  const outerVar = 'å¤–å±‚'

  function inner() {
    // å†…å±‚å‡½æ•°å¯ä»¥è®¿é—®å¤–å±‚å˜é‡
    const innerVar = 'å†…å±‚'
    console.log(globalVar) // "å…¨å±€"
    console.log(outerVar) // "å¤–å±‚"
    console.log(innerVar) // "å†…å±‚"
  }

  inner()
  // console.log(innerVar)  // ReferenceError
}

outer()
// console.log(outerVar)  // ReferenceError
```

## å…¨å±€ä½œç”¨åŸŸ

### å…¨å±€å˜é‡

```javascript
// æ–¹å¼1ï¼šåœ¨æœ€å¤–å±‚å£°æ˜
const globalA = 'a'
let globalB = 'b'
var globalC = 'c'

// æ–¹å¼2ï¼šæŒ‚è½½åˆ°å…¨å±€å¯¹è±¡ï¼ˆä¸æ¨èï¼‰
window.globalD = 'd' // æµè§ˆå™¨
global.globalE = 'e' // Node.js

// æ–¹å¼3ï¼šæœªå£°æ˜ç›´æ¥èµ‹å€¼ï¼ˆä¸¥æ ¼æ¨¡å¼æŠ¥é”™ï¼‰
function bad() {
  implicitGlobal = 'éšå¼å…¨å±€' // å±é™©ï¼
}
```

### å…¨å±€å¯¹è±¡

```javascript
// æµè§ˆå™¨ä¸­çš„å…¨å±€å¯¹è±¡
console.log(window === globalThis) // true

// var å£°æ˜çš„å˜é‡æˆä¸ºå…¨å±€å¯¹è±¡å±æ€§
var x = 1
console.log(window.x) // 1

// let/const ä¸ä¼š
let y = 2
const z = 3
console.log(window.y) // undefined
console.log(window.z) // undefined

// å…¨å±€å‡½æ•°ä¹Ÿæ˜¯å…¨å±€å¯¹è±¡çš„æ–¹æ³•
function greet() {}
console.log(window.greet) // Æ’ greet()
```

### å…¨å±€æ±¡æŸ“

```javascript
// ğŸ”¶ é—®é¢˜ï¼šå…¨å±€å˜é‡å¯èƒ½è¢«è¦†ç›–
var name = 'å¼ ä¸‰'
// ... å¾ˆå¤šä»£ç å
var name = 'æå››' // è¦†ç›–äº†ï¼

// âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ IIFE
;(function () {
  var name = 'å¼ ä¸‰'
  // åªåœ¨å‡½æ•°å†…å¯ç”¨
})()

// âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ¨¡å—
// module.js
export const name = 'å¼ ä¸‰'

// âœ… è§£å†³æ–¹æ¡ˆ3ï¼šä½¿ç”¨å—çº§ä½œç”¨åŸŸ
{
  const name = 'å¼ ä¸‰'
}
```

## å‡½æ•°ä½œç”¨åŸŸ

### åŸºæœ¬æ¦‚å¿µ

```javascript
function outer() {
  var x = 1

  function inner() {
    var y = 2
    console.log(x) // 1ï¼ˆå¯ä»¥è®¿é—®å¤–å±‚ï¼‰
    console.log(y) // 2
  }

  inner()
  console.log(x) // 1
  // console.log(y)  // ReferenceError
}

outer()
// console.log(x)  // ReferenceError
```

### var çš„å‡½æ•°ä½œç”¨åŸŸ

```javascript
function example() {
  if (true) {
    var x = 1 // å‡½æ•°ä½œç”¨åŸŸï¼Œä¸æ˜¯å—ä½œç”¨åŸŸ
  }
  console.log(x) // 1ï¼ˆå¯ä»¥è®¿é—®ï¼‰

  for (var i = 0; i < 3; i++) {
    // ...
  }
  console.log(i) // 3ï¼ˆå¯ä»¥è®¿é—®ï¼‰
}
```

### å˜é‡æå‡

```javascript
function hoisting() {
  console.log(x) // undefinedï¼ˆä¸æ˜¯ ReferenceErrorï¼‰
  var x = 1
  console.log(x) // 1
}

// ç›¸å½“äº
function hoisting() {
  var x // å£°æ˜æå‡åˆ°é¡¶éƒ¨
  console.log(x) // undefined
  x = 1 // èµ‹å€¼ä¿æŒåŸä½
  console.log(x) // 1
}

// å‡½æ•°å£°æ˜ä¹Ÿä¼šæå‡
sayHello() // "Hello!"ï¼ˆå¯ä»¥åœ¨å£°æ˜å‰è°ƒç”¨ï¼‰
function sayHello() {
  console.log('Hello!')
}

// ä½†å‡½æ•°è¡¨è¾¾å¼ä¸ä¼šå®Œå…¨æå‡
// greet()  // TypeError: greet is not a function
var greet = function () {
  console.log('Hi!')
}
```

## å—çº§ä½œç”¨åŸŸ

### let å’Œ const

```javascript
// å—çº§ä½œç”¨åŸŸ
{
  let x = 1
  const y = 2
  var z = 3
}

// console.log(x)  // ReferenceError
// console.log(y)  // ReferenceError
console.log(z) // 3ï¼ˆvar ä¸å—å—é™åˆ¶ï¼‰

// if è¯­å¥
if (true) {
  let blockVar = 'block'
}
// console.log(blockVar)  // ReferenceError

// for å¾ªç¯
for (let i = 0; i < 3; i++) {
  console.log(i)
}
// console.log(i)  // ReferenceError
```

### æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰

```javascript
// let/const å£°æ˜çš„å˜é‡åœ¨å£°æ˜å‰ä¸å¯è®¿é—®
console.log(x) // ReferenceError: Cannot access 'x' before initialization
let x = 1

// å³ä½¿å¤–å±‚æœ‰åŒåå˜é‡
let y = 'outer'
{
  // TDZ å¼€å§‹
  // console.log(y)  // ReferenceError
  let y = 'inner' // TDZ ç»“æŸ
  console.log(y) // "inner"
}

// typeof ä¹Ÿä¼šè§¦å‘ TDZ
// console.log(typeof undeclared)  // "undefined"
// console.log(typeof z)  // ReferenceError
let z = 1
```

### å¾ªç¯ä¸­çš„å—çº§ä½œç”¨åŸŸ

```javascript
// varï¼šå…±äº«åŒä¸€ä¸ªå˜é‡
for (var i = 0; i < 3; i++) {
  setTimeout(() => console.log(i), 100)
}
// è¾“å‡ºï¼š3, 3, 3

// letï¼šæ¯æ¬¡è¿­ä»£åˆ›å»ºæ–°çš„ç»‘å®š
for (let j = 0; j < 3; j++) {
  setTimeout(() => console.log(j), 100)
}
// è¾“å‡ºï¼š0, 1, 2

// ES5 è§£å†³æ–¹æ¡ˆï¼šIIFE
for (var k = 0; k < 3; k++) {
  ;(function (k) {
    setTimeout(() => console.log(k), 100)
  })(k)
}
// è¾“å‡ºï¼š0, 1, 2
```

## è¯æ³•ä½œç”¨åŸŸ

JavaScript ä½¿ç”¨è¯æ³•ä½œç”¨åŸŸï¼ˆé™æ€ä½œç”¨åŸŸï¼‰ï¼Œä½œç”¨åŸŸåœ¨ä»£ç ç¼–å†™æ—¶ç¡®å®šã€‚

```javascript
const x = 'global'

function outer() {
  const x = 'outer'

  function inner() {
    console.log(x) // æŸ¥æ‰¾å®šä¹‰æ—¶çš„ä½œç”¨åŸŸé“¾
  }

  return inner
}

const fn = outer()
fn() // "outer"ï¼ˆä¸æ˜¯ "global"ï¼‰

// å¯¹æ¯”åŠ¨æ€ä½œç”¨åŸŸï¼ˆJavaScript ä¸æ˜¯ï¼‰
// åŠ¨æ€ä½œç”¨åŸŸä¼šè¾“å‡ºè°ƒç”¨æ—¶çš„ x
```

### ä½œç”¨åŸŸé“¾

```javascript
const a = 1

function outer() {
  const b = 2

  function middle() {
    const c = 3

    function inner() {
      const d = 4
      // ä½œç”¨åŸŸé“¾ï¼šinner -> middle -> outer -> global
      console.log(a, b, c, d) // 1, 2, 3, 4
    }

    inner()
  }

  middle()
}

outer()
```

### å˜é‡æŸ¥æ‰¾

```javascript
const x = 'global'

function foo() {
  console.log(x) // å½“å‰ä½œç”¨åŸŸæ²¡æœ‰ï¼Œå‘ä¸ŠæŸ¥æ‰¾
}

function bar() {
  const x = 'bar'
  foo() // è¿˜æ˜¯è¾“å‡º "global"
}

bar()

// foo çš„ä½œç”¨åŸŸé“¾åœ¨å®šä¹‰æ—¶ç¡®å®šï¼šfoo -> global
// ä¸æ˜¯åœ¨è°ƒç”¨æ—¶ï¼šfoo -> bar -> global
```

## æ¨¡å—ä½œç”¨åŸŸ

```javascript
// ES6 æ¨¡å—æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ

// module.js
const privateVar = 'ç§æœ‰'
export const publicVar = 'å…¬å¼€'

export function greet() {
  console.log(privateVar) // å¯ä»¥è®¿é—®ç§æœ‰å˜é‡
}

// main.js
import { publicVar, greet } from './module.js'
console.log(publicVar) // "å…¬å¼€"
// console.log(privateVar)  // ReferenceError

// æ¨¡å—é¡¶å±‚çš„ this æ˜¯ undefined
console.log(this) // undefinedï¼ˆåœ¨æ¨¡å—ä¸­ï¼‰
```

## ä½œç”¨åŸŸå®è·µ

### æœ€å°åŒ–å…¨å±€å˜é‡

```javascript
// ğŸ”¶ ä¸å¥½ï¼šæ±¡æŸ“å…¨å±€
var config = {}
var utils = {}
var app = {}

// âœ… ä½¿ç”¨å‘½åç©ºé—´
var MyApp = {
  config: {},
  utils: {},
  init: function () {},
}

// âœ… ä½¿ç”¨æ¨¡å—
// config.js
export default { api: 'https://api.example.com' }

// âœ… ä½¿ç”¨ IIFE
const App = (function () {
  const private = 'ç§æœ‰'

  return {
    public: 'å…¬å¼€',
    getPrivate() {
      return private
    },
  }
})()
```

### é¿å…å˜é‡é®è”½

```javascript
const name = 'å…¨å±€'

function greet() {
  // ğŸ”¶ é®è”½å¤–å±‚å˜é‡å¯èƒ½å¯¼è‡´å›°æƒ‘
  const name = 'å±€éƒ¨'
  console.log(name)
}

// âœ… ä½¿ç”¨æ›´å…·æè¿°æ€§çš„åç§°
const globalName = 'å…¨å±€'

function greet() {
  const userName = 'å±€éƒ¨'
  console.log(userName)
}
```

### åˆ©ç”¨å—çº§ä½œç”¨åŸŸ

```javascript
// ä¸´æ—¶å˜é‡éš”ç¦»
function process(data) {
  // å¤„ç†é˜¶æ®µ1
  {
    const temp = data.map((x) => x * 2)
    // ä½¿ç”¨ temp
  }
  // temp ä¸å†å¯è®¿é—®

  // å¤„ç†é˜¶æ®µ2
  {
    const temp = data.filter((x) => x > 0)
    // ä½¿ç”¨ temp
  }
}

// switch è¯­å¥ä¸­çš„å—ä½œç”¨åŸŸ
switch (action) {
  case 'increment': {
    const step = 1
    result += step
    break
  }
  case 'decrement': {
    const step = 1
    result -= step
    break
  }
}
```

## å¸¸è§é™·é˜±

### ğŸ™‹ æ„å¤–åˆ›å»ºå…¨å±€å˜é‡

```javascript
function bad() {
  // å¿˜è®°å£°æ˜
  oops = 'å…¨å±€å˜é‡' // éä¸¥æ ¼æ¨¡å¼ä¸‹åˆ›å»ºå…¨å±€å˜é‡
}

// ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼é˜²æ­¢
;('use strict')
function good() {
  oops = '...' // ReferenceError
}
```

### ğŸ™‹ å¾ªç¯ä¸­çš„é—­åŒ…

```javascript
// ç»å…¸é—®é¢˜
const buttons = document.querySelectorAll('button')

// ğŸ”¶ é”™è¯¯ï¼šæ‰€æœ‰æŒ‰é’®éƒ½è¾“å‡ºç›¸åŒçš„å€¼
for (var i = 0; i < buttons.length; i++) {
  buttons[i].onclick = function () {
    console.log(i) // æ€»æ˜¯ buttons.length
  }
}

// âœ… ä½¿ç”¨ let
for (let i = 0; i < buttons.length; i++) {
  buttons[i].onclick = function () {
    console.log(i) // æ­£ç¡®çš„ç´¢å¼•
  }
}

// âœ… ä½¿ç”¨é—­åŒ…
for (var i = 0; i < buttons.length; i++) {
  ;(function (j) {
    buttons[j].onclick = function () {
      console.log(j)
    }
  })(i)
}
```

### ğŸ™‹ å‡½æ•°å£°æ˜åœ¨å—å†…

```javascript
// åœ¨å—å†…çš„å‡½æ•°å£°æ˜è¡Œä¸ºä¸ä¸€è‡´
if (true) {
  function foo() {
    return 'if'
  }
} else {
  function foo() {
    return 'else'
  }
}

// ä¸åŒæµè§ˆå™¨å¯èƒ½æœ‰ä¸åŒç»“æœ
// æ¨èä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼
let foo
if (true) {
  foo = function () {
    return 'if'
  }
} else {
  foo = function () {
    return 'else'
  }
}
```

## æ€»ç»“

| ä½œç”¨åŸŸç±»å‹ | åˆ›å»ºæ–¹å¼        | å˜é‡å£°æ˜      |
| ---------- | --------------- | ------------- |
| å…¨å±€ä½œç”¨åŸŸ | æœ€å¤–å±‚ä»£ç       | var/let/const |
| å‡½æ•°ä½œç”¨åŸŸ | function å…³é”®å­— | var/let/const |
| å—çº§ä½œç”¨åŸŸ | {} ä»£ç å—       | let/const     |
| æ¨¡å—ä½œç”¨åŸŸ | ES6 æ¨¡å—æ–‡ä»¶    | let/const     |

| å£°æ˜æ–¹å¼ | ä½œç”¨åŸŸ | æå‡ | TDZ | é‡å¤å£°æ˜ |
| -------- | ------ | ---- | --- | -------- |
| var      | å‡½æ•°   | æ˜¯   | æ—   | å…è®¸     |
| let      | å—     | å¦   | æœ‰  | ä¸å…è®¸   |
| const    | å—     | å¦   | æœ‰  | ä¸å…è®¸   |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- JavaScript ä½¿ç”¨è¯æ³•ä½œç”¨åŸŸï¼Œåœ¨ä»£ç ç¼–å†™æ—¶ç¡®å®š
- ä¼˜å…ˆä½¿ç”¨ `const`ï¼Œéœ€è¦ä¿®æ”¹æ—¶ç”¨ `let`ï¼Œé¿å…ä½¿ç”¨ `var`
- åˆ©ç”¨å—çº§ä½œç”¨åŸŸéš”ç¦»å˜é‡
- ç†è§£ä½œç”¨åŸŸé“¾è¿›è¡Œå˜é‡æŸ¥æ‰¾
