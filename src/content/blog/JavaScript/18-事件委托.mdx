---
title: 'äº‹ä»¶å§”æ‰˜'
description: 'æŒæ¡äº‹ä»¶å§”æ‰˜æ¨¡å¼ï¼Œåˆ©ç”¨äº‹ä»¶å†’æ³¡å®ç°é«˜æ•ˆçš„äº‹ä»¶å¤„ç†'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'äº‹ä»¶å§”æ‰˜', 'äº‹ä»¶å†’æ³¡', 'æ€§èƒ½ä¼˜åŒ–']
---

äº‹ä»¶å§”æ‰˜æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œå°†å­å…ƒç´ çš„äº‹ä»¶å¤„ç†å§”æ‰˜ç»™çˆ¶å…ƒç´ çš„æŠ€æœ¯ã€‚å®ƒèƒ½æ˜¾è‘—æå‡æ€§èƒ½å’Œç®€åŒ–ä»£ç ã€‚

## ğŸ¯ ä»€ä¹ˆæ˜¯äº‹ä»¶å§”æ‰˜

### é—®é¢˜åœºæ™¯

```javascript
// <ul id="list">
//   <li>é¡¹ç›® 1</li>
//   <li>é¡¹ç›® 2</li>
//   <li>é¡¹ç›® 3</li>
//   ... å¯èƒ½æœ‰å¾ˆå¤šé¡¹
// </ul>

// ğŸ”¶ ä¼ ç»Ÿæ–¹å¼ï¼šä¸ºæ¯ä¸ªå…ƒç´ ç»‘å®šäº‹ä»¶
const items = document.querySelectorAll('#list li')
items.forEach((item) => {
  item.addEventListener('click', function () {
    console.log(this.textContent)
  })
})

// é—®é¢˜ï¼š
// 1. éœ€è¦ä¸ºæ¯ä¸ªå…ƒç´ ç»‘å®šäº‹ä»¶ï¼Œæ¶ˆè€—å†…å­˜
// 2. æ–°å¢å…ƒç´ éœ€è¦æ‰‹åŠ¨ç»‘å®šäº‹ä»¶
// 3. å…ƒç´ æ•°é‡å¤šæ—¶æ€§èƒ½å·®
```

### äº‹ä»¶å§”æ‰˜è§£å†³æ–¹æ¡ˆ

```javascript
// âœ… äº‹ä»¶å§”æ‰˜ï¼šåªåœ¨çˆ¶å…ƒç´ ä¸Šç»‘å®šä¸€ä¸ªäº‹ä»¶
const list = document.getElementById('list')

list.addEventListener('click', function (event) {
  // é€šè¿‡ event.target åˆ¤æ–­å®é™…ç‚¹å‡»çš„å…ƒç´ 
  if (event.target.tagName === 'LI') {
    console.log(event.target.textContent)
  }
})

// ä¼˜ç‚¹ï¼š
// 1. åªéœ€è¦ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨
// 2. æ–°å¢å…ƒç´ è‡ªåŠ¨æ‹¥æœ‰äº‹ä»¶å¤„ç†
// 3. å†…å­˜å ç”¨å°‘ï¼Œæ€§èƒ½å¥½
```

## äº‹ä»¶å§”æ‰˜çš„åŸç†

### äº‹ä»¶å†’æ³¡

```javascript
// <div class="container">
//   <ul class="list">
//     <li class="item">ç‚¹å‡»æˆ‘</li>
//   </ul>
// </div>

// ç‚¹å‡» li æ—¶ï¼Œäº‹ä»¶ä¼šå†’æ³¡ï¼š
// li -> ul -> div -> body -> html -> document

const container = document.querySelector('.container')

container.addEventListener('click', function (event) {
  console.log('ç›®æ ‡å…ƒç´ :', event.target) // liï¼ˆå®é™…ç‚¹å‡»çš„ï¼‰
  console.log('å½“å‰å…ƒç´ :', event.currentTarget) // containerï¼ˆç»‘å®šäº‹ä»¶çš„ï¼‰
})
```

### target vs currentTarget

```javascript
const list = document.getElementById('list')

list.addEventListener('click', function (event) {
  // event.target - è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼ˆå¯èƒ½æ˜¯å­å…ƒç´ ï¼‰
  // event.currentTarget - ç»‘å®šäº‹ä»¶å¤„ç†å™¨çš„å…ƒç´ 
  // this - ç­‰äº event.currentTargetï¼ˆéç®­å¤´å‡½æ•°ï¼‰

  console.log('target:', event.target.tagName)
  console.log('currentTarget:', event.currentTarget.tagName)
})

// ç‚¹å‡» li æ—¶ï¼š
// target: LI
// currentTarget: UL
```

## å®ç°äº‹ä»¶å§”æ‰˜

### åŸºç¡€å®ç°

```javascript
const list = document.getElementById('list')

list.addEventListener('click', function (event) {
  const target = event.target

  // åˆ¤æ–­æ˜¯å¦æ˜¯ç›®æ ‡å…ƒç´ 
  if (target.classList.contains('item')) {
    handleItemClick(target)
  }
})

function handleItemClick(item) {
  console.log('ç‚¹å‡»äº†:', item.textContent)
}
```

### ä½¿ç”¨ matches æ–¹æ³•

```javascript
const container = document.getElementById('container')

container.addEventListener('click', function (event) {
  // ä½¿ç”¨ CSS é€‰æ‹©å™¨åŒ¹é…
  if (event.target.matches('.item')) {
    console.log('ç‚¹å‡»äº† item')
  }

  if (event.target.matches('.btn-delete')) {
    console.log('ç‚¹å‡»äº†åˆ é™¤æŒ‰é’®')
  }

  if (event.target.matches('a[href^="http"]')) {
    console.log('ç‚¹å‡»äº†å¤–éƒ¨é“¾æ¥')
  }
})
```

### ä½¿ç”¨ closest æ–¹æ³•

å½“ç›®æ ‡å…ƒç´ æœ‰åµŒå¥—å­å…ƒç´ æ—¶ï¼Œ`closest` å¾ˆæœ‰ç”¨ï¼š

```javascript
// <ul id="list">
//   <li class="item">
//     <span class="icon">ğŸ“Œ</span>
//     <span class="text">é¡¹ç›®å†…å®¹</span>
//   </li>
// </ul>

const list = document.getElementById('list')

list.addEventListener('click', function (event) {
  // ç‚¹å‡» span æ—¶ï¼Œæ‰¾åˆ°æœ€è¿‘çš„ li
  const item = event.target.closest('.item')

  if (item) {
    console.log('ç‚¹å‡»äº†åˆ—è¡¨é¡¹')
    item.classList.toggle('selected')
  }
})
```

### é€šç”¨å§”æ‰˜å‡½æ•°

```javascript
function delegate(parent, selector, eventType, handler) {
  parent.addEventListener(eventType, function (event) {
    const target = event.target.closest(selector)

    if (target && parent.contains(target)) {
      handler.call(target, event)
    }
  })
}

// ä½¿ç”¨
const list = document.getElementById('list')

delegate(list, '.item', 'click', function (event) {
  console.log('ç‚¹å‡»äº†:', this.textContent)
})

delegate(list, '.delete-btn', 'click', function (event) {
  event.stopPropagation()
  this.closest('.item').remove()
})
```

## å®é™…åº”ç”¨åœºæ™¯

### åŠ¨æ€åˆ—è¡¨

```javascript
// <ul id="todo-list"></ul>
// <button id="add-btn">æ·»åŠ </button>

const todoList = document.getElementById('todo-list')
const addBtn = document.getElementById('add-btn')
let counter = 0

// æ·»åŠ é¡¹ç›®
addBtn.addEventListener('click', function () {
  const li = document.createElement('li')
  li.className = 'todo-item'
  li.innerHTML = `
    <span class="text">ä»»åŠ¡ ${++counter}</span>
    <button class="complete-btn">å®Œæˆ</button>
    <button class="delete-btn">åˆ é™¤</button>
  `
  todoList.appendChild(li)
})

// äº‹ä»¶å§”æ‰˜å¤„ç†æ‰€æœ‰æ“ä½œ
todoList.addEventListener('click', function (event) {
  const target = event.target
  const item = target.closest('.todo-item')

  if (!item) return

  if (target.matches('.complete-btn')) {
    item.classList.toggle('completed')
  }

  if (target.matches('.delete-btn')) {
    item.remove()
  }
})
```

### è¡¨æ ¼æ“ä½œ

```javascript
// <table id="data-table">
//   <tr data-id="1"><td>æ•°æ®1</td><td><button class="edit">ç¼–è¾‘</button></td></tr>
//   <tr data-id="2"><td>æ•°æ®2</td><td><button class="edit">ç¼–è¾‘</button></td></tr>
// </table>

const table = document.getElementById('data-table')

table.addEventListener('click', function (event) {
  const row = event.target.closest('tr')
  if (!row) return

  const id = row.dataset.id

  if (event.target.matches('.edit')) {
    editRow(id)
  }

  if (event.target.matches('.delete')) {
    deleteRow(id, row)
  }
})

function editRow(id) {
  console.log('ç¼–è¾‘è¡Œ:', id)
}

function deleteRow(id, row) {
  if (confirm('ç¡®å®šåˆ é™¤ï¼Ÿ')) {
    row.remove()
  }
}
```

### é€‰é¡¹å¡åˆ‡æ¢

```javascript
// <div class="tabs">
//   <button class="tab" data-tab="tab1">é€‰é¡¹å¡1</button>
//   <button class="tab" data-tab="tab2">é€‰é¡¹å¡2</button>
//   <button class="tab" data-tab="tab3">é€‰é¡¹å¡3</button>
// </div>
// <div class="tab-content" id="tab1">å†…å®¹1</div>
// <div class="tab-content" id="tab2">å†…å®¹2</div>
// <div class="tab-content" id="tab3">å†…å®¹3</div>

const tabs = document.querySelector('.tabs')

tabs.addEventListener('click', function (event) {
  if (!event.target.matches('.tab')) return

  const tabId = event.target.dataset.tab

  // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
  document.querySelectorAll('.tab').forEach((t) => t.classList.remove('active'))
  document
    .querySelectorAll('.tab-content')
    .forEach((c) => c.classList.remove('active'))

  // è®¾ç½®å½“å‰æ´»åŠ¨çŠ¶æ€
  event.target.classList.add('active')
  document.getElementById(tabId).classList.add('active')
})
```

### è¡¨å•éªŒè¯

```javascript
const form = document.getElementById('myForm')

// å§”æ‰˜å¤„ç†æ‰€æœ‰è¾“å…¥æ¡†çš„éªŒè¯
form.addEventListener(
  'blur',
  function (event) {
    if (!event.target.matches('input, textarea, select')) return

    validateField(event.target)
  },
  true
) // ä½¿ç”¨æ•è·é˜¶æ®µï¼Œå› ä¸º blur ä¸å†’æ³¡

form.addEventListener('input', function (event) {
  if (!event.target.matches('input, textarea')) return

  // å®æ—¶éªŒè¯
  clearError(event.target)
})

function validateField(field) {
  const value = field.value.trim()
  const rules = field.dataset.rules

  if (rules?.includes('required') && !value) {
    showError(field, 'æ­¤å­—æ®µå¿…å¡«')
    return false
  }

  if (rules?.includes('email') && !isValidEmail(value)) {
    showError(field, 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±')
    return false
  }

  return true
}
```

## æ³¨æ„äº‹é¡¹

### ä¸å†’æ³¡çš„äº‹ä»¶

```javascript
// è¿™äº›äº‹ä»¶ä¸å†’æ³¡ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼š
// - focus / blur
// - mouseenter / mouseleave
// - load / unload / scrollï¼ˆéƒ¨åˆ†æƒ…å†µï¼‰

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨æ•è·é˜¶æ®µ
parent.addEventListener(
  'focus',
  function (event) {
    if (event.target.matches('input')) {
      console.log('è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹')
    }
  },
  true
) // æ•è·é˜¶æ®µ

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨å†’æ³¡çš„æ›¿ä»£äº‹ä»¶
// focus -> focusinï¼ˆå†’æ³¡ï¼‰
// blur -> focusoutï¼ˆå†’æ³¡ï¼‰
parent.addEventListener('focusin', function (event) {
  if (event.target.matches('input')) {
    console.log('è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹')
  }
})
```

### stopPropagation çš„å½±å“

```javascript
// å­å…ƒç´ é˜»æ­¢å†’æ³¡ä¼šå½±å“äº‹ä»¶å§”æ‰˜
const list = document.getElementById('list')
const item = document.querySelector('.item')

// å§”æ‰˜
list.addEventListener('click', function () {
  console.log('å§”æ‰˜å¤„ç†')
})

// å­å…ƒç´ é˜»æ­¢å†’æ³¡
item.addEventListener('click', function (event) {
  event.stopPropagation()
  console.log('ç›´æ¥å¤„ç†')
})

// ç‚¹å‡» item æ—¶ï¼Œåªè¾“å‡º"ç›´æ¥å¤„ç†"
// å§”æ‰˜ä¸ä¼šè§¦å‘
```

### æ€§èƒ½è€ƒè™‘

```javascript
// ğŸ”¶ é¿å…è¿‡äºå®½æ³›çš„å§”æ‰˜
document.addEventListener('click', function (event) {
  // æ¯æ¬¡ç‚¹å‡»éƒ½è¦åˆ¤æ–­ï¼Œæ€§èƒ½å·®
  if (event.target.matches('.some-class')) {
    // ...
  }
})

// âœ… å§”æ‰˜åˆ°åˆé€‚çš„çˆ¶å…ƒç´ 
const container = document.getElementById('container')
container.addEventListener('click', function (event) {
  // åªåœ¨å®¹å™¨å†…ç”Ÿæ•ˆ
  if (event.target.matches('.some-class')) {
    // ...
  }
})
```

## å°è£…äº‹ä»¶å§”æ‰˜

```javascript
class EventDelegate {
  constructor(root) {
    this.root = typeof root === 'string' ? document.querySelector(root) : root
    this.handlers = new Map()
  }

  on(eventType, selector, handler) {
    if (!this.handlers.has(eventType)) {
      this.handlers.set(eventType, [])

      this.root.addEventListener(eventType, (event) => {
        const handlers = this.handlers.get(eventType)
        handlers.forEach(({ selector, handler }) => {
          const target = event.target.closest(selector)
          if (target && this.root.contains(target)) {
            handler.call(target, event)
          }
        })
      })
    }

    this.handlers.get(eventType).push({ selector, handler })
    return this
  }

  off(eventType, selector, handler) {
    if (!this.handlers.has(eventType)) return this

    const handlers = this.handlers.get(eventType)
    const index = handlers.findIndex(
      (h) => h.selector === selector && h.handler === handler
    )
    if (index > -1) {
      handlers.splice(index, 1)
    }
    return this
  }
}

// ä½¿ç”¨
const delegate = new EventDelegate('#app')

delegate
  .on('click', '.btn-save', function () {
    console.log('ä¿å­˜')
  })
  .on('click', '.btn-cancel', function () {
    console.log('å–æ¶ˆ')
  })
  .on('input', 'input', function () {
    console.log('è¾“å…¥:', this.value)
  })
```

## æ€»ç»“

| æ–¹å¼     | äº‹ä»¶ç›‘å¬å™¨æ•°é‡ | åŠ¨æ€å…ƒç´ æ”¯æŒ | å†…å­˜å ç”¨ |
| -------- | -------------- | ------------ | -------- |
| ç›´æ¥ç»‘å®š | N ä¸ª           | éœ€æ‰‹åŠ¨ç»‘å®š   | é«˜       |
| äº‹ä»¶å§”æ‰˜ | 1 ä¸ª           | è‡ªåŠ¨æ”¯æŒ     | ä½       |

| æ–¹æ³•    | ä½œç”¨                   |
| ------- | ---------------------- |
| target  | è·å–å®é™…è§¦å‘äº‹ä»¶çš„å…ƒç´  |
| matches | åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ¹é…é€‰æ‹©å™¨ |
| closest | å‘ä¸ŠæŸ¥æ‰¾åŒ¹é…çš„ç¥–å…ˆå…ƒç´  |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- äº‹ä»¶å§”æ‰˜åˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶
- ä½¿ç”¨ `event.target` è·å–å®é™…è§¦å‘å…ƒç´ 
- ä½¿ç”¨ `closest` å¤„ç†åµŒå¥—å…ƒç´ 
- å§”æ‰˜åˆ°åˆé€‚çš„çˆ¶å…ƒç´ ï¼Œä¸è¦å§”æ‰˜åˆ° document
- æ³¨æ„ä¸å†’æ³¡çš„äº‹ä»¶éœ€è¦ç‰¹æ®Šå¤„ç†
