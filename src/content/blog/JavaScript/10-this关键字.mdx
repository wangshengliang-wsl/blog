---
title: 'this å…³é”®å­—'
description: 'å½»åº•ç†è§£ JavaScript ä¸­ this çš„ç»‘å®šè§„åˆ™ï¼ŒæŽŒæ¡ callã€applyã€bind çš„ä½¿ç”¨'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'JavaScript'
tags: ['JavaScript', 'this', 'call', 'apply', 'bind']
---

`this` æ˜¯ JavaScript ä¸­æœ€å®¹æ˜“æ··æ·†çš„æ¦‚å¿µä¹‹ä¸€ã€‚å®ƒçš„å€¼å–å†³äºŽå‡½æ•°çš„è°ƒç”¨æ–¹å¼ï¼Œè€Œä¸æ˜¯å®šä¹‰ä½ç½®ã€‚

## ðŸŽ¯ this æ˜¯ä»€ä¹ˆ

`this` æ˜¯å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå®ƒçš„å€¼åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ç¡®å®šã€‚

```javascript
function greet() {
  console.log(this)
}

// ä¸åŒè°ƒç”¨æ–¹å¼ï¼Œthis ä¸åŒ
greet() // windowï¼ˆéžä¸¥æ ¼æ¨¡å¼ï¼‰æˆ– undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰

const obj = { greet }
obj.greet() // obj

const boundGreet = greet.bind({ name: 'å¼ ä¸‰' })
boundGreet() // { name: "å¼ ä¸‰" }
```

## å››ç§ç»‘å®šè§„åˆ™

### 1. é»˜è®¤ç»‘å®š

ç‹¬ç«‹å‡½æ•°è°ƒç”¨æ—¶ï¼Œ`this` æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆéžä¸¥æ ¼æ¨¡å¼ï¼‰æˆ– `undefined`ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ã€‚

```javascript
function foo() {
  console.log(this)
}

// éžä¸¥æ ¼æ¨¡å¼
foo() // windowï¼ˆæµè§ˆå™¨ï¼‰/ globalï¼ˆNode.jsï¼‰

// ä¸¥æ ¼æ¨¡å¼
;('use strict')
function bar() {
  console.log(this)
}
bar() // undefined
```

### 2. éšå¼ç»‘å®š

é€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶ï¼Œ`this` æŒ‡å‘è¯¥å¯¹è±¡ã€‚

```javascript
const person = {
  name: 'å¼ ä¸‰',
  greet() {
    console.log(`ä½ å¥½ï¼Œæˆ‘æ˜¯${this.name}`)
  },
}

person.greet() // "ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰"

// é“¾å¼è°ƒç”¨
const company = {
  name: 'å…¬å¸',
  department: {
    name: 'æŠ€æœ¯éƒ¨',
    getName() {
      return this.name
    },
  },
}
console.log(company.department.getName()) // "æŠ€æœ¯éƒ¨"ï¼ˆæœ€è¿‘çš„å¯¹è±¡ï¼‰
```

ðŸ”¶ **éšå¼ä¸¢å¤±**ï¼š

```javascript
const person = {
  name: 'å¼ ä¸‰',
  greet() {
    console.log(this.name)
  },
}

// èµ‹å€¼ç»™å˜é‡åŽè°ƒç”¨
const greet = person.greet
greet() // undefinedï¼ˆthis ä¸¢å¤±ï¼‰

// ä½œä¸ºå›žè°ƒä¼ é€’
setTimeout(person.greet, 100) // undefined

// è§£å†³æ–¹æ¡ˆ
setTimeout(() => person.greet(), 100) // "å¼ ä¸‰"
setTimeout(person.greet.bind(person), 100) // "å¼ ä¸‰"
```

### 3. æ˜¾å¼ç»‘å®š

ä½¿ç”¨ `call`ã€`apply`ã€`bind` æ˜Žç¡®æŒ‡å®š `this`ã€‚

```javascript
function greet(greeting, punctuation) {
  console.log(`${greeting}ï¼Œ${this.name}${punctuation}`)
}

const person = { name: 'å¼ ä¸‰' }

// callï¼šå‚æ•°é€ä¸ªä¼ é€’
greet.call(person, 'ä½ å¥½', 'ï¼') // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"

// applyï¼šå‚æ•°ä½œä¸ºæ•°ç»„
greet.apply(person, ['ä½ å¥½', 'ï¼']) // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"

// bindï¼šè¿”å›žç»‘å®š this çš„æ–°å‡½æ•°
const boundGreet = greet.bind(person)
boundGreet('ä½ å¥½', 'ï¼') // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"

// bind è¿˜å¯ä»¥é¢„è®¾å‚æ•°ï¼ˆæŸ¯é‡ŒåŒ–ï¼‰
const greetHello = greet.bind(person, 'ä½ å¥½')
greetHello('ï¼') // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"
```

### 4. new ç»‘å®š

ä½¿ç”¨ `new` è°ƒç”¨æž„é€ å‡½æ•°æ—¶ï¼Œ`this` æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚

```javascript
function Person(name) {
  this.name = name
  console.log(this)
}

const p = new Person('å¼ ä¸‰') // Person { name: "å¼ ä¸‰" }
console.log(p.name) // "å¼ ä¸‰"

// å¦‚æžœæž„é€ å‡½æ•°è¿”å›žå¯¹è±¡ï¼Œåˆ™è¿”å›žè¯¥å¯¹è±¡
function Foo() {
  this.a = 1
  return { b: 2 }
}
const foo = new Foo()
console.log(foo.a) // undefined
console.log(foo.b) // 2
```

## ä¼˜å…ˆçº§

å½“å¤šç§è§„åˆ™åŒæ—¶é€‚ç”¨æ—¶ï¼ŒæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§åˆ¤æ–­ï¼š

```
new ç»‘å®š > æ˜¾å¼ç»‘å®š > éšå¼ç»‘å®š > é»˜è®¤ç»‘å®š
```

```javascript
function foo() {
  console.log(this.a)
}

const obj1 = { a: 1, foo }
const obj2 = { a: 2, foo }

// éšå¼ vs æ˜¾å¼
obj1.foo.call(obj2) // 2ï¼ˆæ˜¾å¼ä¼˜å…ˆï¼‰

// éšå¼ vs new
function Bar(a) {
  this.a = a
}
const obj3 = { a: 3, Bar }
const bar = new obj3.Bar(4)
console.log(bar.a) // 4ï¼ˆnew ä¼˜å…ˆï¼‰

// æ˜¾å¼ vs new
const boundBar = Bar.bind({ a: 5 })
const baz = new boundBar(6)
console.log(baz.a) // 6ï¼ˆnew ä¼˜å…ˆï¼Œå¿½ç•¥ bindï¼‰
```

## ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`ï¼Œå®ƒç»§æ‰¿å®šä¹‰æ—¶å¤–å±‚ä½œç”¨åŸŸçš„ `this`ã€‚

```javascript
const person = {
  name: 'å¼ ä¸‰',

  // æ™®é€šå‡½æ•°
  greet() {
    console.log(this.name)
  },

  // ç®­å¤´å‡½æ•°
  greetArrow: () => {
    console.log(this.name) // this ä¸æ˜¯ person
  },

  // åµŒå¥—åœºæ™¯
  delayGreet() {
    // æ™®é€šå‡½æ•°ï¼šthis ä¸¢å¤±
    setTimeout(function () {
      console.log(this.name) // undefined
    }, 100)

    // ç®­å¤´å‡½æ•°ï¼šç»§æ‰¿å¤–å±‚ this
    setTimeout(() => {
      console.log(this.name) // "å¼ ä¸‰"
    }, 100)
  },
}

person.greet() // "å¼ ä¸‰"
person.greetArrow() // undefined
person.delayGreet()
```

### ç®­å¤´å‡½æ•°çš„ç‰¹æ®Šæ€§

```javascript
const arrow = () => {
  console.log(this)
}

const obj = { arrow }

// ä»¥ä¸‹éƒ½æ— æ³•æ”¹å˜ç®­å¤´å‡½æ•°çš„ this
obj.arrow() // windowï¼ˆå®šä¹‰æ—¶çš„å¤–å±‚ thisï¼‰
arrow.call({ a: 1 }) // window
arrow.apply({ a: 1 }) // window
arrow.bind({ a: 1 })() // window

// ä¸èƒ½ç”¨ new
// new arrow()  // TypeError
```

### å®žé™…åº”ç”¨

```javascript
// âœ… é€‚åˆï¼šå›žè°ƒå‡½æ•°
class Counter {
  constructor() {
    this.count = 0
  }

  increment() {
    setInterval(() => {
      this.count++ // this æ­£ç¡®æŒ‡å‘å®žä¾‹
      console.log(this.count)
    }, 1000)
  }
}

// âœ… é€‚åˆï¼šæ•°ç»„æ–¹æ³•
const numbers = [1, 2, 3]
const doubled = numbers.map((n) => n * 2)

// âŒ ä¸é€‚åˆï¼šå¯¹è±¡æ–¹æ³•
const obj = {
  name: 'å¼ ä¸‰',
  greet: () => {
    console.log(this.name) // ä¸æ˜¯ obj
  },
}

// âŒ ä¸é€‚åˆï¼šäº‹ä»¶å¤„ç†å™¨ï¼ˆéœ€è¦è®¿é—®äº‹ä»¶ç›®æ ‡ï¼‰
button.addEventListener('click', () => {
  console.log(this) // ä¸æ˜¯ button
})

// âœ… æ”¹ç”¨æ™®é€šå‡½æ•°
button.addEventListener('click', function () {
  console.log(this) // button
})
```

## callã€applyã€bind è¯¦è§£

### call

```javascript
function greet(greeting, punctuation) {
  return `${greeting}ï¼Œ${this.name}${punctuation}`
}

const person = { name: 'å¼ ä¸‰' }
console.log(greet.call(person, 'ä½ å¥½', 'ï¼')) // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"

// å€Ÿç”¨æ–¹æ³•
const arrayLike = { 0: 'a', 1: 'b', length: 2 }
const arr = Array.prototype.slice.call(arrayLike)
console.log(arr) // ["a", "b"]

// è°ƒç”¨çˆ¶ç±»æž„é€ å‡½æ•°
function Animal(name) {
  this.name = name
}
function Dog(name, breed) {
  Animal.call(this, name)
  this.breed = breed
}
```

### apply

```javascript
// ä¸Ž call ç±»ä¼¼ï¼Œä½†å‚æ•°æ˜¯æ•°ç»„
function greet(greeting, punctuation) {
  return `${greeting}ï¼Œ${this.name}${punctuation}`
}

const person = { name: 'å¼ ä¸‰' }
console.log(greet.apply(person, ['ä½ å¥½', 'ï¼'])) // "ä½ å¥½ï¼Œå¼ ä¸‰ï¼"

// ç»å…¸ç”¨æ³•ï¼šæ±‚æ•°ç»„æœ€å¤§å€¼
const numbers = [1, 5, 3, 9, 2]
console.log(Math.max.apply(null, numbers)) // 9
// ES6 æ›´ç®€æ´
console.log(Math.max(...numbers)) // 9

// åˆå¹¶æ•°ç»„
const arr1 = [1, 2]
const arr2 = [3, 4]
Array.prototype.push.apply(arr1, arr2)
console.log(arr1) // [1, 2, 3, 4]
// ES6 æ›´ç®€æ´
arr1.push(...arr2)
```

### bind

```javascript
function greet(greeting) {
  return `${greeting}ï¼Œ${this.name}`
}

const person = { name: 'å¼ ä¸‰' }

// åˆ›å»ºç»‘å®šå‡½æ•°
const boundGreet = greet.bind(person)
console.log(boundGreet('ä½ å¥½')) // "ä½ å¥½ï¼Œå¼ ä¸‰"

// ç»‘å®šæ— æ³•è¢«è¦†ç›–
const anotherPerson = { name: 'æŽå››' }
console.log(boundGreet.call(anotherPerson, 'å—¨')) // "å—¨ï¼Œå¼ ä¸‰"ï¼ˆä»æ˜¯å¼ ä¸‰ï¼‰

// éƒ¨åˆ†åº”ç”¨ï¼ˆæŸ¯é‡ŒåŒ–ï¼‰
function add(a, b, c) {
  return a + b + c
}
const add5 = add.bind(null, 5)
console.log(add5(3, 2)) // 10

const add5and3 = add.bind(null, 5, 3)
console.log(add5and3(2)) // 10
```

### æ‰‹å†™å®žçŽ°

```javascript
// å®žçŽ° call
Function.prototype.myCall = function (context, ...args) {
  context = context ?? globalThis
  context = Object(context) // å¤„ç†åŽŸå§‹å€¼
  const fn = Symbol()
  context[fn] = this
  const result = context[fn](...args)
  delete context[fn]
  return result
}

// å®žçŽ° apply
Function.prototype.myApply = function (context, args = []) {
  context = context ?? globalThis
  context = Object(context)
  const fn = Symbol()
  context[fn] = this
  const result = context[fn](...args)
  delete context[fn]
  return result
}

// å®žçŽ° bind
Function.prototype.myBind = function (context, ...args) {
  const fn = this
  return function (...newArgs) {
    return fn.apply(this instanceof fn ? this : context, [...args, ...newArgs])
  }
}
```

## ç±»ä¸­çš„ this

```javascript
class Person {
  constructor(name) {
    this.name = name
  }

  greet() {
    console.log(`ä½ å¥½ï¼Œæˆ‘æ˜¯${this.name}`)
  }

  // ç®­å¤´å‡½æ•°ä½œä¸ºç±»å­—æ®µ
  greetArrow = () => {
    console.log(`ä½ å¥½ï¼Œæˆ‘æ˜¯${this.name}`)
  }
}

const p = new Person('å¼ ä¸‰')

// æ™®é€šæ–¹æ³•éœ€è¦æ³¨æ„ this
const greet = p.greet
greet() // TypeError æˆ– undefined

// ç®­å¤´å‡½æ•°å­—æ®µè‡ªåŠ¨ç»‘å®š
const greetArrow = p.greetArrow
greetArrow() // "ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰"

// æ‰‹åŠ¨ç»‘å®š
class Button {
  constructor(text) {
    this.text = text
    this.click = this.click.bind(this)
  }

  click() {
    console.log(this.text)
  }
}
```

## å¸¸è§åœºæ™¯

### äº‹ä»¶å¤„ç†

```javascript
class App {
  constructor() {
    this.name = 'MyApp'
    this.button = document.querySelector('button')

    // æ–¹å¼1ï¼šbind
    this.button.addEventListener('click', this.handleClick.bind(this))

    // æ–¹å¼2ï¼šç®­å¤´å‡½æ•°
    this.button.addEventListener('click', (e) => this.handleClick(e))

    // æ–¹å¼3ï¼šç±»å­—æ®µç®­ï¿½ï¿½ï¿½å‡½æ•°
    // handleClick = (e) => { ... }
  }

  handleClick(e) {
    console.log(this.name)
  }
}
```

### å›žè°ƒå‡½æ•°

```javascript
const obj = {
  data: [1, 2, 3],

  double() {
    // é”™è¯¯ï¼šthis ä¸¢å¤±
    // return this.data.map(function(n) {
    //   return n * this.multiplier  // this ä¸æ˜¯ obj
    // })

    // æ–¹å¼1ï¼šç®­å¤´å‡½æ•°
    return this.data.map((n) => n * 2)

    // æ–¹å¼2ï¼šbind
    // return this.data.map(function(n) {
    //   return n * 2
    // }.bind(this))

    // æ–¹å¼3ï¼šä¿å­˜ this
    // const self = this
    // return this.data.map(function(n) {
    //   return n * self.multiplier
    // })
  },
}
```

### å®šæ—¶å™¨

```javascript
const timer = {
  seconds: 0,

  // é”™è¯¯ç¤ºä¾‹
  startBad() {
    setInterval(function () {
      this.seconds++ // this ä¸æ˜¯ timer
      console.log(this.seconds)
    }, 1000)
  },

  // æ­£ç¡®ç¤ºä¾‹
  start() {
    setInterval(() => {
      this.seconds++
      console.log(this.seconds)
    }, 1000)
  },
}
```

## å¸¸è§é¢è¯•é¢˜

### ðŸ™‹ è¾“å‡ºä»€ä¹ˆï¼Ÿ

```javascript
const obj = {
  name: 'å¼ ä¸‰',
  greet() {
    return function () {
      return this.name
    }
  },
  greetArrow() {
    return () => {
      return this.name
    }
  },
}

console.log(obj.greet()()) // undefined
console.log(obj.greetArrow()()) // "å¼ ä¸‰"
```

### ðŸ™‹ å¦‚ä½•è®© a.x.fn() è¾“å‡º aï¼Ÿ

```javascript
const a = {
  name: 'a',
  x: {
    fn() {
      console.log(this)
    },
  },
}

// ä½¿ç”¨ bind
a.x.fn = a.x.fn.bind(a)
a.x.fn() // a

// æˆ–ä½¿ç”¨ call
a.x.fn.call(a) // a
```

### ðŸ™‹ ç®­å¤´å‡½æ•°å¯ä»¥ç”¨ new å—ï¼Ÿ

```javascript
const Arrow = () => {}
// new Arrow()  // TypeError: Arrow is not a constructor

// åŽŸå› ï¼šç®­å¤´å‡½æ•°æ²¡æœ‰ [[Construct]] å†…éƒ¨æ–¹æ³•
```

## æ€»ç»“

| è°ƒç”¨æ–¹å¼ | this æŒ‡å‘            | ç¤ºä¾‹           |
| -------- | -------------------- | -------------- |
| é»˜è®¤ç»‘å®š | å…¨å±€å¯¹è±¡ / undefined | `fn()`         |
| éšå¼ç»‘å®š | è°ƒç”¨å¯¹è±¡             | `obj.fn()`     |
| æ˜¾å¼ç»‘å®š | æŒ‡å®šå¯¹è±¡             | `fn.call(obj)` |
| new ç»‘å®š | æ–°åˆ›å»ºçš„å¯¹è±¡         | `new Fn()`     |
| ç®­å¤´å‡½æ•° | ç»§æ‰¿å¤–å±‚ this        | `() => {}`     |

**æ ¸å¿ƒè¦ç‚¹**ï¼š

- `this` å–å†³äºŽè°ƒç”¨æ–¹å¼ï¼Œä¸æ˜¯å®šä¹‰ä½ç½®
- ä¼˜å…ˆçº§ï¼šnew > æ˜¾å¼ > éšå¼ > é»˜è®¤
- ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`ï¼Œç»§æ‰¿å¤–å±‚
- ç”¨ `bind` è§£å†³å›žè°ƒä¸­çš„ `this` ä¸¢å¤±
