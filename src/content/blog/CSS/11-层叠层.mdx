---
title: å±‚å å±‚
description: ç†è§£ CSS @layer è§„åˆ™ï¼ŒæŒæ¡æ ·å¼ä¼˜å…ˆçº§çš„ç»„ç»‡å’Œç®¡ç†æ–¹æ³•
pubDate: 2025-12-03
toc: true
ogImage: true
category: CSS
---

CSS å±‚å å±‚ï¼ˆCascade Layersï¼‰æ˜¯ç®¡ç†æ ·å¼ä¼˜å…ˆçº§çš„æ–°æ–¹æ³•ã€‚é€šè¿‡ `@layer` è§„åˆ™ï¼Œä½ å¯ä»¥æ˜ç¡®å®šä¹‰æ ·å¼çš„å±‚çº§é¡ºåºï¼Œè®©æ ·å¼è¦†ç›–å…³ç³»æ›´åŠ å¯æ§ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦å±‚å å±‚

ä¼ ç»Ÿ CSS çš„ä¼˜å…ˆçº§é—®é¢˜ï¼š

```css
/* ç¬¬ä¸‰æ–¹ç»„ä»¶åº“ */
.button {
  background: gray;
}

/* ä½ çš„è‡ªå®šä¹‰æ ·å¼ - éœ€è¦æ›´é«˜çš„é€‰æ‹©å™¨æƒé‡æ‰èƒ½è¦†ç›– */
.my-app .button {
  background: blue;
}

/* æˆ–è€…ä½¿ç”¨ !importantï¼ˆä¸æ¨èï¼‰ */
.button {
  background: blue !important;
}
```

ä½¿ç”¨å±‚å å±‚ï¼Œä½ å¯ä»¥æ§åˆ¶æ•´ä¸ªå±‚çš„ä¼˜å…ˆçº§ï¼Œè€Œä¸æ˜¯é€ä¸ªé€‰æ‹©å™¨è¾ƒé‡ï¼š

```css
@layer base, components, utilities;

@layer components {
  .button {
    background: gray;
  }
}

@layer utilities {
  .button {
    background: blue; /* ä¼˜å…ˆçº§æ›´é«˜ï¼Œå› ä¸º utilities å±‚åå£°æ˜ */
  }
}
```

## åŸºæœ¬è¯­æ³•

### å®šä¹‰å±‚

```css
/* æ–¹å¼ 1ï¼šå£°æ˜å±‚é¡ºåº */
@layer reset, base, components, utilities;

/* æ–¹å¼ 2ï¼šå£°æ˜åŒæ—¶æ·»åŠ æ ·å¼ */
@layer reset {
  * {
    margin: 0;
    padding: 0;
  }
}

/* æ–¹å¼ 3ï¼šåŒ¿åå±‚ */
@layer {
  .anonymous {
    color: red;
  }
}
```

### å±‚çš„é¡ºåº

å±‚æŒ‰å£°æ˜é¡ºåºæ’åˆ—ï¼Œ**åå£°æ˜çš„å±‚ä¼˜å…ˆçº§æ›´é«˜**ï¼š

```css
@layer first, second, third;

@layer first {
  p {
    color: red;
  }
}

@layer third {
  p {
    color: blue;
  } /* èƒœå‡ºï¼ */
}

@layer second {
  p {
    color: green;
  }
}
```

### å‘å·²æœ‰å±‚æ·»åŠ æ ·å¼

```css
@layer base {
  a {
    color: blue;
  }
}

/* åç»­å¯ä»¥ç»§ç»­å‘ base å±‚æ·»åŠ  */
@layer base {
  a:hover {
    text-decoration: underline;
  }
}
```

## åµŒå¥—å±‚

å±‚å¯ä»¥åµŒå¥—ï¼š

```css
@layer framework {
  @layer reset {
    * {
      margin: 0;
    }
  }

  @layer base {
    body {
      line-height: 1.5;
    }
  }
}

/* ç­‰æ•ˆå†™æ³• */
@layer framework.reset {
  * {
    margin: 0;
  }
}
```

åµŒå¥—å±‚çš„ä¼˜å…ˆçº§è§„åˆ™ï¼š

1. å¤–å±‚å…ˆäºå†…å±‚è§£æ
2. åŒçº§å±‚æŒ‰å£°æ˜é¡ºåº

## æœªåˆ†å±‚æ ·å¼

æœªæ”¾å…¥ä»»ä½•å±‚çš„æ ·å¼ä¼˜å…ˆçº§**é«˜äº**æ‰€æœ‰å±‚å†…æ ·å¼ï¼š

```css
@layer base {
  p {
    color: blue;
  }
}

/* æœªåˆ†å±‚æ ·å¼ - ä¼˜å…ˆçº§æ›´é«˜ */
p {
  color: red; /* èƒœå‡ºï¼ */
}
```

è¿™æ„å‘³ç€ä½ å¯ä»¥æŠŠç¬¬ä¸‰æ–¹åº“æ”¾å…¥å±‚ä¸­ï¼Œç¡®ä¿è‡ªå·±çš„æ ·å¼èƒ½è½»æ¾è¦†ç›–ã€‚

## å¯¼å…¥ä¸å±‚

### å°†å¯¼å…¥æ”¾å…¥å±‚

```css
/* å°†æ•´ä¸ª CSS æ–‡ä»¶æ”¾å…¥å±‚ */
@import url('reset.css') layer(reset);
@import url('framework.css') layer(framework);

/* ä½ çš„æ ·å¼ï¼ˆæœªåˆ†å±‚ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼‰ */
.my-style {
  color: blue;
}
```

### å±‚é¡ºåºå£°æ˜

```css
/* å…ˆå£°æ˜å±‚é¡ºåºï¼Œç¡®ä¿å¯¼å…¥é¡ºåºä¸å½±å“ä¼˜å…ˆçº§ */
@layer reset, framework, custom;

@import url('framework.css') layer(framework);
@import url('reset.css') layer(reset);

@layer custom {
  /* è‡ªå®šä¹‰æ ·å¼ */
}
```

## ä¸é€‰æ‹©å™¨ä¼˜å…ˆçº§çš„å…³ç³»

ğŸ¯ å±‚ä¼˜å…ˆçº§ > é€‰æ‹©å™¨ä¼˜å…ˆçº§

```css
@layer low, high;

@layer low {
  #very-specific-id.with-class[and-attribute] {
    color: red;
  }
}

@layer high {
  p {
    color: blue;
  } /* èƒœå‡ºï¼å³ä½¿é€‰æ‹©å™¨æƒé‡ä½ */
}
```

å±‚å†…çš„é€‰æ‹©å™¨ä¼˜å…ˆçº§ä»ç„¶æ­£å¸¸å·¥ä½œï¼š

```css
@layer components {
  .button {
    color: gray;
  }

  .button.primary {
    color: blue;
  } /* åœ¨åŒä¸€å±‚å†…ï¼Œä¼˜å…ˆçº§æ›´é«˜ */
}
```

## ä¸ !important çš„å…³ç³»

`!important` åœ¨å±‚å å±‚ä¸­æœ‰ç‰¹æ®Šè¡Œä¸ºâ€”â€”**é¡ºåºåè½¬**ï¼š

```css
@layer first, second;

@layer first {
  p {
    color: red !important;
  } /* èƒœå‡ºï¼ */
}

@layer second {
  p {
    color: blue !important;
  }
}
```

å¯¹äº `!important` å£°æ˜ï¼Œå…ˆå£°æ˜çš„å±‚ä¼˜å…ˆçº§æ›´é«˜ã€‚è¿™ä¸æ­£å¸¸å£°æ˜ç›¸åã€‚

## å®æˆ˜æ¡ˆä¾‹

### æ ·å¼æ¶æ„

```css
/* å®šä¹‰å±‚çº§ç»“æ„ */
@layer reset, base, layout, components, utilities, overrides;

/* Reset å±‚ï¼šé‡ç½®æµè§ˆå™¨é»˜è®¤æ ·å¼ */
@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
}

/* Base å±‚ï¼šåŸºç¡€å…ƒç´ æ ·å¼ */
@layer base {
  body {
    font-family: system-ui, sans-serif;
    line-height: 1.5;
  }

  a {
    color: var(--color-primary);
  }
}

/* Layout å±‚ï¼šå¸ƒå±€ç›¸å…³ */
@layer layout {
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .grid {
    display: grid;
    gap: 1rem;
  }
}

/* Components å±‚ï¼šç»„ä»¶æ ·å¼ */
@layer components {
  .button {
    padding: 0.5rem 1rem;
    border-radius: 4px;
  }

  .card {
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
}

/* Utilities å±‚ï¼šå·¥å…·ç±» */
@layer utilities {
  .text-center {
    text-align: center;
  }

  .hidden {
    display: none;
  }
}

/* Overrides å±‚ï¼šè¦†ç›–å’Œä¾‹å¤– */
@layer overrides {
  .no-margin {
    margin: 0 !important;
  }
}
```

### é›†æˆç¬¬ä¸‰æ–¹åº“

```css
/* å°†ç¬¬ä¸‰æ–¹åº“æ”¾å…¥ä½ä¼˜å…ˆçº§å±‚ */
@layer vendor, custom;

@import url('bootstrap.css') layer(vendor);
@import url('some-library.css') layer(vendor);

/* ä½ çš„è‡ªå®šä¹‰æ ·å¼è‡ªåŠ¨ä¼˜å…ˆ */
@layer custom {
  .button {
    /* è½»æ¾è¦†ç›– Bootstrap çš„ .button */
  }
}

/* æˆ–è€…ä¸æ”¾å…¥å±‚ï¼Œä¼˜å…ˆçº§æ›´é«˜ */
.button {
  /* å³ä½¿æ²¡æœ‰æ›´é«˜çš„é€‰æ‹©å™¨æƒé‡ä¹Ÿèƒ½è¦†ç›– */
}
```

### ä¸»é¢˜ç³»ç»Ÿ

```css
@layer theme.tokens, theme.base, theme.components;

@layer theme.tokens {
  :root {
    --color-primary: #3b82f6;
    --color-secondary: #10b981;
    --spacing: 1rem;
  }

  [data-theme='dark'] {
    --color-primary: #60a5fa;
    --color-secondary: #34d399;
  }
}

@layer theme.base {
  body {
    color: var(--color-text);
    background: var(--color-bg);
  }
}

@layer theme.components {
  .button {
    background: var(--color-primary);
  }
}
```

### å“åº”å¼è¦†ç›–

```css
@layer base, responsive;

@layer base {
  .sidebar {
    width: 250px;
  }
}

@layer responsive {
  @media (max-width: 768px) {
    .sidebar {
      width: 100%;
    }
  }
}
```

## æœ€ä½³å®è·µ

### å±‚å‘½åè§„èŒƒ

```css
/* æ¨èï¼šè¯­ä¹‰åŒ–ã€å±‚æ¬¡åˆ†æ˜ */
@layer reset, base, layout, components, utilities;

/* åµŒå¥—å±‚ç”¨äºç»„ä»¶åº“ */
@layer framework {
  @layer reset, base, components;
}

/* é¿å…ï¼šè¿‡äºç»†ç¢çš„å±‚ */
@layer buttons, cards, modals, inputs; /* ä¸æ¨è */
```

### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å±‚

âœ… é€‚åˆä½¿ç”¨å±‚çš„åœºæ™¯ï¼š

- é›†æˆç¬¬ä¸‰æ–¹ CSS åº“
- å¤§å‹é¡¹ç›®çš„æ ·å¼æ¶æ„
- ç»„ä»¶åº“å¼€å‘
- éœ€è¦æ¸…æ™°çš„æ ·å¼è¦†ç›–è§„åˆ™

âŒ å¯èƒ½ä¸éœ€è¦å±‚çš„åœºæ™¯ï¼š

- å°å‹é¡¹ç›®
- æ ·å¼å†²çªä¸æ˜¯ä¸»è¦é—®é¢˜
- å›¢é˜Ÿå¯¹å±‚å å±‚ä¸ç†Ÿæ‚‰

### è°ƒè¯•æŠ€å·§

Chrome DevTools æ”¯æŒæŸ¥çœ‹å…ƒç´ æ ·å¼æ‰€å±çš„å±‚ï¼š

1. æ‰“å¼€ Elements é¢æ¿
2. æŸ¥çœ‹ Styles é¢æ¿
3. æ¯æ¡è§„åˆ™ä¼šæ˜¾ç¤ºå…¶æ‰€å±çš„å±‚ï¼ˆå¦‚ `@layer components`ï¼‰

---

å±‚å å±‚ä¸º CSS ä¼˜å…ˆçº§ç®¡ç†æä¾›äº†æ–°çš„ç»´åº¦ã€‚ç»“åˆä¼ ç»Ÿçš„é€‰æ‹©å™¨ä¼˜å…ˆçº§ï¼Œä½ å¯ä»¥æ„å»ºæ›´å¯ç»´æŠ¤çš„æ ·å¼æ¶æ„ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹  CSS è¿‡æ¸¡æ•ˆæœï¼Œä¸ºé¡µé¢æ·»åŠ å¹³æ»‘çš„åŠ¨ç”»ã€‚
