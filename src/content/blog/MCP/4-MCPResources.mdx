---
title: 'MCP Resourcesï¼šå‘ AI æš´éœ²æ•°æ®'
description: 'å­¦ä¹  MCP Resources çš„è®¾è®¡ä¸å®ç°ï¼ŒæŒæ¡é™æ€èµ„æºã€åŠ¨æ€æ¨¡æ¿ã€URI è®¾è®¡å’Œå‚æ•°è¡¥å…¨ç­‰æ ¸å¿ƒæ¦‚å¿µ'
pubDate: 2025-12-03
toc: true
ogImage: true
category: 'MCP'
tags: ['MCP', 'Model Context Protocol', 'TypeScript', 'Resources', 'URI']
---

Tool è®© AI èƒ½å¤Ÿ"åšäº‹"ï¼Œè€Œ Resource è®© AI èƒ½å¤Ÿ"çœ‹åˆ°"æ•°æ®ã€‚è¿™ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•é€šè¿‡ MCP Resources å‘ AI æš´éœ²ä½ çš„æ•°æ®ã€‚

## ğŸ¯ Resource vs Tool

åœ¨æ·±å…¥ä¹‹å‰ï¼Œå…ˆç†æ¸… Resource å’Œ Tool çš„åŒºåˆ«ï¼š

| ç‰¹æ€§         | Resource                | Tool               |
| ------------ | ----------------------- | ------------------ |
| **è§¦å‘æ–¹å¼** | åº”ç”¨/ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©       | AI å†³å®šè°ƒç”¨        |
| **æ•°æ®æµå‘** | Server â†’ Clientï¼ˆåªè¯»ï¼‰ | åŒå‘ï¼ˆå¯å†™ï¼‰       |
| **å…¸å‹ç”¨é€”** | æš´éœ²é…ç½®ã€æ—¥å¿—ã€æ–‡æ¡£    | æ‰§è¡Œæ“ä½œã€ä¿®æ”¹æ•°æ® |
| **å®‰å…¨çº§åˆ«** | ç›¸å¯¹å®‰å…¨                | éœ€è¦ç¡®è®¤           |

ğŸ¤” **ä½•æ—¶ç”¨ Resourceï¼Ÿ**

- æ•°æ®æ˜¯"è¢«åŠ¨"æä¾›çš„ï¼ŒAI ä¸éœ€è¦"è¯·æ±‚"
- æ•°æ®é‡å¯èƒ½å¾ˆå¤§ï¼Œä¸é€‚åˆæ”¾åœ¨å¯¹è¯ä¸Šä¸‹æ–‡ä¸­
- éœ€è¦æŒ‰ URI ç»“æ„åŒ–ç»„ç»‡æ•°æ®

## é™æ€ Resource

æœ€ç®€å•çš„ Resource æ˜¯å›ºå®š URI çš„é™æ€æ•°æ®ï¼š

```typescript
import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js'

const server = new McpServer({
  name: 'config-server',
  version: '1.0.0',
})

// æ³¨å†Œé™æ€ Resource
server.registerResource(
  'app-config', // èµ„æºæ ‡è¯†ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
  'config://app/settings', // URIï¼ˆå®¢æˆ·ç«¯ä½¿ç”¨ï¼‰
  {
    title: 'åº”ç”¨é…ç½®',
    description: 'å½“å‰åº”ç”¨çš„é…ç½®ä¿¡æ¯',
    mimeType: 'application/json',
  },
  async (uri) => ({
    contents: [
      {
        uri: uri.href,
        mimeType: 'application/json',
        text: JSON.stringify(
          {
            theme: 'dark',
            language: 'zh-CN',
            version: '2.0.0',
          },
          null,
          2
        ),
      },
    ],
  })
)
```

**å‚æ•°è¯´æ˜**ï¼š

1. **èµ„æºæ ‡è¯†** (`'app-config'`) - Server å†…éƒ¨ä½¿ç”¨çš„å”¯ä¸€ ID
2. **URI** (`'config://app/settings'`) - å®¢æˆ·ç«¯è¯·æ±‚æ—¶ä½¿ç”¨çš„åœ°å€
3. **å…ƒæ•°æ®** - titleã€descriptionã€mimeType
4. **å¤„ç†å‡½æ•°** - è¿”å›èµ„æºå†…å®¹

### å¤šç§å†…å®¹ç±»å‹

```typescript
// æ–‡æœ¬å†…å®¹
{
  contents: [
    {
      uri: 'file:///readme.md',
      mimeType: 'text/markdown',
      text: '# Hello World\n\nThis is a readme.',
    },
  ]
}

// äºŒè¿›åˆ¶å†…å®¹ï¼ˆBase64ï¼‰
{
  contents: [
    {
      uri: 'image://logo.png',
      mimeType: 'image/png',
      blob: 'iVBORw0KGgoAAAANSUhEUgAA...', // Base64 ç¼–ç 
    },
  ]
}
```

## åŠ¨æ€ Resourceï¼ˆResourceTemplateï¼‰

å®é™…åº”ç”¨ä¸­ï¼ŒResource é€šå¸¸æ˜¯åŠ¨æ€çš„ï¼Œéœ€è¦æ ¹æ®å‚æ•°è¿”å›ä¸åŒæ•°æ®ã€‚è¿™æ—¶ä½¿ç”¨ `ResourceTemplate`ï¼š

```typescript
import {
  McpServer,
  ResourceTemplate,
} from '@modelcontextprotocol/sdk/server/mcp.js'

const server = new McpServer({
  name: 'user-server',
  version: '1.0.0',
})

// åŠ¨æ€ç”¨æˆ·èµ„æº
server.registerResource(
  'user-profile',
  new ResourceTemplate('users://{userId}/profile', { list: undefined }),
  {
    title: 'ç”¨æˆ·èµ„æ–™',
    description: 'è·å–æŒ‡å®šç”¨æˆ·çš„èµ„æ–™ä¿¡æ¯',
  },
  async (uri, { userId }) => {
    // userId ä» URI æ¨¡æ¿ä¸­æå–
    const user = await fetchUser(userId)

    return {
      contents: [
        {
          uri: uri.href,
          mimeType: 'application/json',
          text: JSON.stringify(user, null, 2),
        },
      ],
    }
  }
)

// æ¨¡æ‹Ÿæ•°æ®è·å–
async function fetchUser(userId: string) {
  return {
    id: userId,
    name: `ç”¨æˆ· ${userId}`,
    email: `user${userId}@example.com`,
    createdAt: new Date().toISOString(),
  }
}
```

### URI æ¨¡æ¿è¯­æ³•

URI æ¨¡æ¿éµå¾ª RFC 6570 ç®€åŒ–è§„èŒƒï¼š

```
users://{userId}/profile        â†’ åŒ¹é… users://123/profile
files://{path*}                 â†’ åŒ¹é… files:///a/b/cï¼ˆpath = "a/b/c"ï¼‰
repos://{owner}/{repo}/issues   â†’ åŒ¹é… repos://microsoft/vscode/issues
```

### åˆ—å‡ºå¯ç”¨èµ„æº

é€šè¿‡ `list` å‚æ•°ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘ç°å¯ç”¨çš„èµ„æºï¼š

```typescript
server.registerResource(
  'log-files',
  new ResourceTemplate('logs://{date}', {
    list: async () => {
      // è¿”å›æœ€è¿‘ 7 å¤©çš„æ—¥å¿—
      const dates = getLast7Days()
      return {
        resources: dates.map((date) => ({
          uri: `logs://${date}`,
          name: `${date} æ—¥å¿—`,
          description: `${date} çš„ç³»ç»Ÿæ—¥å¿—`,
        })),
      }
    },
  }),
  {
    title: 'æ—¥å¿—æ–‡ä»¶',
    description: 'æŒ‰æ—¥æœŸæŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—',
  },
  async (uri, { date }) => {
    const logs = await readLogFile(date)
    return {
      contents: [
        {
          uri: uri.href,
          text: logs,
        },
      ],
    }
  }
)
```

## å‚æ•°è‡ªåŠ¨è¡¥å…¨

ä¸ºæå‡ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥ä¸º URI å‚æ•°æä¾›è‡ªåŠ¨è¡¥å…¨ï¼š

```typescript
server.registerResource(
  'repository',
  new ResourceTemplate('github://repos/{owner}/{repo}', {
    list: undefined,
    complete: {
      // owner å‚æ•°çš„è¡¥å…¨
      owner: async (value) => {
        const orgs = ['microsoft', 'google', 'facebook', 'anthropics']
        return orgs.filter((o) => o.startsWith(value))
      },
      // repo å‚æ•°çš„è¡¥å…¨ï¼ˆä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼‰
      repo: async (value, context) => {
        const owner = context?.arguments?.['owner']
        // æ ¹æ® owner è¿”å›å…¶ä»“åº“
        const repos = await fetchReposByOwner(owner)
        return repos.filter((r) => r.startsWith(value))
      },
    },
  }),
  {
    title: 'GitHub ä»“åº“',
    description: 'è®¿é—® GitHub ä»“åº“ä¿¡æ¯',
  },
  async (uri, { owner, repo }) => {
    const repoInfo = await fetchRepoInfo(owner, repo)
    return {
      contents: [
        {
          uri: uri.href,
          mimeType: 'application/json',
          text: JSON.stringify(repoInfo, null, 2),
        },
      ],
    }
  }
)
```

**è¡¥å…¨å‡½æ•°å‚æ•°**ï¼š

- `value` - ç”¨æˆ·å½“å‰è¾“å…¥çš„å€¼
- `context` - åŒ…å«å·²è§£æçš„å…¶ä»–å‚æ•°

## èµ„æºè®¢é˜…ä¸å˜æ›´é€šçŸ¥

Resource æ”¯æŒè®¢é˜…æœºåˆ¶ï¼Œå½“æ•°æ®å˜åŒ–æ—¶é€šçŸ¥å®¢æˆ·ç«¯ï¼š

```typescript
const server = new McpServer({
  name: 'live-data',
  version: '1.0.0',
})

// æ³¨å†Œå¯è®¢é˜…çš„èµ„æº
server.registerResource(
  'metrics',
  'metrics://system/current',
  {
    title: 'ç³»ç»ŸæŒ‡æ ‡',
    description: 'å®æ—¶ç³»ç»ŸæŒ‡æ ‡æ•°æ®',
  },
  async (uri) => ({
    contents: [
      {
        uri: uri.href,
        mimeType: 'application/json',
        text: JSON.stringify(getCurrentMetrics()),
      },
    ],
  })
)

// å®šæœŸå‘é€å˜æ›´é€šçŸ¥
setInterval(async () => {
  // é€šçŸ¥å®¢æˆ·ç«¯èµ„æºå·²æ›´æ–°
  await server.server.notification({
    method: 'notifications/resources/updated',
    params: {
      uri: 'metrics://system/current',
    },
  })
}, 5000) // æ¯ 5 ç§’é€šçŸ¥ä¸€æ¬¡
```

å®¢æˆ·ç«¯æ”¶åˆ°é€šçŸ¥åå¯ä»¥å†³å®šæ˜¯å¦é‡æ–°è·å–èµ„æºã€‚

## URI è®¾è®¡æœ€ä½³å®è·µ

### 1. ä½¿ç”¨æœ‰æ„ä¹‰çš„ scheme

```typescript
// âœ… å¥½ï¼šscheme è¡¨æ˜èµ„æºç±»å‹
'config://app/settings' // é…ç½®
'file:///path/to/file' // æ–‡ä»¶
'db://users/123' // æ•°æ®åº“è®°å½•
'api://weather/beijing' // API æ•°æ®
'log://2024-01-15/errors' // æ—¥å¿—

// âŒ ä¸å¥½ï¼šé€šç”¨æˆ–æ— æ„ä¹‰çš„ scheme
'resource://1234'
'data://xyz'
```

### 2. å±‚çº§åŒ–è·¯å¾„

```typescript
// âœ… å¥½ï¼šæ¸…æ™°çš„å±‚çº§ç»“æ„
'users://{userId}'
'users://{userId}/posts'
'users://{userId}/posts/{postId}'
'users://{userId}/posts/{postId}/comments'

// âŒ ä¸å¥½ï¼šæ‰å¹³æˆ–æ··ä¹±çš„ç»“æ„
'user-post://123-456'
'data://user_123_post_456'
```

### 3. å‚æ•°å‘½å

```typescript
// âœ… å¥½ï¼šæè¿°æ€§çš„å‚æ•°å
'repos://{owner}/{repository}'
'logs://{date}/{level}'

// âŒ ä¸å¥½ï¼šå•å­—æ¯æˆ–æ— æ„ä¹‰
'repos://{o}/{r}'
'logs://{d}/{l}'
```

## å®Œæ•´ç¤ºä¾‹ï¼šæ–‡ä»¶ç³»ç»Ÿèµ„æº

```typescript
import {
  McpServer,
  ResourceTemplate,
} from '@modelcontextprotocol/sdk/server/mcp.js'
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js'
import { readFile, readdir, stat } from 'fs/promises'
import { join, resolve, extname } from 'path'

const server = new McpServer({
  name: 'filesystem-resources',
  version: '1.0.0',
})

const BASE_DIR = process.env.MCP_BASE_DIR || process.cwd()

// MIME ç±»å‹æ˜ å°„
const MIME_TYPES: Record<string, string> = {
  '.txt': 'text/plain',
  '.md': 'text/markdown',
  '.json': 'application/json',
  '.js': 'text/javascript',
  '.ts': 'text/typescript',
  '.html': 'text/html',
  '.css': 'text/css',
  '.yaml': 'text/yaml',
  '.yml': 'text/yaml',
}

function getMimeType(filePath: string): string {
  return MIME_TYPES[extname(filePath)] || 'text/plain'
}

// ç›®å½•åˆ—è¡¨èµ„æº
server.registerResource(
  'directory',
  new ResourceTemplate('file:///{path*}', {
    list: async () => {
      // åˆ—å‡ºæ ¹ç›®å½•å†…å®¹
      const entries = await readdir(BASE_DIR, { withFileTypes: true })
      return {
        resources: entries.map((entry) => ({
          uri: `file:///${entry.name}`,
          name: entry.name,
          description: entry.isDirectory() ? 'ç›®å½•' : 'æ–‡ä»¶',
          mimeType: entry.isDirectory() ? undefined : getMimeType(entry.name),
        })),
      }
    },
  }),
  {
    title: 'æ–‡ä»¶ç³»ç»Ÿ',
    description: 'è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½•',
  },
  async (uri, { path }) => {
    const fullPath = resolve(BASE_DIR, path || '')

    // å®‰å…¨æ£€æŸ¥
    if (!fullPath.startsWith(BASE_DIR)) {
      throw new Error('è®¿é—®è¢«æ‹’ç»')
    }

    const stats = await stat(fullPath)

    if (stats.isDirectory()) {
      // è¿”å›ç›®å½•åˆ—è¡¨
      const entries = await readdir(fullPath, { withFileTypes: true })
      const listing = entries
        .map((e) => `${e.isDirectory() ? 'ğŸ“' : 'ğŸ“„'} ${e.name}`)
        .join('\n')

      return {
        contents: [
          {
            uri: uri.href,
            mimeType: 'text/plain',
            text: `ç›®å½•ï¼š${path || '/'}\n\n${listing}`,
          },
        ],
      }
    } else {
      // è¿”å›æ–‡ä»¶å†…å®¹
      const content = await readFile(fullPath, 'utf-8')
      return {
        contents: [
          {
            uri: uri.href,
            mimeType: getMimeType(fullPath),
            text: content,
          },
        ],
      }
    }
  }
)

// é…ç½®æ–‡ä»¶èµ„æºï¼ˆç‰¹å®šæ–‡ä»¶å¿«æ·è®¿é—®ï¼‰
server.registerResource(
  'package-json',
  'config://package.json',
  {
    title: 'package.json',
    description: 'é¡¹ç›®çš„ package.json é…ç½®æ–‡ä»¶',
    mimeType: 'application/json',
  },
  async (uri) => {
    try {
      const content = await readFile(join(BASE_DIR, 'package.json'), 'utf-8')
      return {
        contents: [
          {
            uri: uri.href,
            mimeType: 'application/json',
            text: content,
          },
        ],
      }
    } catch {
      return {
        contents: [
          {
            uri: uri.href,
            mimeType: 'text/plain',
            text: 'æœªæ‰¾åˆ° package.json',
          },
        ],
      }
    }
  }
)

// å¯åŠ¨ Server
const transport = new StdioServerTransport()
await server.connect(transport)
console.error('Filesystem Resources Server running')
```

## Resource ä¸ Tool åä½œ

å®é™…åº”ç”¨ä¸­ï¼ŒResource å’Œ Tool å¸¸å¸¸é…åˆä½¿ç”¨ï¼š

```typescript
// Resourceï¼šæš´éœ²å¯ç”¨çš„æŠ¥å‘Šåˆ—è¡¨
server.registerResource(
  'reports',
  new ResourceTemplate('reports://{year}/{month}', {
    list: async () => {
      const reports = await getAvailableReports()
      return {
        resources: reports.map((r) => ({
          uri: `reports://${r.year}/${r.month}`,
          name: `${r.year}å¹´${r.month}æœˆæŠ¥å‘Š`,
        })),
      }
    },
  }),
  { title: 'æœˆåº¦æŠ¥å‘Š', description: 'æŸ¥çœ‹æœˆåº¦æŠ¥å‘Š' },
  async (uri, { year, month }) => {
    const report = await getReport(year, month)
    return { contents: [{ uri: uri.href, text: report }] }
  }
)

// Toolï¼šç”Ÿæˆæ–°æŠ¥å‘Š
server.registerTool(
  'generate_report',
  {
    title: 'ç”ŸæˆæŠ¥å‘Š',
    description: 'ç”ŸæˆæŒ‡å®šæœˆä»½çš„æŠ¥å‘Š',
    inputSchema: {
      year: z.number().int().min(2020).max(2030),
      month: z.number().int().min(1).max(12),
    },
  },
  async ({ year, month }) => {
    await generateReport(year, month)

    // é€šçŸ¥å®¢æˆ·ç«¯æœ‰æ–°èµ„æºå¯ç”¨
    await server.server.notification({
      method: 'notifications/resources/list_changed',
    })

    return {
      content: [
        {
          type: 'text',
          text: `å·²ç”Ÿæˆ ${year}å¹´${month}æœˆ æŠ¥å‘Š`,
        },
        {
          type: 'resource_link',
          uri: `reports://${year}/${month}`,
          name: `${year}å¹´${month}æœˆæŠ¥å‘Š`,
        },
      ],
    }
  }
)
```

## å°ç»“

è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å­¦ä¹ äº† MCP Resources çš„æ ¸å¿ƒæ¦‚å¿µï¼š

âœ… Resource ä¸ Tool çš„åŒºåˆ«ä¸é€‚ç”¨åœºæ™¯
âœ… é™æ€ Resource æ³¨å†Œ
âœ… åŠ¨æ€ ResourceTemplate ä¸ URI æ¨¡æ¿
âœ… å‚æ•°è‡ªåŠ¨è¡¥å…¨ï¼ˆcompletionï¼‰
âœ… èµ„æºè®¢é˜…ä¸å˜æ›´é€šçŸ¥
âœ… URI è®¾è®¡æœ€ä½³å®è·µ
âœ… Resource ä¸ Tool çš„åä½œæ¨¡å¼

ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†å­¦ä¹  MCP çš„ç¬¬ä¸‰ä¸ªåŸè¯­â€”â€”Promptsã€‚

## å‚è€ƒèµ„æ–™

- [MCP Resources è§„èŒƒ](https://modelcontextprotocol.io/docs/concepts/resources)
- [URI Template RFC 6570](https://datatracker.ietf.org/doc/html/rfc6570)
