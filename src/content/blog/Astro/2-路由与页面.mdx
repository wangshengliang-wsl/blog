---
title: Astro è·¯ç”±ä¸é¡µé¢
description: æ·±å…¥ç†è§£ Astro çš„æ–‡ä»¶è·¯ç”±ç³»ç»Ÿï¼ŒæŒæ¡é™æ€è·¯ç”±ã€åŠ¨æ€è·¯ç”±å’Œåˆ†é¡µçš„å®ç°æ–¹å¼
pubDate: 2025-12-02
toc: true
ogImage: true
category: Astro
tags: ['Astro', 'è·¯ç”±', 'åŠ¨æ€è·¯ç”±', 'åˆ†é¡µ']
---

## æ–‡ä»¶è·¯ç”±åŸºç¡€

ğŸ™‹ å¦‚æœä½ ç”¨è¿‡ Next.js æˆ– Nuxtï¼Œå¯¹"æ–‡ä»¶å³è·¯ç”±"çš„æ¦‚å¿µåº”è¯¥ä¸é™Œç”Ÿã€‚Astro é‡‡ç”¨äº†ç±»ä¼¼çš„è®¾è®¡ï¼š`src/pages/` ç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè‡ªåŠ¨æ˜ å°„æˆ URL è·¯ç”±ã€‚

### ç›®å½•æ˜ å°„è§„åˆ™

```
src/pages/
â”œâ”€â”€ index.astro         â†’ /
â”œâ”€â”€ about.astro         â†’ /about
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ index.astro     â†’ /blog
â”‚   â””â”€â”€ first-post.astro â†’ /blog/first-post
â””â”€â”€ docs/
    â””â”€â”€ guide/
        â””â”€â”€ intro.astro â†’ /docs/guide/intro
```

ğŸ¯ è§„åˆ™å¾ˆç®€å•ï¼š

- æ–‡ä»¶è·¯å¾„ = URL è·¯å¾„
- `index.astro` = ç›®å½•çš„é»˜è®¤é¡µé¢
- æ–‡ä»¶æ‰©å±•åä¸å‡ºç°åœ¨ URL ä¸­

### æ”¯æŒçš„æ–‡ä»¶ç±»å‹

`src/pages/` ç›®å½•æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ï¼š

| æ–‡ä»¶ç±»å‹  | ç”¨é€”               | ç¤ºä¾‹          |
| --------- | ------------------ | ------------- |
| `.astro`  | Astro ç»„ä»¶é¡µé¢     | `about.astro` |
| `.md`     | Markdown é¡µé¢      | `post.md`     |
| `.mdx`    | MDX é¡µé¢ï¼ˆéœ€é›†æˆï¼‰ | `post.mdx`    |
| `.html`   | çº¯ HTML é¡µé¢       | `legacy.html` |
| `.js/.ts` | API ç«¯ç‚¹           | `api/data.ts` |

ğŸ”¶ **æ³¨æ„**: `.md` å’Œ `.mdx` æ–‡ä»¶ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤å¸ƒå±€æ¸²æŸ“ã€‚å¦‚æœæƒ³è‡ªå®šä¹‰å¸ƒå±€ï¼Œéœ€è¦åœ¨ Frontmatter ä¸­æŒ‡å®šã€‚

### åµŒå¥—è·¯ç”±ä¸ index æ–‡ä»¶

å½“ç›®å½•å’Œæ–‡ä»¶åŒåæ—¶ï¼ŒAstro çš„å¤„ç†æ–¹å¼ï¼š

```
src/pages/
â”œâ”€â”€ blog.astro          â†’ /blog
â””â”€â”€ blog/
    â”œâ”€â”€ index.astro     â†’ /blog (ä¼šå’Œ blog.astro å†²çª!)
    â””â”€â”€ post.astro      â†’ /blog/post
```

ğŸ”¶ **é¿å…å†²çª**: ä¸è¦åŒæ—¶åˆ›å»º `blog.astro` å’Œ `blog/index.astro`ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ç§æ–¹å¼å³å¯ã€‚æ¨èä½¿ç”¨ç›®å½• + `index.astro` çš„æ–¹å¼ï¼Œæ›´ä¾¿äºç»„ç»‡å­é¡µé¢ã€‚

## é™æ€è·¯ç”±

### åŸºæœ¬é¡µé¢åˆ›å»º

åˆ›å»ºä¸€ä¸ªç®€å•çš„é™æ€é¡µé¢ï¼š

```astro
---
// src/pages/about.astro
import Layout from '../layouts/Layout.astro'
---

<Layout title="å…³äºæˆ‘">
  <h1>å…³äºæˆ‘</h1>
  <p>è¿™æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œæ„å»ºæ—¶ç”Ÿæˆ HTMLã€‚</p>
</Layout>
```

è®¿é—® `/about` å°±èƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ã€‚

### å¤šå±‚çº§ç›®å½•ç»„ç»‡

å®é™…é¡¹ç›®ä¸­ï¼Œé¡µé¢å¾€å¾€éœ€è¦å¤šçº§ç›®å½•ï¼š

```
src/pages/
â”œâ”€â”€ index.astro
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ index.astro     # åšå®¢åˆ—è¡¨é¡µ
â”‚   â””â”€â”€ [slug].astro    # åšå®¢è¯¦æƒ…é¡µï¼ˆåŠ¨æ€è·¯ç”±ï¼‰
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ index.astro     # æ–‡æ¡£é¦–é¡µ
â”‚   â”œâ”€â”€ getting-started.astro
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ index.astro # API æ–‡æ¡£é¦–é¡µ
â”‚       â””â”€â”€ reference.astro
â””â”€â”€ legal/
    â”œâ”€â”€ privacy.astro
    â””â”€â”€ terms.astro
```

### é“¾æ¥å¯¼èˆª

é¡µé¢ä¹‹é—´çš„å¯¼èˆªä½¿ç”¨æ™®é€šçš„ `<a>` æ ‡ç­¾ï¼š

```astro
---
// src/components/Nav.astro
const links = [
  { href: '/', text: 'é¦–é¡µ' },
  { href: '/blog', text: 'åšå®¢' },
  { href: '/about', text: 'å…³äº' },
]
---

<nav>
  {links.map((link) => <a href={link.href}>{link.text}</a>)}
</nav>
```

ğŸ¤” ä¸ºä»€ä¹ˆä¸ç”¨ `<Link>` ç»„ä»¶ï¼Ÿ

Astro é»˜è®¤æ˜¯é™æ€ç«™ç‚¹ï¼Œæ™®é€š `<a>` æ ‡ç­¾å°±èƒ½å®ç°é¡µé¢è·³è½¬ã€‚å¦‚æœä½ å¯ç”¨äº† View Transitionsï¼ŒAstro ä¼šè‡ªåŠ¨æ‹¦æˆªå¯¼èˆªå¹¶æä¾›å¹³æ»‘è¿‡æ¸¡ï¼Œä¸éœ€è¦ç‰¹æ®Šç»„ä»¶ã€‚

## åŠ¨æ€è·¯ç”±

é™æ€è·¯ç”±é€‚åˆå†…å®¹å›ºå®šçš„é¡µé¢ï¼Œä½†åšå®¢æ–‡ç« ã€äº§å“è¯¦æƒ…è¿™ç±»é¡µé¢æ•°é‡ä¸ç¡®å®šï¼Œå°±éœ€è¦åŠ¨æ€è·¯ç”±äº†ã€‚

### å•å‚æ•°è·¯ç”± `[param]`

ç”¨æ–¹æ‹¬å·åŒ…è£¹æ–‡ä»¶åï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåŠ¨æ€å‚æ•°ï¼š

```
src/pages/blog/[slug].astro  â†’ /blog/:slug
```

ğŸ¯ è¿™ä¸ªæ–‡ä»¶å¯ä»¥åŒ¹é…ï¼š

- `/blog/hello-world`
- `/blog/astro-tutorial`
- `/blog/any-slug-here`

### getStaticPaths() å‡½æ•°è¯¦è§£

å¯¹äºé™æ€æ„å»ºï¼ˆSSGï¼‰ï¼Œä½ éœ€è¦å‘Šè¯‰ Astro æ‰€æœ‰å¯èƒ½çš„å‚æ•°å€¼ï¼š

```astro
---
// src/pages/blog/[slug].astro
export function getStaticPaths() {
  return [
    { params: { slug: 'hello-world' } },
    { params: { slug: 'astro-tutorial' } },
    { params: { slug: 'typescript-tips' } },
  ]
}

const { slug } = Astro.params
---

<h1>æ–‡ç« : {slug}</h1>
```

æ„å»ºæ—¶ï¼ŒAstro ä¼šä¸ºæ¯ä¸ª `params` å¯¹è±¡ç”Ÿæˆä¸€ä¸ª HTML æ–‡ä»¶ï¼š

- `dist/blog/hello-world/index.html`
- `dist/blog/astro-tutorial/index.html`
- `dist/blog/typescript-tips/index.html`

### ä»å®é™…æ•°æ®ç”Ÿæˆè·¯å¾„

å®é™…é¡¹ç›®ä¸­ï¼Œè·¯å¾„å‚æ•°é€šå¸¸æ¥è‡ªæ•°æ®æºï¼š

```astro
---
// src/pages/blog/[slug].astro
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const posts = await getCollection('blog')

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }))
}

const { post } = Astro.props
---

<h1>{post.data.title}</h1>
```

### params ä¸ props çš„åŒºåˆ«

`getStaticPaths` è¿”å›çš„å¯¹è±¡å¯ä»¥åŒ…å« `params` å’Œ `props`ï¼š

```typescript
{
  params: { slug: 'hello' },  // å¿…é¡»ï¼Œç”¨äºæ„å»º URL
  props: { title: '...' },    // å¯é€‰ï¼Œä¼ é€’ç»™é¡µé¢çš„æ•°æ®
}
```

| å±æ€§     | ç”¨é€”           | ç±»å‹é™åˆ¶       |
| -------- | -------------- | -------------- |
| `params` | æ„å»º URL è·¯å¾„  | åªèƒ½æ˜¯å­—ç¬¦ä¸²   |
| `props`  | ä¼ é€’æ•°æ®ç»™é¡µé¢ | å¯ä»¥æ˜¯ä»»æ„ç±»å‹ |

ğŸ¯ **æœ€ä½³å®è·µ**: æŠŠéœ€è¦çš„æ•°æ®é€šè¿‡ `props` ä¼ é€’ï¼Œé¿å…åœ¨é¡µé¢ä¸­å†æ¬¡æŸ¥è¯¢ã€‚

```astro
---
// âŒ ä¸æ¨èï¼šåœ¨é¡µé¢ä¸­å†æ¬¡æŸ¥è¯¢
export async function getStaticPaths() {
  const posts = await getCollection('blog')
  return posts.map((post) => ({
    params: { slug: post.id },
  }))
}

const { slug } = Astro.params
const posts = await getCollection('blog')
const post = posts.find((p) => p.id === slug) // é‡å¤æŸ¥è¯¢

// âœ… æ¨èï¼šé€šè¿‡ props ä¼ é€’
export async function getStaticPaths() {
  const posts = await getCollection('blog')
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post }, // ç›´æ¥ä¼ é€’
  }))
}

const { post } = Astro.props // ç›´æ¥ä½¿ç”¨
---
```

### å‰©ä½™å‚æ•°è·¯ç”± `[...spread]`

æœ‰æ—¶éœ€è¦åŒ¹é…ä»»æ„æ·±åº¦çš„è·¯å¾„ï¼š

```
src/pages/docs/[...path].astro
```

è¿™å¯ä»¥åŒ¹é…ï¼š

- `/docs` â†’ `path` ä¸º `undefined`
- `/docs/intro` â†’ `path` ä¸º `'intro'`
- `/docs/api/reference` â†’ `path` ä¸º `'api/reference'`

```astro
---
// src/pages/docs/[...path].astro
export function getStaticPaths() {
  return [
    { params: { path: undefined } }, // /docs
    { params: { path: 'intro' } }, // /docs/intro
    { params: { path: 'api/reference' } }, // /docs/api/reference
  ]
}

const { path } = Astro.params
---

<h1>æ–‡æ¡£è·¯å¾„: {path || 'é¦–é¡µ'}</h1>
```

### å¤šå‚æ•°è·¯ç”±

å¯ä»¥åœ¨è·¯å¾„ä¸­ä½¿ç”¨å¤šä¸ªåŠ¨æ€å‚æ•°ï¼š

```
src/pages/[lang]/blog/[slug].astro
```

åŒ¹é… `/zh/blog/hello` æˆ– `/en/blog/world`ï¼š

```astro
---
export function getStaticPaths() {
  return [
    { params: { lang: 'zh', slug: 'hello' } },
    { params: { lang: 'en', slug: 'world' } },
  ]
}

const { lang, slug } = Astro.params
---
```

## åˆ†é¡µå®ç°

### paginate() å‡½æ•°ä½¿ç”¨

Astro å†…ç½®äº† `paginate()` å‡½æ•°ï¼Œç®€åŒ–åˆ†é¡µå®ç°ï¼š

```astro
---
// src/pages/blog/[page].astro
import { getCollection } from 'astro:content'

export async function getStaticPaths({ paginate }) {
  const posts = await getCollection('blog')

  // æŒ‰å‘å¸ƒæ—¥æœŸæ’åº
  const sortedPosts = posts.sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  )

  // æ¯é¡µ 10 ç¯‡æ–‡ç« 
  return paginate(sortedPosts, { pageSize: 10 })
}

const { page } = Astro.props
---

<h1>åšå®¢ - ç¬¬ {page.currentPage} é¡µ</h1>

<ul>
  {
    page.data.map((post) => (
      <li>
        <a href={`/blog/${post.id}`}>{post.data.title}</a>
      </li>
    ))
  }
</ul>
```

`paginate()` ä¼šè‡ªåŠ¨ç”Ÿæˆï¼š

- `/blog/1` â†’ ç¬¬ 1 é¡µ
- `/blog/2` â†’ ç¬¬ 2 é¡µ
- ...ä»¥æ­¤ç±»æ¨

### Page å¯¹è±¡å±æ€§è¯¦è§£

`paginate()` ä¼ é€’ç»™é¡µé¢çš„ `page` å¯¹è±¡åŒ…å«ä¸°å¯Œçš„ä¿¡æ¯ï¼š

```typescript
interface Page<T> {
  // å½“å‰é¡µçš„æ•°æ®
  data: T[]

  // åˆ†é¡µå…ƒæ•°æ®
  start: number // ç¬¬ä¸€æ¡æ•°æ®çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
  end: number // æœ€åä¸€æ¡æ•°æ®çš„ç´¢å¼•
  total: number // æ€»æ•°æ®é‡
  currentPage: number // å½“å‰é¡µç ï¼ˆä» 1 å¼€å§‹ï¼‰
  size: number // æ¯é¡µå¤§å°
  lastPage: number // æœ€åä¸€é¡µé¡µç 

  // å¯¼èˆª URL
  url: {
    current: string // å½“å‰é¡µ URL
    prev?: string // ä¸Šä¸€é¡µ URLï¼ˆç¬¬ä¸€é¡µæ—¶ä¸º undefinedï¼‰
    next?: string // ä¸‹ä¸€é¡µ URLï¼ˆæœ€åä¸€é¡µæ—¶ä¸º undefinedï¼‰
    first?: string // ç¬¬ä¸€é¡µ URLï¼ˆå½“å‰å°±æ˜¯ç¬¬ä¸€é¡µæ—¶ä¸º undefinedï¼‰
    last?: string // æœ€åä¸€é¡µ URLï¼ˆå½“å‰å°±æ˜¯æœ€åä¸€é¡µæ—¶ä¸º undefinedï¼‰
  }
}
```

### åˆ†é¡µå¯¼èˆªç»„ä»¶å®ç°

åˆ©ç”¨ `page.url` å®ç°åˆ†é¡µå¯¼èˆªï¼š

```astro
---
// src/components/Pagination.astro
interface Props {
  page: {
    currentPage: number
    lastPage: number
    url: {
      prev?: string
      next?: string
      first?: string
      last?: string
    }
  }
}

const { page } = Astro.props
const { currentPage, lastPage, url } = page
---

<nav class="pagination" aria-label="åˆ†é¡µå¯¼èˆª">
  {
    url.first && (
      <a href={url.first} aria-label="ç¬¬ä¸€é¡µ">
        Â« é¦–é¡µ
      </a>
    )
  }

  {
    url.prev && (
      <a href={url.prev} aria-label="ä¸Šä¸€é¡µ">
        â€¹ ä¸Šä¸€é¡µ
      </a>
    )
  }

  <span class="current">
    {currentPage} / {lastPage}
  </span>

  {
    url.next && (
      <a href={url.next} aria-label="ä¸‹ä¸€é¡µ">
        ä¸‹ä¸€é¡µ â€º
      </a>
    )
  }

  {
    url.last && (
      <a href={url.last} aria-label="æœ€åä¸€é¡µ">
        æœ«é¡µ Â»
      </a>
    )
  }
</nav>

<style>
  .pagination {
    display: flex;
    gap: 1rem;
    justify-content: center;
    align-items: center;
    margin-top: 2rem;
  }

  .pagination a {
    padding: 0.5rem 1rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    text-decoration: none;
  }

  .pagination a:hover {
    background-color: #f5f5f5;
  }

  .current {
    font-weight: bold;
  }
</style>
```

ä½¿ç”¨åˆ†é¡µç»„ä»¶ï¼š

```astro
---
// src/pages/blog/[page].astro
import Pagination from '../../components/Pagination.astro'
// ... getStaticPaths å’Œå…¶ä»–ä»£ç 

const { page } = Astro.props
---

<ul>
  {page.data.map((post) => <li>{post.data.title}</li>)}
</ul>

<Pagination {page} />
```

### è‡ªå®šä¹‰åˆ†é¡µ URL æ ¼å¼

é»˜è®¤åˆ†é¡µ URL æ˜¯ `/blog/1`ã€`/blog/2`ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼š

```astro
---
export async function getStaticPaths({ paginate }) {
  const posts = await getCollection('blog')

  return paginate(posts, {
    pageSize: 10,
    // è‡ªå®šä¹‰ URL æ ¼å¼
    // /blog/page/1, /blog/page/2
  })
}
---
```

å¦‚æœæƒ³è¦ `/blog/page/1` æ ¼å¼ï¼Œè°ƒæ•´æ–‡ä»¶ä½ç½®ï¼š

```
src/pages/blog/page/[page].astro
```

## SSR åŠ¨æ€è·¯ç”±

å‰é¢è®²çš„éƒ½æ˜¯é™æ€æ„å»ºï¼ˆSSGï¼‰æ¨¡å¼ï¼Œéœ€è¦åœ¨æ„å»ºæ—¶ç¡®å®šæ‰€æœ‰è·¯ç”±ã€‚å¦‚æœå†…å®¹æ˜¯åŠ¨æ€çš„ï¼ˆæ¯”å¦‚æ¥è‡ªæ•°æ®åº“ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ã€‚

### é™æ€ vs æœåŠ¡ç«¯æ¸²æŸ“æ¨¡å¼

| ç‰¹æ€§           | SSG (é™æ€)         | SSR (æœåŠ¡ç«¯)     |
| -------------- | ------------------ | ---------------- |
| æ„å»ºæ—¶æœº       | æ„å»ºæ—¶ç”Ÿæˆæ‰€æœ‰é¡µé¢ | è¯·æ±‚æ—¶åŠ¨æ€æ¸²æŸ“   |
| æ€§èƒ½           | æå¿«ï¼ˆçº¯é™æ€æ–‡ä»¶ï¼‰ | å–å†³äºæœåŠ¡å™¨     |
| getStaticPaths | å¿…éœ€               | ä¸éœ€è¦           |
| æ•°æ®å®æ—¶æ€§     | æ„å»ºæ—¶ç¡®å®š         | æ¯æ¬¡è¯·æ±‚è·å–æœ€æ–° |
| éƒ¨ç½²æ–¹å¼       | CDN / é™æ€æ‰˜ç®¡     | Node.js æœåŠ¡å™¨   |

### å¯ç”¨ SSR æ¨¡å¼

åœ¨ `astro.config.ts` ä¸­é…ç½®ï¼š

```typescript
// astro.config.ts
import { defineConfig } from 'astro/config'
import node from '@astrojs/node'

export default defineConfig({
  output: 'server', // æˆ– 'hybrid'
  adapter: node({
    mode: 'standalone',
  }),
})
```

- `output: 'server'` â†’ æ‰€æœ‰é¡µé¢é»˜è®¤ SSR
- `output: 'hybrid'` â†’ é»˜è®¤é™æ€ï¼Œå¯é€‰æ‹©æ€§ SSR

### Astro.params åœ¨ SSR ä¸­çš„ä½¿ç”¨

SSR æ¨¡å¼ä¸‹ï¼Œä¸éœ€è¦ `getStaticPaths`ï¼Œç›´æ¥è¯»å–å‚æ•°ï¼š

```astro
---
// src/pages/blog/[slug].astro
// SSR æ¨¡å¼ï¼šä¸éœ€è¦ getStaticPaths

const { slug } = Astro.params

// ä»æ•°æ®åº“æˆ– API è·å–æ•°æ®
const response = await fetch(`https://api.example.com/posts/${slug}`)

if (!response.ok) {
  return Astro.redirect('/404')
}

const post = await response.json()
---

<h1>{post.title}</h1>
<div set:html={post.content} />
```

### é‡å®šå‘ä¸ 404 å¤„ç†

å¤„ç†ä¸å­˜åœ¨çš„è·¯ç”±ï¼š

```astro
---
// src/pages/blog/[slug].astro
const { slug } = Astro.params

const post = await getPostBySlug(slug)

// æ–‡ç« ä¸å­˜åœ¨æ—¶é‡å®šå‘åˆ° 404
if (!post) {
  return Astro.redirect('/404')
}
---
```

æˆ–è€…è¿”å› 404 çŠ¶æ€ç ï¼š

```astro
---
const post = await getPostBySlug(slug)

if (!post) {
  return new Response('Not Found', {
    status: 404,
    statusText: 'Not Found',
  })
}
---
```

### æ··åˆæ¨¡å¼ (Hybrid)

å¤§å¤šæ•°é¡µé¢é™æ€ç”Ÿæˆï¼Œå°‘æ•°é¡µé¢ SSRï¼š

```typescript
// astro.config.ts
export default defineConfig({
  output: 'hybrid', // é»˜è®¤é™æ€
  adapter: node({ mode: 'standalone' }),
})
```

åœ¨éœ€è¦ SSR çš„é¡µé¢æ·»åŠ ï¼š

```astro
---
// src/pages/api/search.astro
export const prerender = false // ç¦ç”¨é¢„æ¸²æŸ“ï¼Œå¯ç”¨ SSR

const query = Astro.url.searchParams.get('q')
const results = await searchPosts(query)
---
```

## å®æˆ˜ï¼šåšå®¢åˆ—è¡¨åˆ†é¡µ

è®©æˆ‘ä»¬çœ‹çœ‹å½“å‰åšå®¢é¡¹ç›®æ˜¯å¦‚ä½•å®ç°æ–‡ç« åˆ—è¡¨å’Œåˆ†é¡µçš„ã€‚

### å½“å‰é¡¹ç›®çš„æ–‡ç« åˆ—è¡¨å®ç°åˆ†æ

æ–‡ç« è¯¦æƒ…é¡µ `src/pages/blog/[...slug].astro`ï¼š

```astro
---
// src/pages/blog/[...slug].astro
import RenderPost from '~/components/views/RenderPost.astro'
import { getFilteredPosts } from '~/utils/data'

export async function getStaticPaths() {
  const posts = await getFilteredPosts('blog')

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }))
}

const { post } = Astro.props
---

<RenderPost {post} isCommentable={true} />
```

ğŸ¯ å‡ ä¸ªå…³é”®ç‚¹ï¼š

1. ä½¿ç”¨ `[...slug]` å‰©ä½™å‚æ•°ï¼Œå¯ä»¥åŒ¹é…ä»»æ„æ·±åº¦çš„è·¯å¾„
2. `getFilteredPosts` æ˜¯å°è£…çš„å·¥å…·å‡½æ•°ï¼Œè·å–å¹¶è¿‡æ»¤æ–‡ç« 
3. é€šè¿‡ `props` ä¼ é€’å®Œæ•´çš„ `post` å¯¹è±¡ï¼Œé¿å…é‡å¤æŸ¥è¯¢

### getStaticPaths é…åˆå†…å®¹é›†åˆ

å·¥å…·å‡½æ•° `getFilteredPosts` çš„å®ç°æ€è·¯ï¼š

```typescript
// src/utils/data.ts
import { getCollection } from 'astro:content'

export async function getFilteredPosts(collection: string) {
  const posts = await getCollection(collection)

  // è¿‡æ»¤è‰ç¨¿ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  const filtered = import.meta.env.PROD
    ? posts.filter((post) => !post.data.draft)
    : posts

  // æŒ‰æ—¥æœŸæ’åº
  return filtered.sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  )
}
```

### åˆ†ç±»/æ ‡ç­¾é¡µé¢çš„åŠ¨æ€ç”Ÿæˆ

ä¸ºæ¯ä¸ªåˆ†ç±»ç”Ÿæˆç‹¬ç«‹é¡µé¢ï¼š

```astro
---
// src/pages/blog/category/[category].astro
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const posts = await getCollection('blog')

  // æå–æ‰€æœ‰åˆ†ç±»
  const categories = [...new Set(posts.map((post) => post.data.category))]

  return categories.map((category) => ({
    params: { category },
    props: {
      posts: posts.filter((post) => post.data.category === category),
    },
  }))
}

const { category } = Astro.params
const { posts } = Astro.props
---

<h1>åˆ†ç±»: {category}</h1>
<ul>
  {
    posts.map((post) => (
      <li>
        <a href={`/blog/${post.id}`}>{post.data.title}</a>
      </li>
    ))
  }
</ul>
```

æ ‡ç­¾é¡µé¢ç±»ä¼¼ï¼Œä½†ä¸€ç¯‡æ–‡ç« å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼š

```astro
---
// src/pages/blog/tag/[tag].astro
export async function getStaticPaths() {
  const posts = await getCollection('blog')

  // æå–æ‰€æœ‰æ ‡ç­¾ï¼ˆæ‰å¹³åŒ–ï¼‰
  const tags = [...new Set(posts.flatMap((post) => post.data.tags || []))]

  return tags.map((tag) => ({
    params: { tag },
    props: {
      posts: posts.filter((post) => post.data.tags?.includes(tag)),
    },
  }))
}
---
```

## è·¯ç”±ä¼˜å…ˆçº§

å½“å¤šä¸ªè·¯ç”±æ¨¡å¼å¯èƒ½åŒ¹é…åŒä¸€ä¸ª URL æ—¶ï¼ŒAstro æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§é€‰æ‹©ï¼š

1. **é™æ€è·¯ç”±** > åŠ¨æ€è·¯ç”±
2. **å‚æ•°å°‘çš„** > å‚æ•°å¤šçš„åŠ¨æ€è·¯ç”±
3. **å…·åå‚æ•°** > å‰©ä½™å‚æ•°

```
/posts/create    # é™æ€è·¯ç”±ï¼Œä¼˜å…ˆçº§æœ€é«˜
/posts/[id]      # å•å‚æ•°åŠ¨æ€è·¯ç”±
/posts/[...slug] # å‰©ä½™å‚æ•°ï¼Œä¼˜å…ˆçº§æœ€ä½
```

## ä¸‹ä¸€æ­¥

ğŸ¯ ç°åœ¨ä½ å·²ç»æŒæ¡äº† Astro çš„è·¯ç”±ç³»ç»Ÿï¼š

- æ–‡ä»¶è·¯ç”±çš„æ˜ å°„è§„åˆ™
- é™æ€è·¯ç”±å’ŒåŠ¨æ€è·¯ç”±çš„ä½¿ç”¨
- `getStaticPaths` å’Œåˆ†é¡µå®ç°
- SSR æ¨¡å¼ä¸‹çš„åŠ¨æ€è·¯ç”±

ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†å­¦ä¹  Astro çš„**ç»„ä»¶ç³»ç»Ÿ**ï¼ŒåŒ…æ‹¬ï¼š

- Astro ç»„ä»¶çš„ Props å’Œ Slots
- æ¡†æ¶ç»„ä»¶ï¼ˆReact/Vue/Svelteï¼‰çš„é›†æˆ
- client:\* æŒ‡ä»¤çš„ä½¿ç”¨åœºæ™¯
- æ ·å¼æ–¹æ¡ˆå’Œ UnoCSS

## å‚è€ƒèµ„æ–™

- [Astro è·¯ç”±æ–‡æ¡£](https://docs.astro.build/en/guides/routing/)
- [Astro åˆ†é¡µæ–‡æ¡£](https://docs.astro.build/en/guides/routing/#pagination)
- [Astro SSR æŒ‡å—](https://docs.astro.build/en/guides/on-demand-rendering/)
